<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>R6 class that calculates the values for multiple cells in batches. — PivotBatchCalculator • pivottabler</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>


<!-- docsearch -->
<script src="../docsearch.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.3/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous" />
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>



<meta property="og:title" content="R6 class that calculates the values for multiple cells in batches. — PivotBatchCalculator" />
<meta property="og:description" content="The `PivotBatchCalculator` class calculates the values for multiple cells in
the pivot table in one evaluation step (per batch), instead of evaluating
every calculation once per pivot table cell." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-64707587-2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-64707587-2');
</script>


  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">pivottabler</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.5.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/cbailiss/pivottabler/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
      <form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
        </div>
      </form>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>R6 class that calculates the values for multiple cells in batches.</h1>
    <small class="dont-index">Source: <a href='https://github.com/cbailiss/pivottabler/blob/master/R/PivotBatchCalculator.R'><code>R/PivotBatchCalculator.R</code></a></small>
    <div class="hidden name"><code>PivotBatchCalculator.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The `PivotBatchCalculator` class calculates the values for multiple cells in
the pivot table in one evaluation step (per batch), instead of evaluating
every calculation once per pivot table cell.</p>
    </div>



    <h2 class="hasAnchor" id="format"><a class="anchor" href="#format"></a>Format</h2>

    <p><code>R6Class</code> object.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Evaluating a set of filters and calculations repetitively for each cell is
inefficient and slow.  The Batch Calculator executes a much small number of
calculations which greatly reduces the CPU time and elapsed time required.
See the "Performance" vignette for details.</p>
    <h2 class="hasAnchor" id="active-bindings"><a class="anchor" href="#active-bindings"></a>Active bindings</h2>

    <p><div class="r6-active-bindings"></p><dl'>
<dt><code>batchCount</code></dt><dd><p>The number of batches generated for the pivot table.</p></dd>

<dt><code>calculationSummary</code></dt><dd><p>A summary of the batch compatibility for each
calculation.</p></dd>

<dt><code>batchSummary</code></dt><dd><p>A summary of the batches in the pivot table.</p></dd>

</dl><p></div></p>
    <h2 class="hasAnchor" id="methods"><a class="anchor" href="#methods"></a>Methods</h2>

    
<h3>Public methods</h3>

<ul>
<li><p><a href='#method-new'><code>PivotBatchCalculator$new()</code></a></p></li>
<li><p><a href='#method-reset'><code>PivotBatchCalculator$reset()</code></a></p></li>
<li><p><a href='#method-checkValidWorkingData'><code>PivotBatchCalculator$checkValidWorkingData()</code></a></p></li>
<li><p><a href='#method-isFiltersBatchCompatible'><code>PivotBatchCalculator$isFiltersBatchCompatible()</code></a></p></li>
<li><p><a href='#method-generateBatchesForNamedCalculationEvaluation1'><code>PivotBatchCalculator$generateBatchesForNamedCalculationEvaluation1()</code></a></p></li>
<li><p><a href='#method-generateBatchesForNamedCalculationEvaluation2'><code>PivotBatchCalculator$generateBatchesForNamedCalculationEvaluation2()</code></a></p></li>
<li><p><a href='#method-generateBatchesForCellEvaluation'><code>PivotBatchCalculator$generateBatchesForCellEvaluation()</code></a></p></li>
<li><p><a href='#method-evaluateBatches'><code>PivotBatchCalculator$evaluateBatches()</code></a></p></li>
<li><p><a href='#method-getSummaryValueFromBatch'><code>PivotBatchCalculator$getSummaryValueFromBatch()</code></a></p></li>
<li><p><a href='#method-clone'><code>PivotBatchCalculator$clone()</code></a></p></li>
</ul>
<p><hr>
<a id="method-new"></a></p><h3>Method <code>new()</code></h3>
<p>Create a new `PivotBatchCalculator` object.</p><h3>Usage</h3>
<p><div class="r"></p><pre><span class='no'>PivotBatchCalculator</span>$<span class='fu'>new</span>(<span class='kw'>parentPivot</span> <span class='kw'>=</span> <span class='kw'>NULL</span>)</pre><p></div></p>

<h3>Arguments</h3>
<p><div class="arguments"></p><dl'>
<dt><code>parentPivot</code></dt><dd><p>The pivot table that this `PivotBatchCalculator`
instance belongs to.</p></dd>

</dl><p></div></p>
<h3>Returns</h3>
<p>A new `PivotBatchCalculator` object.</p>
<p><hr>
<a id="method-reset"></a></p><h3>Method <code>reset()</code></h3>
<p>Reset the batch calculator, clearing all existing batches.</p><h3>Usage</h3>
<p><div class="r"></p><pre><span class='no'>PivotBatchCalculator</span>$<span class='fu'>reset</span>()</pre><p></div></p>

<h3>Returns</h3>
<p>No return value.</p>
<p><hr>
<a id="method-checkValidWorkingData"></a></p><h3>Method <code>checkValidWorkingData()</code></h3>
<p>Run some additional checks to see whether the working data is valid.
Typically only used in development builds of the package.</p><h3>Usage</h3>
<p><div class="r"></p><pre><span class='no'>PivotBatchCalculator</span>$<span class='fu'>checkValidWorkingData</span>(<span class='kw'>workingData</span> <span class='kw'>=</span> <span class='kw'>NULL</span>)</pre><p></div></p>

<h3>Arguments</h3>
<p><div class="arguments"></p><dl'>
<dt><code>workingData</code></dt><dd><p>The working data to check.</p></dd>

</dl><p></div></p>
<h3>Returns</h3>
<p>No return value.</p>
<p><hr>
<a id="method-isFiltersBatchCompatible"></a></p><h3>Method <code>isFiltersBatchCompatible()</code></h3>
<p>Examines a set of filters to see whether they are compatible with batch
evaluation mode. Only filters that specify zero or one value for each
variable are compatible with batch evaluation.</p><h3>Usage</h3>
<p><div class="r"></p><pre><span class='no'>PivotBatchCalculator</span>$<span class='fu'>isFiltersBatchCompatible</span>(<span class='kw'>filters</span> <span class='kw'>=</span> <span class='kw'>NULL</span>)</pre><p></div></p>

<h3>Arguments</h3>
<p><div class="arguments"></p><dl'>
<dt><code>filters</code></dt><dd><p>A `PivotFilters` object that represents a set of filters
to examine.</p></dd>

</dl><p></div></p>
<h3>Details</h3>
<p>It is not practical to make batch evaluation work where a filter
matches more than one value for a variable.  One approach might be to add
a derived column where a single value represents the multiple values, however
the combination of values could partially overlap with combinations of values
in other data groups.  Also the value that represents the "combined"
value could collide with other existing values in the column.
In summary:  Sequential mode is slower and more flexible.  Batch is faster
but stricter.  Batch mode works for regular pivot tables (i.e. most cases).</p>

<h3>Returns</h3>
<p>`TRUE` if the filters are batch compatible, `FALSE` otherwise.</p>
<p><hr>
<a id="method-generateBatchesForNamedCalculationEvaluation1"></a></p><h3>Method <code>generateBatchesForNamedCalculationEvaluation1()</code></h3>
<p>Generates a new batch or finds a relevant existing batch for
a named calculation and single working filters object.</p><h3>Usage</h3>
<p><div class="r"></p><pre><span class='no'>PivotBatchCalculator</span>$<span class='fu'>generateBatchesForNamedCalculationEvaluation1</span>(
  <span class='kw'>dataName</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>calculationName</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>calculationGroupName</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>workingFilters</span> <span class='kw'>=</span> <span class='kw'>NULL</span>
)</pre><p></div></p>

<h3>Arguments</h3>
<p><div class="arguments"></p><dl'>
<dt><code>dataName</code></dt><dd><p>The name of the data frame (as specified in
`pt$addData()`).</p></dd>

<dt><code>calculationName</code></dt><dd><p>The name of the calculation.</p></dd>

<dt><code>calculationGroupName</code></dt><dd><p>The calculation group of the
calculation.</p></dd>

<dt><code>workingFilters</code></dt><dd><p>A `PivotFilters` object that represents the
working filters to generate the batch for.</p></dd>

</dl><p></div></p>
<h3>Returns</h3>
<p>The name of either the batch that was created or the
relevant existing batch.</p>
<p><hr>
<a id="method-generateBatchesForNamedCalculationEvaluation2"></a></p><h3>Method <code>generateBatchesForNamedCalculationEvaluation2()</code></h3>
<p>Generates one or more batches for the named calculations and set of
working working data associated with a cell.</p><h3>Usage</h3>
<p><div class="r"></p><pre><span class='no'>PivotBatchCalculator</span>$<span class='fu'>generateBatchesForNamedCalculationEvaluation2</span>(
  <span class='kw'>calculationName</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>calculationGroupName</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>workingData</span> <span class='kw'>=</span> <span class='kw'>NULL</span>
)</pre><p></div></p>

<h3>Arguments</h3>
<p><div class="arguments"></p><dl'>
<dt><code>calculationName</code></dt><dd><p>The name of the calculation.</p></dd>

<dt><code>calculationGroupName</code></dt><dd><p>The calculation group of the
calculation.</p></dd>

<dt><code>workingData</code></dt><dd><p>A list containing filter and/or filter overrides.</p></dd>

</dl><p></div></p>
<h3>Details</h3>
<p>A wrapper around `generateBatchesForNamedCalculationEvaluation1()`, which
invokes this function as appropriate, depending on whether a calculation
if either of type "summary" or type "calculation".</p>

<h3>Returns</h3>
<p>One or more batch names of either the batches that were created or
the relevant existing batches.</p>
<p><hr>
<a id="method-generateBatchesForCellEvaluation"></a></p><h3>Method <code>generateBatchesForCellEvaluation()</code></h3>
<p>Generates the batches for batch evaluation mode.</p><h3>Usage</h3>
<p><div class="r"></p><pre><span class='no'>PivotBatchCalculator</span>$<span class='fu'>generateBatchesForCellEvaluation</span>()</pre><p></div></p>

<h3>Returns</h3>
<p>One or more batch names of either the batches that were created or
the relevant existing batches.</p>
<p><hr>
<a id="method-evaluateBatches"></a></p><h3>Method <code>evaluateBatches()</code></h3>
<p>Evaluate each of the batches defined in the batch calculator.</p><h3>Usage</h3>
<p><div class="r"></p><pre><span class='no'>PivotBatchCalculator</span>$<span class='fu'>evaluateBatches</span>()</pre><p></div></p>

<h3>Returns</h3>
<p>The number of batches that were evaluated.</p>
<p><hr>
<a id="method-getSummaryValueFromBatch"></a></p><h3>Method <code>getSummaryValueFromBatch()</code></h3>
<p>Retrieve one calculation value from one batch, typically for the value
 of one cell in a pivot table.</p><h3>Usage</h3>
<p><div class="r"></p><pre><span class='no'>PivotBatchCalculator</span>$<span class='fu'>getSummaryValueFromBatch</span>(
  <span class='kw'>batchName</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>calculationName</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>calculationGroupName</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>workingFilters</span> <span class='kw'>=</span> <span class='kw'>NULL</span>
)</pre><p></div></p>

<h3>Arguments</h3>
<p><div class="arguments"></p><dl'>
<dt><code>batchName</code></dt><dd><p>The name of the batch containing the calculation result.</p></dd>

<dt><code>calculationName</code></dt><dd><p>The name of the calculation.</p></dd>

<dt><code>calculationGroupName</code></dt><dd><p>The calculation group of the
calculation.</p></dd>

<dt><code>workingFilters</code></dt><dd><p>A `PivotFilters` object that represents the
working filters to retrieve the value for.</p></dd>

</dl><p></div></p>
<h3>Returns</h3>
<p>A single calculation value.</p>
<p><hr>
<a id="method-clone"></a></p><h3>Method <code>clone()</code></h3>
<p>The objects of this class are cloneable with this method.</p><h3>Usage</h3>
<p><div class="r"></p><pre><span class='no'>PivotBatchCalculator</span>$<span class='fu'>clone</span>(<span class='kw'>deep</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)</pre><p></div></p>

<h3>Arguments</h3>
<p><div class="arguments"></p><dl'>
<dt><code>deep</code></dt><dd><p>Whether to make a deep clone.</p></dd>

</dl><p></div></p>



    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'># This class should only be created by the pivot table.
# It is not intended to be created outside of the pivot table.
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Christopher Bailiss.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script>
<script>
  docsearch({
    
    
    apiKey: '16a61fa9a8811ff537cd1a528040a9e1',
    indexName: 'pivottabler',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>



  </body>
</html>


