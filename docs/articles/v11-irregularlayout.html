<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>11. Irregular Layout • pivottabler</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.3/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous">
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><meta property="og:title" content="11. Irregular Layout">
<meta property="og:description" content="pivottabler">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-64707587-2"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-64707587-2');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">pivottabler</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.5.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/cbailiss/pivottabler/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
<form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
</div>
      </form>
      
    </div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="v11-irregularlayout_files/htmlwidgets-1.5.1/htmlwidgets.js"></script><script src="v11-irregularlayout_files/pivottabler-binding-1.5.0/pivottabler.js"></script><script src="v11-irregularlayout_files/basictabler-binding-0.3.1/basictabler.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>11. Irregular Layout</h1>
                        <h4 class="author">Chris Bailiss</h4>
            
            <h4 class="date">2020-06-16</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/cbailiss/pivottabler/blob/master/vignettes/v11-irregularlayout.Rmd"><code>vignettes/v11-irregularlayout.Rmd</code></a></small>
      <div class="hidden name"><code>v11-irregularlayout.Rmd</code></div>

    </div>

    
    
<div id="in-this-vignette" class="section level2">
<h2 class="hasAnchor">
<a href="#in-this-vignette" class="anchor"></a>In This Vignette</h2>
<ul>
<li>Introductory Note</li>
<li>What is Irregular Layout?</li>
<li>Caution</li>
<li>Constructing an Irregular Layout</li>
<li>Building a Data Group Hierarchy</li>
<li>Modifying a Pivot Table</li>
<li>Simple Example of an Irregular Layout</li>
<li>Extending the Simple Example</li>
<li>Another Example</li>
<li>Multiple Calculation Groups</li>
<li>Combining Multiple Pivot Tables</li>
<li>Custom Layout Changes</li>
<li>Further Reading</li>
</ul>
</div>
<div id="introductory-note" class="section level2">
<h2 class="hasAnchor">
<a href="#introductory-note" class="anchor"></a>Introductory Note</h2>
<p>This is a more advanced topic. It requires a good understanding of the material in the previous vignettes.</p>
<p>This vignette starts with a discussion of irregular layout, then defines some low-level methods for building a pivot table before moving onto several different examples of irregular pivot tables.</p>
</div>
<div id="what-is-irregular-layout" class="section level2">
<h2 class="hasAnchor">
<a href="#what-is-irregular-layout" class="anchor"></a>What is Irregular Layout?</h2>
<p>Let’s start by talking about regular layout. The following is an example pivot table that has appeared in previous vignettes:</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">pivottabler</span>)
<span class="no">pt</span> <span class="kw">&lt;-</span> <span class="no">PivotTable</span>$<span class="fu">new</span>()
<span class="no">pt</span>$<span class="fu">addData</span>(<span class="no">bhmtrains</span>)
<span class="no">pt</span>$<span class="fu">addColumnDataGroups</span>(<span class="st">"TrainCategory"</span>)
<span class="no">pt</span>$<span class="fu">addColumnDataGroups</span>(<span class="st">"PowerType"</span>)
<span class="no">pt</span>$<span class="fu">addRowDataGroups</span>(<span class="st">"TOC"</span>)
<span class="no">pt</span>$<span class="fu">defineCalculation</span>(<span class="kw">calculationName</span><span class="kw">=</span><span class="st">"TotalTrains"</span>, <span class="kw">summariseExpression</span><span class="kw">=</span><span class="st">"n()"</span>)
<span class="no">pt</span>$<span class="fu">renderPivot</span>()</pre></body></html></div>
<div id="htmlwidget-c5ca69e10d08aff3ad68" style="width:auto;height:auto;" class="pivottabler html-widget"></div>
<script type="application/json" data-for="htmlwidget-c5ca69e10d08aff3ad68">{"x":{"tableCss":".Table {display: table; border-collapse: collapse; }\r\n.ColumnHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px; text-align: center; }\r\n.RowHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px 8px 2px 2px; text-align: left; }\r\n.Cell {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n.OutlineColumnHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px; text-align: center; }\r\n.OutlineRowHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px 8px 2px 2px; text-align: left; }\r\n.OutlineCell {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; background-color: #F8F8F8; font-weight: bold; }\r\n.Total {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n","tableHtml":"<table class=\"Table\">\n  <tr>\n    <th class=\"RowHeader\" rowspan=\"2\">&nbsp;<\/th>\n    <th class=\"ColumnHeader\" colspan=\"4\">Express Passenger<\/th>\n    <th class=\"ColumnHeader\" colspan=\"3\">Ordinary Passenger<\/th>\n    <th class=\"ColumnHeader\">Total<\/th>\n  <\/tr>\n  <tr>\n    <th class=\"ColumnHeader\">DMU<\/th>\n    <th class=\"ColumnHeader\">EMU<\/th>\n    <th class=\"ColumnHeader\">HST<\/th>\n    <th class=\"ColumnHeader\">Total<\/th>\n    <th class=\"ColumnHeader\">DMU<\/th>\n    <th class=\"ColumnHeader\">EMU<\/th>\n    <th class=\"ColumnHeader\">Total<\/th>\n    <th class=\"ColumnHeader\">&nbsp;<\/th>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Arriva Trains Wales<\/th>\n    <td class=\"Cell\">3079<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">3079<\/td>\n    <td class=\"Cell\">830<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">830<\/td>\n    <td class=\"Total\">3909<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">CrossCountry<\/th>\n    <td class=\"Cell\">22133<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\">732<\/td>\n    <td class=\"Total\">22865<\/td>\n    <td class=\"Cell\">63<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">63<\/td>\n    <td class=\"Total\">22928<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">London Midland<\/th>\n    <td class=\"Cell\">5638<\/td>\n    <td class=\"Cell\">8849<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">14487<\/td>\n    <td class=\"Cell\">5591<\/td>\n    <td class=\"Cell\">28201<\/td>\n    <td class=\"Total\">33792<\/td>\n    <td class=\"Total\">48279<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Virgin Trains<\/th>\n    <td class=\"Cell\">2137<\/td>\n    <td class=\"Cell\">6457<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">8594<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\"><\/td>\n    <td class=\"Total\">8594<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Total<\/th>\n    <td class=\"Total\">32987<\/td>\n    <td class=\"Total\">15306<\/td>\n    <td class=\"Total\">732<\/td>\n    <td class=\"Total\">49025<\/td>\n    <td class=\"Total\">6484<\/td>\n    <td class=\"Total\">28201<\/td>\n    <td class=\"Total\">34685<\/td>\n    <td class=\"Total\">83710<\/td>\n  <\/tr>\n<\/table>","settings":[]},"evals":[],"jsHooks":[]}</script><p>This is a regular pivot table: Each level of row and column headings is related to a single variable only, i.e.</p>
<ul>
<li>The first level of column headings (“Express Passenger”, “Ordinary Passenger”, etc.) are all related to the “TrainCategory” variable.</li>
<li>The second level of column headings (“DMU”, “EMU”, etc.) are all related to the “PowerType” variable.</li>
<li>The first level of row headings (“Arriva Trains Wales”, “CrossCountry”, etc.) are all related to the “TOC” (Train Operating Company) variable.</li>
</ul>
<p>Returning to the original question (What is irregular layout?), the definition for our purposes is: Irregular layout is any layout where a single level of row or column headings relates to more than one variable.</p>
</div>
<div id="caution" class="section level2">
<h2 class="hasAnchor">
<a href="#caution" class="anchor"></a>Caution</h2>
<p>Irregular layouts inevitably require more effort to construct. Irregular layouts also tend to be harder to understand, so they need careful consideration before being used. Often using multiple separate regular pivot tables is a better idea.</p>
</div>
<div id="constructing-an-irregular-layout" class="section level2">
<h2 class="hasAnchor">
<a href="#constructing-an-irregular-layout" class="anchor"></a>Constructing an Irregular Layout</h2>
<p>The process for building an irregular layout is:</p>
<ol style="list-style-type: decimal">
<li>Building the data group hierarchies (row headings and column headings)</li>
<li>Evaluate the pivot table - to generate and calculate the cells in the body of the pivot table</li>
<li>Modify the resulting pivot table - if needed</li>
<li>Render the pivot table</li>
</ol>
<p>Most of the extra effort in building an irregular/custom pivot table is in step 1 and potentially step 3. Step 2 is identical for both regular and irregular pivot tables and involves nothing more than calling <code>pt$evaluatePivot()</code> or similar. Step 4 is also identical for both regular and irregular pivot tables.</p>
</div>
<div id="building-a-data-group-hierarchy" class="section level2">
<h2 class="hasAnchor">
<a href="#building-a-data-group-hierarchy" class="anchor"></a>Building a Data Group Hierarchy</h2>
<div id="reminder-what-are-data-groups" class="section level3">
<h3 class="hasAnchor">
<a href="#reminder-what-are-data-groups" class="anchor"></a>Reminder: What are data groups?</h3>
<p>Each row and column heading in a pivot table is a data group. If the hierarchy on the rows or columns has multiple levels, then each heading in each level is a data group. Put another way, each heading cell in the table is a data group. This is explored more in the <a href="v10-navigatingapivottable.html">Navigating a Pivot Table</a> vignette.</p>
<p>Each data group is an instance of the R6 <code>PivotDataGroup</code> class. See the <a href="vA3-appendix.html">Appendix: Class Overview</a> vignette for more details.</p>
<p>A data group can relate to a single value from a single variable (column) in a data frame. This is the most common case, e.g. in the pivot table below, there are five data groups on the rows axis and three data groups on the columns axis. The totals data groups relate to more than one value on each axis.</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">pivottabler</span>)
<span class="no">pt</span> <span class="kw">&lt;-</span> <span class="no">PivotTable</span>$<span class="fu">new</span>()
<span class="no">pt</span>$<span class="fu">addData</span>(<span class="no">bhmtrains</span>)
<span class="no">pt</span>$<span class="fu">addColumnDataGroups</span>(<span class="st">"TrainCategory"</span>)
<span class="no">pt</span>$<span class="fu">addRowDataGroups</span>(<span class="st">"TOC"</span>)
<span class="no">pt</span>$<span class="fu">defineCalculation</span>(<span class="kw">calculationName</span><span class="kw">=</span><span class="st">"NumberOfTrains"</span>, <span class="kw">caption</span><span class="kw">=</span><span class="st">"Number of Trains"</span>,
                     <span class="kw">summariseExpression</span><span class="kw">=</span><span class="st">"n()"</span>)
<span class="no">pt</span>$<span class="fu">renderPivot</span>()</pre></body></html></div>
<div id="htmlwidget-3d9817c061173bcbdce0" style="width:auto;height:auto;" class="pivottabler html-widget"></div>
<script type="application/json" data-for="htmlwidget-3d9817c061173bcbdce0">{"x":{"tableCss":".Table {display: table; border-collapse: collapse; }\r\n.ColumnHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px; text-align: center; }\r\n.RowHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px 8px 2px 2px; text-align: left; }\r\n.Cell {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n.OutlineColumnHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px; text-align: center; }\r\n.OutlineRowHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px 8px 2px 2px; text-align: left; }\r\n.OutlineCell {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; background-color: #F8F8F8; font-weight: bold; }\r\n.Total {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n","tableHtml":"<table class=\"Table\">\n  <tr>\n    <th class=\"RowHeader\">&nbsp;<\/th>\n    <th class=\"ColumnHeader\">Express Passenger<\/th>\n    <th class=\"ColumnHeader\">Ordinary Passenger<\/th>\n    <th class=\"ColumnHeader\">Total<\/th>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Arriva Trains Wales<\/th>\n    <td class=\"Cell\">3079<\/td>\n    <td class=\"Cell\">830<\/td>\n    <td class=\"Total\">3909<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">CrossCountry<\/th>\n    <td class=\"Cell\">22865<\/td>\n    <td class=\"Cell\">63<\/td>\n    <td class=\"Total\">22928<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">London Midland<\/th>\n    <td class=\"Cell\">14487<\/td>\n    <td class=\"Cell\">33792<\/td>\n    <td class=\"Total\">48279<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Virgin Trains<\/th>\n    <td class=\"Cell\">8594<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">8594<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Total<\/th>\n    <td class=\"Total\">49025<\/td>\n    <td class=\"Total\">34685<\/td>\n    <td class=\"Total\">83710<\/td>\n  <\/tr>\n<\/table>","settings":[]},"evals":[],"jsHooks":[]}</script><p>A data group can also relate to multiple values from a single variable. In irregular pivot tables, a data group even relate to multiple values from multiple variables.</p>
<p>There is more discussion of data group variables and values in the <a href="v09-cellcontext.html">Cell Context</a> vignette.</p>
<p>A data group can also represent just a calculation. This is most common when a pivot table contains more than one visible calculation. In pivot tables with more than one calculation, a calculation data group is created for each calculation under each of the existing data groups on an axis, e.g.</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">pivottabler</span>)
<span class="no">pt</span> <span class="kw">&lt;-</span> <span class="no">PivotTable</span>$<span class="fu">new</span>()
<span class="no">pt</span>$<span class="fu">addData</span>(<span class="no">bhmtrains</span>)
<span class="no">pt</span>$<span class="fu">addColumnDataGroups</span>(<span class="st">"TrainCategory"</span>)
<span class="no">pt</span>$<span class="fu">addRowDataGroups</span>(<span class="st">"TOC"</span>)
<span class="no">pt</span>$<span class="fu">defineCalculation</span>(<span class="kw">calculationName</span><span class="kw">=</span><span class="st">"NumberOfTrains"</span>, <span class="kw">caption</span><span class="kw">=</span><span class="st">"Number of Trains"</span>,
                     <span class="kw">summariseExpression</span><span class="kw">=</span><span class="st">"n()"</span>)
<span class="no">pt</span>$<span class="fu">defineCalculation</span>(<span class="kw">calculationName</span><span class="kw">=</span><span class="st">"MaximumSpeedMPH"</span>, <span class="kw">caption</span><span class="kw">=</span><span class="st">"Maximum Speed (MPH)"</span>,
                     <span class="kw">summariseExpression</span><span class="kw">=</span><span class="st">"max(SchedSpeedMPH, na.rm=TRUE)"</span>)
<span class="no">pt</span>$<span class="fu">renderPivot</span>()</pre></body></html></div>
<div id="htmlwidget-dfa538543053fc5659c3" style="width:auto;height:auto;" class="pivottabler html-widget"></div>
<script type="application/json" data-for="htmlwidget-dfa538543053fc5659c3">{"x":{"tableCss":".Table {display: table; border-collapse: collapse; }\r\n.ColumnHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px; text-align: center; }\r\n.RowHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px 8px 2px 2px; text-align: left; }\r\n.Cell {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n.OutlineColumnHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px; text-align: center; }\r\n.OutlineRowHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px 8px 2px 2px; text-align: left; }\r\n.OutlineCell {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; background-color: #F8F8F8; font-weight: bold; }\r\n.Total {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n","tableHtml":"<table class=\"Table\">\n  <tr>\n    <th class=\"RowHeader\" rowspan=\"2\">&nbsp;<\/th>\n    <th class=\"ColumnHeader\" colspan=\"2\">Express Passenger<\/th>\n    <th class=\"ColumnHeader\" colspan=\"2\">Ordinary Passenger<\/th>\n    <th class=\"ColumnHeader\" colspan=\"2\">Total<\/th>\n  <\/tr>\n  <tr>\n    <th class=\"ColumnHeader\">Number of Trains<\/th>\n    <th class=\"ColumnHeader\">Maximum Speed (MPH)<\/th>\n    <th class=\"ColumnHeader\">Number of Trains<\/th>\n    <th class=\"ColumnHeader\">Maximum Speed (MPH)<\/th>\n    <th class=\"ColumnHeader\">Number of Trains<\/th>\n    <th class=\"ColumnHeader\">Maximum Speed (MPH)<\/th>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Arriva Trains Wales<\/th>\n    <td class=\"Cell\">3079<\/td>\n    <td class=\"Cell\">90<\/td>\n    <td class=\"Cell\">830<\/td>\n    <td class=\"Cell\">90<\/td>\n    <td class=\"Total\">3909<\/td>\n    <td class=\"Total\">90<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">CrossCountry<\/th>\n    <td class=\"Cell\">22865<\/td>\n    <td class=\"Cell\">125<\/td>\n    <td class=\"Cell\">63<\/td>\n    <td class=\"Cell\">100<\/td>\n    <td class=\"Total\">22928<\/td>\n    <td class=\"Total\">125<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">London Midland<\/th>\n    <td class=\"Cell\">14487<\/td>\n    <td class=\"Cell\">110<\/td>\n    <td class=\"Cell\">33792<\/td>\n    <td class=\"Cell\">100<\/td>\n    <td class=\"Total\">48279<\/td>\n    <td class=\"Total\">110<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Virgin Trains<\/th>\n    <td class=\"Cell\">8594<\/td>\n    <td class=\"Cell\">125<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">8594<\/td>\n    <td class=\"Total\">125<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Total<\/th>\n    <td class=\"Total\">49025<\/td>\n    <td class=\"Total\">125<\/td>\n    <td class=\"Total\">34685<\/td>\n    <td class=\"Total\">100<\/td>\n    <td class=\"Total\">83710<\/td>\n    <td class=\"Total\">125<\/td>\n  <\/tr>\n<\/table>","settings":[]},"evals":[],"jsHooks":[]}</script>
</div>
<div id="high-level-methods-vs--low-level-methods" class="section level3">
<h3 class="hasAnchor">
<a href="#high-level-methods-vs--low-level-methods" class="anchor"></a>High-level methods vs. Low-level methods</h3>
<p>Constructing pivot tables that have an irregular layout typically requires more lines of R. This is because the helper functions <code>pt$addColumnDataGroups()</code> and <code>pt$addRowDataGroups()</code> that have been used throughout all of the previous vignettes to easily build-up the structure of a pivot table can no longer solely be used, since they generate a regular layout only. Instead the layout must be built in a more granular way.</p>
<p>The table below describes the different methods that exist:</p>
<table class="table">
<colgroup>
<col width="42%">
<col width="30%">
<col width="27%">
</colgroup>
<thead><tr class="header">
<th align="left">Comparison</th>
<th align="left">High-Level Method</th>
<th align="left">Low-Level Method</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Number of data groups added per execution</td>
<td align="left">Typically adds multiple groups per execution</td>
<td align="left">Adds one group per execution</td>
</tr>
<tr class="even">
<td align="left">Variations</td>
<td align="left">Different methods for data groups and calculations</td>
<td align="left">Single method can add a data group or a calculation group</td>
</tr>
<tr class="odd">
<td align="left">Add at levels</td>
<td align="left">Can add groups at any level in the hierarchy.</td>
<td align="left">Can only add child groups of the current group.</td>
</tr>
<tr class="even">
<td align="left">Usability</td>
<td align="left">Generally easier to use.</td>
<td align="left">Generally harder to use.</td>
</tr>
<tr class="odd">
<td align="left">Safety</td>
<td align="left">More checks that parameter values make sense.</td>
<td align="left">Fewer checks potentially leading to non-sensical or invalid pivot table states.</td>
</tr>
<tr class="even">
<td align="left">Pivot Table methods</td>
<td align="left">
<code>pt$addRowDataGroups()</code><br><code>pt$addColumnDataGroups()</code><br><code>pt$addRowCalculationGroups()</code><br><code>pt$addColumnCalculationGroups()</code>
</td>
<td align="left">
<code>pt$addRowGroup()</code><br><code>pt$addColumnGroup()</code>
</td>
</tr>
<tr class="odd">
<td align="left">Data Group methods</td>
<td align="left">
<code>grp$addDataGroups()</code><br><code>grp$addCalculationGroups()</code>
</td>
<td align="left"><code>grp$addChildGroup()</code></td>
</tr>
</tbody>
</table>
<p>Notes:</p>
<ul>
<li>It is possible to mix the high-level and low-level methods when building a pivot table, e.g. level 1 could be built using the low-level methods, then level 2 built using one of the high-level methods. This can be seen in the examples below.</li>
<li>The pivot table versions of the low-level methods add the new group into level 1 of the hierarchy.</li>
<li>
<code>pt$addRowCalculationGroups()</code> and <code>pt$addColumnCalculationGroups()</code> do not feature in many examples in the documentation and many users will rarely have used them explicitly, however other functions such as <code>pt$evaluatePivot()</code> and <code>pt$renderPivot()</code> internally call them.</li>
<li>The high-level methods internally make use of the low-level methods.<br>
</li>
<li>The pivot table versions are generally thin wrappers of the data group versions, e.g. <code>pt$addRowDataGroups()</code> internally calls <code>pt$rowGroup$addDataGroups()</code>.</li>
</ul>
</div>
<div id="low-level-method-parameter-details" class="section level3">
<h3 class="hasAnchor">
<a href="#low-level-method-parameter-details" class="anchor"></a>Low level method parameter details</h3>
<p>The low level methods have the following parameters:</p>
<ul>
<li>
<code>variableName</code> - a character value that specifies the name of the variable in the data frame that the new group relates to and will filter (if any).</li>
<li>
<code>filterType</code> - must be one of “ALL”, “VALUES”, or “NONE” to specify the filter type:
<ul>
<li>ALL means no filtering is applied.</li>
<li>VALUEs is the typical value used to specify that <code>variableName</code> is filtered to only <code>values</code>.</li>
<li>NONE means no data will match this data group.</li>
</ul>
</li>
<li>
<code>values</code> specifies the filter values applied to <code>variableName</code> to select the data to match this row/column in the pivot table.</li>
<li>
<code>doNotExpand</code> - a logical value, default <code>FALSE</code> - specify <code>TRUE</code> to prevent the high-level methods from adding child groups.</li>
<li>
<code>isEmpty</code>- a logical value, default <code>FALSE</code> - specify <code>TRUE</code> to mark that this data group is empty.</li>
<li>
<code>isOutline</code> - a logical value, default <code>FALSE</code> - specify <code>TRUE</code> to mark that this data group is an outline group.
<ul>
<li>Typically sets of two or three groups (header/before, value and footer/after) are added for each data value when generating outline groups.</li>
<li>Normally, the <code>doNotExpand</code>, <code>sortAnchor</code> and <code>outlineLinkedGroupId</code> parameters are set for an outline group.</li>
<li>See the <a href="v04-regularlayout.html">Regular Layout</a> vignette for more information about outline groups.</li>
</ul>
</li>
<li>
<code>captionTemplate</code> - a character value that specifies the template for the data group caption.
<ul>
<li>The default caption template of <code>{values}</code> simply displays the value without any prefix or suffix.</li>
<li>See the <a href="v02-datagroups.html">Data Groups</a> vignette for an example of setting the caption template.</li>
</ul>
</li>
<li>
<code>caption</code> - effectively a hard-coded caption that overrides the built-in logic for generating a caption.</li>
<li>
<code>isTotal</code> - a logical value, default <code>FALSE</code> - specify <code>TRUE</code> to mark that this data group is a total.</li>
<li>
<code>isLevelSubTotal</code> - a logical value, default <code>FALSE</code> - specify <code>TRUE</code> to mark that this data group is a sub-total within a level.
<ul>
<li>Typically there are multiple sub-totals within a level.</li>
</ul>
</li>
<li>
<code>isLevelTotal</code> - a logical value, default <code>FALSE</code> - specify <code>TRUE</code> to mark that this data group is level total.</li>
<li>
<code>calculationGroupName</code> - for calculation groups, this character value specifies the calculation group that <code>calculationName</code> belongs to.</li>
<li>
<code>calculationName</code> - for calculation groups, this character value specifies the name of the calculation.</li>
<li>
<code>baseStyleName</code> - the style name for the data group.</li>
<li>
<code>styleDeclarations</code> - a list of CSS style declarations to overlay on top of the base style.</li>
<li>
<code>insertAtIndex</code> - the one-based location specifying where to insert the new data group.</li>
<li>
<code>insertBeforeGroup</code> - a reference data group specifying where to insert the new data group.</li>
<li>
<code>insertAfterGroup</code> - a reference data group specifying where to insert the new data group.</li>
<li>
<code>mergeEmptySpace</code> - a character value that specifies how empty space should be merged.
<ul>
<li>This is typically only used with outline groups (so applies to row groups only, not column groups)</li>
<li>
<code>mergeEmptySpace</code> must be one of “doNotMerge”, “dataGroupsOnly”, “cellsOnly”, “dataGroupsAndCellsAs1” or “dataGroupsAndCellsAs2”.</li>
<li>See the <a href="v04-regularlayout.html">Regular Layout</a> vignette for more information.</li>
</ul>
</li>
<li>
<code>cellBaseStyleName</code> - the style name for cells related to this data group.</li>
<li>
<code>cellStyleDeclarations</code> - a list of CSS style declarations to overlay on top of the base style for cells related to this data group.</li>
<li>
<code>sortAnchor</code> - used to specify sort behaviour for outline groups, must be one of “fixed”, “next” or “previous”.</li>
<li>
<code>outlineLinkedGroupId</code> - used to link an outline group to the value data group which has the child data groups.</li>
<li>
<code>resetCells</code> - a logical value, default value <code>TRUE</code> - which clears the current pivot table cells (if the pivot table has already been evaluated).
<ul>
<li>Clearing the pivot table cells is normally desirable, since changes to the data groups means they no longer align with the previously calculated cells.</li>
</ul>
</li>
</ul>
</div>
</div>
<div id="modifying-a-pivot-table" class="section level2">
<h2 class="hasAnchor">
<a href="#modifying-a-pivot-table" class="anchor"></a>Modifying a Pivot Table</h2>
<div id="modifying-data-group-properties" class="section level3">
<h3 class="hasAnchor">
<a href="#modifying-data-group-properties" class="anchor"></a>Modifying data group properties</h3>
<p>The properties and methods of a data group can be examined in code, e.g.</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="no">pt</span>$<span class="no">topRowGroups</span><span class="kw">[[</span><span class="fl">1</span>]]</pre></body></html></div>
<p>Some data group properties are read-only (i.e. the R6 active bindings do not support changing the private values), though they will not error if an attempt is made - rather the internal value simply won’t be updated.</p>
<p>It is nonetheless possible to change many properties of the data groups, however, doing so should be done with caution as this may invalidate the state of the pivot table and such code could be broken by future changes to the package.</p>
<p>If you find that modifying data group properties is necessary for your requirements, please log an issue in the package GitHub site/repository to inform the package author of the use-case.</p>
</div>
<div id="moving-data-groups" class="section level3">
<h3 class="hasAnchor">
<a href="#moving-data-groups" class="anchor"></a>Moving data groups</h3>
<p>The data groups are tied into a hierarchy. Moving data groups is not currently supported.</p>
</div>
<div id="removing-data-groups" class="section level3">
<h3 class="hasAnchor">
<a href="#removing-data-groups" class="anchor"></a>Removing data groups</h3>
<p>The following methods can be used to remove groups:</p>
<ul>
<li>
<code>grp$removeChildGroup()</code> - removes a child group of the current group, parameters:
<ul>
<li>
<code>index</code> - specifies the one-based index of the child to remove.</li>
<li>
<code>group</code> - specifies the child group to remove.</li>
<li>
<code>resetCells</code> - a logical value, default value <code>TRUE</code> - which clears the current pivot table cells (if the pivot table has already been evaluated).</li>
</ul>
</li>
<li>
<code>grp$removeGroup()</code> - removes the current group, parameters:
<ul>
<li>
<code>removeAncestorsIfNoRemainingChildren</code> - a logical value, default value <code>FALSE</code>, that specifies whether the parent group should also be removed if it has no remaining child groups.</li>
<li>
<code>removedRelatedOutlineGroups</code> - a logical value, default value <code>FALSE</code>, that specifies whether the related outline groups (siblings of the current group) should also be removed.</li>
<li>
<code>resetCells</code> - a logical value, default value <code>TRUE</code> - which clears the current pivot table cells (if the pivot table has already been evaluated).</li>
</ul>
</li>
</ul>
</div>
<div id="modifying-data-group-properties-1" class="section level3">
<h3 class="hasAnchor">
<a href="#modifying-data-group-properties-1" class="anchor"></a>Modifying data group properties</h3>
<p>The properties and methods of a cell can also be examined in code, e.g.</p>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="no">pt</span>$<span class="fu">getCell</span>(<span class="kw">r</span><span class="kw">=</span><span class="fl">1</span>, <span class="kw">c</span><span class="kw">=</span><span class="fl">1</span>)</pre></body></html></div>
<p>Again, while some properties are read-only, it is possible to change many properties of the cells, however, doing so should be done with caution as this may invalidate the state of the pivot table and such code could be broken by future changes to the package.</p>
<p>If you find that modifying cell properties is necessary for your requirements, please log an issue in the package GitHub site/repository to inform the package author of the use-case.</p>
</div>
<div id="moving-cells" class="section level3">
<h3 class="hasAnchor">
<a href="#moving-cells" class="anchor"></a>Moving cells</h3>
<p>The cells are tied into a grid structure. Moving cells is not supported (and unlikely ever to be supported).</p>
</div>
<div id="removing-cells" class="section level3">
<h3 class="hasAnchor">
<a href="#removing-cells" class="anchor"></a>Removing cells</h3>
<p>Removing individual cells is not currently supported.</p>
</div>
<div id="removing-rows-and-columns" class="section level3">
<h3 class="hasAnchor">
<a href="#removing-rows-and-columns" class="anchor"></a>Removing rows and columns</h3>
<p>It is possible to remove entire rows and columns. This does not reset the cells - so recalculating the pivot table is not needed after removing rows or columns.</p>
<p>Removing rows/columns is discussed in more detail below.</p>
</div>
</div>
<div id="simple-example-of-an-irregular-layout" class="section level2">
<h2 class="hasAnchor">
<a href="#simple-example-of-an-irregular-layout" class="anchor"></a>Simple Example of an Irregular Layout</h2>
<p>Consider we are only interested in the number of express trains (i.e. TrainCategory=“Express Passenger”) and the number of DMU trains (i.e. PowerType=“DMU”), for each train operating company. Since these requirements relate to two different variables, we need to construct an irregular layout. To do this, these two data groups are added individually to the root column group:</p>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">pivottabler</span>)
<span class="no">pt</span> <span class="kw">&lt;-</span> <span class="no">PivotTable</span>$<span class="fu">new</span>()
<span class="no">pt</span>$<span class="fu">addData</span>(<span class="no">bhmtrains</span>)
<span class="no">pt</span>$<span class="fu">addColumnGroup</span>(<span class="kw">variableName</span><span class="kw">=</span><span class="st">"TrainCategory"</span>, <span class="kw">values</span><span class="kw">=</span><span class="st">"Express Passenger"</span>)
<span class="no">pt</span>$<span class="fu">addColumnGroup</span>(<span class="kw">variableName</span><span class="kw">=</span><span class="st">"PowerType"</span>, <span class="kw">values</span><span class="kw">=</span><span class="st">"DMU"</span>)
<span class="no">pt</span>$<span class="fu">addRowDataGroups</span>(<span class="st">"TOC"</span>)
<span class="no">pt</span>$<span class="fu">defineCalculation</span>(<span class="kw">calculationName</span><span class="kw">=</span><span class="st">"TotalTrains"</span>, <span class="kw">summariseExpression</span><span class="kw">=</span><span class="st">"n()"</span>)
<span class="no">pt</span>$<span class="fu">renderPivot</span>()</pre></body></html></div>
<div id="htmlwidget-0ab7f5bc67e43725a2f9" style="width:auto;height:auto;" class="pivottabler html-widget"></div>
<script type="application/json" data-for="htmlwidget-0ab7f5bc67e43725a2f9">{"x":{"tableCss":".Table {display: table; border-collapse: collapse; }\r\n.ColumnHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px; text-align: center; }\r\n.RowHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px 8px 2px 2px; text-align: left; }\r\n.Cell {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n.OutlineColumnHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px; text-align: center; }\r\n.OutlineRowHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px 8px 2px 2px; text-align: left; }\r\n.OutlineCell {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; background-color: #F8F8F8; font-weight: bold; }\r\n.Total {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n","tableHtml":"<table class=\"Table\">\n  <tr>\n    <th class=\"RowHeader\">&nbsp;<\/th>\n    <th class=\"ColumnHeader\">Express Passenger<\/th>\n    <th class=\"ColumnHeader\">DMU<\/th>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Arriva Trains Wales<\/th>\n    <td class=\"Cell\">3079<\/td>\n    <td class=\"Cell\">3909<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">CrossCountry<\/th>\n    <td class=\"Cell\">22865<\/td>\n    <td class=\"Cell\">22196<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">London Midland<\/th>\n    <td class=\"Cell\">14487<\/td>\n    <td class=\"Cell\">11229<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Virgin Trains<\/th>\n    <td class=\"Cell\">8594<\/td>\n    <td class=\"Cell\">2137<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Total<\/th>\n    <td class=\"Total\">49025<\/td>\n    <td class=\"Total\">39471<\/td>\n  <\/tr>\n<\/table>","settings":[]},"evals":[],"jsHooks":[]}</script><p>The functions <code>pt$addColumnGroup()</code> and <code>pt$addRowGroup()</code> add a single data group at the top level of the pivot table, where the variable name and value are explicitly specified.</p>
<p>No totals column is added to the above pivot table. This wouldn’t make sense for this pivot table anyway, since some express passenger trains are also DMU trains, so a simple total would double count some trains.</p>
<p>Showing the cell context, as described in the <a href="v09-cellcontext.html">Cell Context</a> vignette, makes the irregularity clearer:</p>
<div class="sourceCode" id="cb7"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">pivottabler</span>)
<span class="no">pt</span> <span class="kw">&lt;-</span> <span class="no">PivotTable</span>$<span class="fu">new</span>()
<span class="no">pt</span>$<span class="fu">addData</span>(<span class="no">bhmtrains</span>)
<span class="no">pt</span>$<span class="fu">addColumnGroup</span>(<span class="kw">variableName</span><span class="kw">=</span><span class="st">"TrainCategory"</span>, <span class="kw">values</span><span class="kw">=</span><span class="st">"Express Passenger"</span>)
<span class="no">pt</span>$<span class="fu">addColumnGroup</span>(<span class="kw">variableName</span><span class="kw">=</span><span class="st">"PowerType"</span>, <span class="kw">values</span><span class="kw">=</span><span class="st">"DMU"</span>)
<span class="no">pt</span>$<span class="fu">addRowDataGroups</span>(<span class="st">"TOC"</span>)
<span class="no">pt</span>$<span class="fu">defineCalculation</span>(<span class="kw">calculationName</span><span class="kw">=</span><span class="st">"TotalTrains"</span>, <span class="kw">summariseExpression</span><span class="kw">=</span><span class="st">"n()"</span>)
<span class="no">pt</span>$<span class="fu">renderPivot</span>(<span class="kw">includeHeaderValues</span><span class="kw">=</span><span class="fl">TRUE</span>, <span class="kw">includeRCFilters</span><span class="kw">=</span><span class="fl">TRUE</span>)</pre></body></html></div>
<div id="htmlwidget-57fcb54e2ed7a139973f" style="width:auto;height:auto;" class="pivottabler html-widget"></div>
<script type="application/json" data-for="htmlwidget-57fcb54e2ed7a139973f">{"x":{"tableCss":".Table {display: table; border-collapse: collapse; }\r\n.ColumnHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px; text-align: center; }\r\n.RowHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px 8px 2px 2px; text-align: left; }\r\n.Cell {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n.OutlineColumnHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px; text-align: center; }\r\n.OutlineRowHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px 8px 2px 2px; text-align: left; }\r\n.OutlineCell {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; background-color: #F8F8F8; font-weight: bold; }\r\n.Total {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n","tableHtml":"<table class=\"Table\">\n  <tr>\n    <th class=\"RowHeader\">&nbsp;<\/th>\n    <th class=\"ColumnHeader\">\n      <p>Express Passenger<\/p>\n      <p style=\"text-align: left; font-size: 75%;\">Filters: <\/p>\n      <ul style=\"text-align: left; font-size: 75%; padding-left: 1em;\">\n        <li>TrainCategory = Express Passenger<\/li>\n      <\/ul>\n    <\/th>\n    <th class=\"ColumnHeader\">\n      <p>DMU<\/p>\n      <p style=\"text-align: left; font-size: 75%;\">Filters: <\/p>\n      <ul style=\"text-align: left; font-size: 75%; padding-left: 1em;\">\n        <li>PowerType = DMU<\/li>\n      <\/ul>\n    <\/th>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">\n      <p>Arriva Trains Wales<\/p>\n      <p style=\"text-align: left; font-size: 75%;\">Filters: <\/p>\n      <ul style=\"text-align: left; font-size: 75%; padding-left: 1em;\">\n        <li>TOC = Arriva Trains Wales<\/li>\n      <\/ul>\n    <\/th>\n    <td class=\"Cell\">\n      <p>3079<\/p>\n      <p style=\"text-align: left; font-size: 75%;\">RC Filters: <\/p>\n      <ul style=\"text-align: left; font-size: 75%; padding-left: 1em;\">\n        <li>TOC = Arriva Trains Wales<\/li>\n        <li>TrainCategory = Express Passenger<\/li>\n      <\/ul>\n    <\/td>\n    <td class=\"Cell\">\n      <p>3909<\/p>\n      <p style=\"text-align: left; font-size: 75%;\">RC Filters: <\/p>\n      <ul style=\"text-align: left; font-size: 75%; padding-left: 1em;\">\n        <li>TOC = Arriva Trains Wales<\/li>\n        <li>PowerType = DMU<\/li>\n      <\/ul>\n    <\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">\n      <p>CrossCountry<\/p>\n      <p style=\"text-align: left; font-size: 75%;\">Filters: <\/p>\n      <ul style=\"text-align: left; font-size: 75%; padding-left: 1em;\">\n        <li>TOC = CrossCountry<\/li>\n      <\/ul>\n    <\/th>\n    <td class=\"Cell\">\n      <p>22865<\/p>\n      <p style=\"text-align: left; font-size: 75%;\">RC Filters: <\/p>\n      <ul style=\"text-align: left; font-size: 75%; padding-left: 1em;\">\n        <li>TOC = CrossCountry<\/li>\n        <li>TrainCategory = Express Passenger<\/li>\n      <\/ul>\n    <\/td>\n    <td class=\"Cell\">\n      <p>22196<\/p>\n      <p style=\"text-align: left; font-size: 75%;\">RC Filters: <\/p>\n      <ul style=\"text-align: left; font-size: 75%; padding-left: 1em;\">\n        <li>TOC = CrossCountry<\/li>\n        <li>PowerType = DMU<\/li>\n      <\/ul>\n    <\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">\n      <p>London Midland<\/p>\n      <p style=\"text-align: left; font-size: 75%;\">Filters: <\/p>\n      <ul style=\"text-align: left; font-size: 75%; padding-left: 1em;\">\n        <li>TOC = London Midland<\/li>\n      <\/ul>\n    <\/th>\n    <td class=\"Cell\">\n      <p>14487<\/p>\n      <p style=\"text-align: left; font-size: 75%;\">RC Filters: <\/p>\n      <ul style=\"text-align: left; font-size: 75%; padding-left: 1em;\">\n        <li>TOC = London Midland<\/li>\n        <li>TrainCategory = Express Passenger<\/li>\n      <\/ul>\n    <\/td>\n    <td class=\"Cell\">\n      <p>11229<\/p>\n      <p style=\"text-align: left; font-size: 75%;\">RC Filters: <\/p>\n      <ul style=\"text-align: left; font-size: 75%; padding-left: 1em;\">\n        <li>TOC = London Midland<\/li>\n        <li>PowerType = DMU<\/li>\n      <\/ul>\n    <\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">\n      <p>Virgin Trains<\/p>\n      <p style=\"text-align: left; font-size: 75%;\">Filters: <\/p>\n      <ul style=\"text-align: left; font-size: 75%; padding-left: 1em;\">\n        <li>TOC = Virgin Trains<\/li>\n      <\/ul>\n    <\/th>\n    <td class=\"Cell\">\n      <p>8594<\/p>\n      <p style=\"text-align: left; font-size: 75%;\">RC Filters: <\/p>\n      <ul style=\"text-align: left; font-size: 75%; padding-left: 1em;\">\n        <li>TOC = Virgin Trains<\/li>\n        <li>TrainCategory = Express Passenger<\/li>\n      <\/ul>\n    <\/td>\n    <td class=\"Cell\">\n      <p>2137<\/p>\n      <p style=\"text-align: left; font-size: 75%;\">RC Filters: <\/p>\n      <ul style=\"text-align: left; font-size: 75%; padding-left: 1em;\">\n        <li>TOC = Virgin Trains<\/li>\n        <li>PowerType = DMU<\/li>\n      <\/ul>\n    <\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">\n      <p>Total<\/p>\n      <p style=\"text-align: left; font-size: 75%;\">Filters: <\/p>\n      <ul style=\"text-align: left; font-size: 75%; padding-left: 1em;\">\n        <li>TOC = ALL<\/li>\n      <\/ul>\n    <\/th>\n    <td class=\"Total\">\n      <p>49025<\/p>\n      <p style=\"text-align: left; font-size: 75%;\">RC Filters: <\/p>\n      <ul style=\"text-align: left; font-size: 75%; padding-left: 1em;\">\n        <li>TOC = ALL<\/li>\n        <li>TrainCategory = Express Passenger<\/li>\n      <\/ul>\n    <\/td>\n    <td class=\"Total\">\n      <p>39471<\/p>\n      <p style=\"text-align: left; font-size: 75%;\">RC Filters: <\/p>\n      <ul style=\"text-align: left; font-size: 75%; padding-left: 1em;\">\n        <li>TOC = ALL<\/li>\n        <li>PowerType = DMU<\/li>\n      <\/ul>\n    <\/td>\n  <\/tr>\n<\/table>","settings":[]},"evals":[],"jsHooks":[]}</script>
</div>
<div id="extending-the-simple-example" class="section level2">
<h2 class="hasAnchor">
<a href="#extending-the-simple-example" class="anchor"></a>Extending the Simple Example</h2>
<p>Further data groups can be added to the pivot table. These data groups can be regular or irregular. Several different examples are shown below. These examples are rather contrived for demonstration purposes.</p>
<p>If a regular level is desired, this can simply be added using the regular <code>addColumnDataGroups()</code> and <code>addRowDataGroups()</code> functions, for example adding the train status:</p>
<div class="sourceCode" id="cb8"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">pivottabler</span>)
<span class="no">pt</span> <span class="kw">&lt;-</span> <span class="no">PivotTable</span>$<span class="fu">new</span>()
<span class="no">pt</span>$<span class="fu">addData</span>(<span class="no">bhmtrains</span>)
<span class="no">pt</span>$<span class="fu">addColumnGroup</span>(<span class="kw">variableName</span><span class="kw">=</span><span class="st">"TrainCategory"</span>, <span class="kw">values</span><span class="kw">=</span><span class="st">"Express Passenger"</span>)
<span class="no">pt</span>$<span class="fu">addColumnGroup</span>(<span class="kw">variableName</span><span class="kw">=</span><span class="st">"PowerType"</span>, <span class="kw">values</span><span class="kw">=</span><span class="st">"DMU"</span>)
<span class="no">pt</span>$<span class="fu">addColumnDataGroups</span>(<span class="st">"Status"</span>)
<span class="no">pt</span>$<span class="fu">addRowDataGroups</span>(<span class="st">"TOC"</span>)
<span class="no">pt</span>$<span class="fu">defineCalculation</span>(<span class="kw">calculationName</span><span class="kw">=</span><span class="st">"TotalTrains"</span>, <span class="kw">summariseExpression</span><span class="kw">=</span><span class="st">"n()"</span>)
<span class="no">pt</span>$<span class="fu">renderPivot</span>()</pre></body></html></div>
<div id="htmlwidget-e9282d563c3932a670b6" style="width:auto;height:auto;" class="pivottabler html-widget"></div>
<script type="application/json" data-for="htmlwidget-e9282d563c3932a670b6">{"x":{"tableCss":".Table {display: table; border-collapse: collapse; }\r\n.ColumnHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px; text-align: center; }\r\n.RowHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px 8px 2px 2px; text-align: left; }\r\n.Cell {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n.OutlineColumnHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px; text-align: center; }\r\n.OutlineRowHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px 8px 2px 2px; text-align: left; }\r\n.OutlineCell {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; background-color: #F8F8F8; font-weight: bold; }\r\n.Total {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n","tableHtml":"<table class=\"Table\">\n  <tr>\n    <th class=\"RowHeader\" rowspan=\"2\">&nbsp;<\/th>\n    <th class=\"ColumnHeader\" colspan=\"4\">Express Passenger<\/th>\n    <th class=\"ColumnHeader\" colspan=\"4\">DMU<\/th>\n  <\/tr>\n  <tr>\n    <th class=\"ColumnHeader\">A<\/th>\n    <th class=\"ColumnHeader\">C<\/th>\n    <th class=\"ColumnHeader\">R<\/th>\n    <th class=\"ColumnHeader\">Total<\/th>\n    <th class=\"ColumnHeader\">A<\/th>\n    <th class=\"ColumnHeader\">C<\/th>\n    <th class=\"ColumnHeader\">R<\/th>\n    <th class=\"ColumnHeader\">Total<\/th>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Arriva Trains Wales<\/th>\n    <td class=\"Cell\">3018<\/td>\n    <td class=\"Cell\">59<\/td>\n    <td class=\"Cell\">2<\/td>\n    <td class=\"Total\">3079<\/td>\n    <td class=\"Cell\">3833<\/td>\n    <td class=\"Cell\">74<\/td>\n    <td class=\"Cell\">2<\/td>\n    <td class=\"Total\">3909<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">CrossCountry<\/th>\n    <td class=\"Cell\">22270<\/td>\n    <td class=\"Cell\">569<\/td>\n    <td class=\"Cell\">26<\/td>\n    <td class=\"Total\">22865<\/td>\n    <td class=\"Cell\">21621<\/td>\n    <td class=\"Cell\">548<\/td>\n    <td class=\"Cell\">27<\/td>\n    <td class=\"Total\">22196<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">London Midland<\/th>\n    <td class=\"Cell\">14133<\/td>\n    <td class=\"Cell\">336<\/td>\n    <td class=\"Cell\">18<\/td>\n    <td class=\"Total\">14487<\/td>\n    <td class=\"Cell\">11054<\/td>\n    <td class=\"Cell\">168<\/td>\n    <td class=\"Cell\">7<\/td>\n    <td class=\"Total\">11229<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Virgin Trains<\/th>\n    <td class=\"Cell\">8359<\/td>\n    <td class=\"Cell\">226<\/td>\n    <td class=\"Cell\">9<\/td>\n    <td class=\"Total\">8594<\/td>\n    <td class=\"Cell\">2028<\/td>\n    <td class=\"Cell\">107<\/td>\n    <td class=\"Cell\">2<\/td>\n    <td class=\"Total\">2137<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Total<\/th>\n    <td class=\"Total\">47780<\/td>\n    <td class=\"Total\">1190<\/td>\n    <td class=\"Total\">55<\/td>\n    <td class=\"Total\">49025<\/td>\n    <td class=\"Total\">38536<\/td>\n    <td class=\"Total\">897<\/td>\n    <td class=\"Total\">38<\/td>\n    <td class=\"Total\">39471<\/td>\n  <\/tr>\n<\/table>","settings":[]},"evals":[],"jsHooks":[]}</script><p>The <code>addColumnGroup()</code> and <code>addRowGroup()</code> functions return the new data group that has been added. The <code>addChildGroup()</code> function can be called on each of these groups to add further groups underneath:</p>
<div class="sourceCode" id="cb9"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">pivottabler</span>)
<span class="no">pt</span> <span class="kw">&lt;-</span> <span class="no">PivotTable</span>$<span class="fu">new</span>()
<span class="no">pt</span>$<span class="fu">addData</span>(<span class="no">bhmtrains</span>)
<span class="no">cg1</span> <span class="kw">&lt;-</span> <span class="no">pt</span>$<span class="fu">addColumnGroup</span>(<span class="kw">variableName</span><span class="kw">=</span><span class="st">"TrainCategory"</span>, <span class="kw">values</span><span class="kw">=</span><span class="st">"Express Passenger"</span>)
<span class="no">cg2</span> <span class="kw">&lt;-</span> <span class="no">pt</span>$<span class="fu">addColumnGroup</span>(<span class="kw">variableName</span><span class="kw">=</span><span class="st">"PowerType"</span>, <span class="kw">values</span><span class="kw">=</span><span class="st">"DMU"</span>)
<span class="no">cg1</span>$<span class="fu">addChildGroup</span>(<span class="kw">variableName</span><span class="kw">=</span><span class="st">"Status"</span>, <span class="kw">values</span><span class="kw">=</span><span class="st">"A"</span>)
<span class="no">cg1</span>$<span class="fu">addChildGroup</span>(<span class="kw">variableName</span><span class="kw">=</span><span class="st">"Status"</span>, <span class="kw">values</span><span class="kw">=</span><span class="st">"R"</span>)
<span class="no">cg2</span>$<span class="fu">addChildGroup</span>(<span class="kw">variableName</span><span class="kw">=</span><span class="st">"SchedSpeedMPH"</span>, <span class="kw">values</span><span class="kw">=</span><span class="st">"100"</span>)
<span class="no">pt</span>$<span class="fu">addRowDataGroups</span>(<span class="st">"TOC"</span>)
<span class="no">pt</span>$<span class="fu">defineCalculation</span>(<span class="kw">calculationName</span><span class="kw">=</span><span class="st">"TotalTrains"</span>, <span class="kw">summariseExpression</span><span class="kw">=</span><span class="st">"n()"</span>)
<span class="no">pt</span>$<span class="fu">renderPivot</span>()</pre></body></html></div>
<div id="htmlwidget-2fc1bdb52550619fac86" style="width:auto;height:auto;" class="pivottabler html-widget"></div>
<script type="application/json" data-for="htmlwidget-2fc1bdb52550619fac86">{"x":{"tableCss":".Table {display: table; border-collapse: collapse; }\r\n.ColumnHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px; text-align: center; }\r\n.RowHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px 8px 2px 2px; text-align: left; }\r\n.Cell {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n.OutlineColumnHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px; text-align: center; }\r\n.OutlineRowHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px 8px 2px 2px; text-align: left; }\r\n.OutlineCell {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; background-color: #F8F8F8; font-weight: bold; }\r\n.Total {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n","tableHtml":"<table class=\"Table\">\n  <tr>\n    <th class=\"RowHeader\" rowspan=\"2\">&nbsp;<\/th>\n    <th class=\"ColumnHeader\" colspan=\"2\">Express Passenger<\/th>\n    <th class=\"ColumnHeader\">DMU<\/th>\n  <\/tr>\n  <tr>\n    <th class=\"ColumnHeader\">A<\/th>\n    <th class=\"ColumnHeader\">R<\/th>\n    <th class=\"ColumnHeader\">100<\/th>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Arriva Trains Wales<\/th>\n    <td class=\"Cell\">3018<\/td>\n    <td class=\"Cell\">2<\/td>\n    <td class=\"Cell\"><\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">CrossCountry<\/th>\n    <td class=\"Cell\">22270<\/td>\n    <td class=\"Cell\">26<\/td>\n    <td class=\"Cell\">11024<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">London Midland<\/th>\n    <td class=\"Cell\">14133<\/td>\n    <td class=\"Cell\">18<\/td>\n    <td class=\"Cell\">2723<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Virgin Trains<\/th>\n    <td class=\"Cell\">8359<\/td>\n    <td class=\"Cell\">9<\/td>\n    <td class=\"Cell\"><\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Total<\/th>\n    <td class=\"Total\">47780<\/td>\n    <td class=\"Total\">55<\/td>\n    <td class=\"Total\">13747<\/td>\n  <\/tr>\n<\/table>","settings":[]},"evals":[],"jsHooks":[]}</script><p>Instead of adding groups one at a time, the <code>addDataGroups()</code> function can be called on these data groups to add different data groups for different variables underneath each:</p>
<div class="sourceCode" id="cb10"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">pivottabler</span>)
<span class="no">pt</span> <span class="kw">&lt;-</span> <span class="no">PivotTable</span>$<span class="fu">new</span>()
<span class="no">pt</span>$<span class="fu">addData</span>(<span class="no">bhmtrains</span>)
<span class="no">cg1</span> <span class="kw">&lt;-</span> <span class="no">pt</span>$<span class="fu">addColumnGroup</span>(<span class="kw">variableName</span><span class="kw">=</span><span class="st">"TrainCategory"</span>, <span class="kw">values</span><span class="kw">=</span><span class="st">"Express Passenger"</span>)
<span class="no">cg2</span> <span class="kw">&lt;-</span> <span class="no">pt</span>$<span class="fu">addColumnGroup</span>(<span class="kw">variableName</span><span class="kw">=</span><span class="st">"PowerType"</span>, <span class="kw">values</span><span class="kw">=</span><span class="st">"DMU"</span>)
<span class="no">cg1</span>$<span class="fu">addDataGroups</span>(<span class="st">"Status"</span>)
<span class="no">cg2</span>$<span class="fu">addDataGroups</span>(<span class="st">"SchedSpeedMPH"</span>)
<span class="no">pt</span>$<span class="fu">addRowDataGroups</span>(<span class="st">"TOC"</span>)
<span class="no">pt</span>$<span class="fu">defineCalculation</span>(<span class="kw">calculationName</span><span class="kw">=</span><span class="st">"TotalTrains"</span>, <span class="kw">summariseExpression</span><span class="kw">=</span><span class="st">"n()"</span>)
<span class="no">pt</span>$<span class="fu">renderPivot</span>()</pre></body></html></div>
<div id="htmlwidget-469917dde099bd3f48b6" style="width:auto;height:auto;" class="pivottabler html-widget"></div>
<script type="application/json" data-for="htmlwidget-469917dde099bd3f48b6">{"x":{"tableCss":".Table {display: table; border-collapse: collapse; }\r\n.ColumnHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px; text-align: center; }\r\n.RowHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px 8px 2px 2px; text-align: left; }\r\n.Cell {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n.OutlineColumnHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px; text-align: center; }\r\n.OutlineRowHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px 8px 2px 2px; text-align: left; }\r\n.OutlineCell {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; background-color: #F8F8F8; font-weight: bold; }\r\n.Total {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n","tableHtml":"<table class=\"Table\">\n  <tr>\n    <th class=\"RowHeader\" rowspan=\"2\">&nbsp;<\/th>\n    <th class=\"ColumnHeader\" colspan=\"4\">Express Passenger<\/th>\n    <th class=\"ColumnHeader\" colspan=\"6\">DMU<\/th>\n  <\/tr>\n  <tr>\n    <th class=\"ColumnHeader\">A<\/th>\n    <th class=\"ColumnHeader\">C<\/th>\n    <th class=\"ColumnHeader\">R<\/th>\n    <th class=\"ColumnHeader\">Total<\/th>\n    <th class=\"ColumnHeader\">75<\/th>\n    <th class=\"ColumnHeader\">90<\/th>\n    <th class=\"ColumnHeader\">100<\/th>\n    <th class=\"ColumnHeader\">125<\/th>\n    <th class=\"ColumnHeader\">NA<\/th>\n    <th class=\"ColumnHeader\">Total<\/th>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Arriva Trains Wales<\/th>\n    <td class=\"Cell\">3018<\/td>\n    <td class=\"Cell\">59<\/td>\n    <td class=\"Cell\">2<\/td>\n    <td class=\"Total\">3079<\/td>\n    <td class=\"Cell\">121<\/td>\n    <td class=\"Cell\">3761<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\">27<\/td>\n    <td class=\"Total\">3909<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">CrossCountry<\/th>\n    <td class=\"Cell\">22270<\/td>\n    <td class=\"Cell\">569<\/td>\n    <td class=\"Cell\">26<\/td>\n    <td class=\"Total\">22865<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\">11024<\/td>\n    <td class=\"Cell\">11040<\/td>\n    <td class=\"Cell\">132<\/td>\n    <td class=\"Total\">22196<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">London Midland<\/th>\n    <td class=\"Cell\">14133<\/td>\n    <td class=\"Cell\">336<\/td>\n    <td class=\"Cell\">18<\/td>\n    <td class=\"Total\">14487<\/td>\n    <td class=\"Cell\">6104<\/td>\n    <td class=\"Cell\">2399<\/td>\n    <td class=\"Cell\">2723<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\">3<\/td>\n    <td class=\"Total\">11229<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Virgin Trains<\/th>\n    <td class=\"Cell\">8359<\/td>\n    <td class=\"Cell\">226<\/td>\n    <td class=\"Cell\">9<\/td>\n    <td class=\"Total\">8594<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\">2135<\/td>\n    <td class=\"Cell\">2<\/td>\n    <td class=\"Total\">2137<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Total<\/th>\n    <td class=\"Total\">47780<\/td>\n    <td class=\"Total\">1190<\/td>\n    <td class=\"Total\">55<\/td>\n    <td class=\"Total\">49025<\/td>\n    <td class=\"Total\">6225<\/td>\n    <td class=\"Total\">6160<\/td>\n    <td class=\"Total\">13747<\/td>\n    <td class=\"Total\">13175<\/td>\n    <td class=\"Total\">164<\/td>\n    <td class=\"Total\">39471<\/td>\n  <\/tr>\n<\/table>","settings":[]},"evals":[],"jsHooks":[]}</script>
</div>
<div id="iterating-groups" class="section level2">
<h2 class="hasAnchor">
<a href="#iterating-groups" class="anchor"></a>Iterating Groups</h2>
<p>The <code>addColumnDataGroups()</code>, <code>addRowDataGroups()</code> and <code>addDataGroups()</code> functions<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a> all return zero, one or multiple data groups, in the form of an R list. This list can be iterated or used with functions such as <code><a href="https://rdrr.io/r/base/lapply.html">lapply()</a></code> in the usual ways. Each data group has a set of properties that can be used to examine the group. For example, adding further child groups:</p>
<div class="sourceCode" id="cb11"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">pivottabler</span>)
<span class="no">pt</span> <span class="kw">&lt;-</span> <span class="no">PivotTable</span>$<span class="fu">new</span>()
<span class="no">pt</span>$<span class="fu">addData</span>(<span class="no">bhmtrains</span>)
<span class="no">pt</span>$<span class="fu">addColumnDataGroups</span>(<span class="st">"TrainCategory"</span>)
<span class="no">cgrps</span> <span class="kw">&lt;-</span> <span class="no">pt</span>$<span class="fu">addColumnDataGroups</span>(<span class="st">"PowerType"</span>, <span class="kw">addTotal</span><span class="kw">=</span><span class="fl">FALSE</span>)
<span class="no">add2Groups</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">grp</span>) {
  <span class="kw">if</span>(!<span class="no">grp</span>$<span class="no">isTotal</span>) {
    <span class="no">grp</span>$<span class="fu">addChildGroup</span>(<span class="kw">variableName</span><span class="kw">=</span><span class="st">"Status"</span>, <span class="kw">values</span><span class="kw">=</span><span class="st">"A"</span>)
    <span class="no">grp</span>$<span class="fu">addChildGroup</span>(<span class="kw">variableName</span><span class="kw">=</span><span class="st">"Status"</span>, <span class="kw">values</span><span class="kw">=</span><span class="st">"R"</span>)
  }
}
<span class="fu"><a href="https://rdrr.io/r/base/invisible.html">invisible</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(<span class="no">cgrps</span>, <span class="no">add2Groups</span>))
<span class="no">pt</span>$<span class="fu">addRowDataGroups</span>(<span class="st">"TOC"</span>)
<span class="no">pt</span>$<span class="fu">defineCalculation</span>(<span class="kw">calculationName</span><span class="kw">=</span><span class="st">"TotalTrains"</span>, <span class="kw">summariseExpression</span><span class="kw">=</span><span class="st">"n()"</span>)
<span class="no">pt</span>$<span class="fu">renderPivot</span>()</pre></body></html></div>
<div id="htmlwidget-29ea411b6e6318ae6ced" style="width:auto;height:auto;" class="pivottabler html-widget"></div>
<script type="application/json" data-for="htmlwidget-29ea411b6e6318ae6ced">{"x":{"tableCss":".Table {display: table; border-collapse: collapse; }\r\n.ColumnHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px; text-align: center; }\r\n.RowHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px 8px 2px 2px; text-align: left; }\r\n.Cell {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n.OutlineColumnHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px; text-align: center; }\r\n.OutlineRowHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px 8px 2px 2px; text-align: left; }\r\n.OutlineCell {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; background-color: #F8F8F8; font-weight: bold; }\r\n.Total {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n","tableHtml":"<table class=\"Table\">\n  <tr>\n    <th class=\"RowHeader\" rowspan=\"3\">&nbsp;<\/th>\n    <th class=\"ColumnHeader\" colspan=\"6\">Express Passenger<\/th>\n    <th class=\"ColumnHeader\" colspan=\"4\">Ordinary Passenger<\/th>\n    <th class=\"ColumnHeader\">Total<\/th>\n  <\/tr>\n  <tr>\n    <th class=\"ColumnHeader\" colspan=\"2\">DMU<\/th>\n    <th class=\"ColumnHeader\" colspan=\"2\">EMU<\/th>\n    <th class=\"ColumnHeader\" colspan=\"2\">HST<\/th>\n    <th class=\"ColumnHeader\" colspan=\"2\">DMU<\/th>\n    <th class=\"ColumnHeader\" colspan=\"2\">EMU<\/th>\n    <th class=\"ColumnHeader\">&nbsp;<\/th>\n  <\/tr>\n  <tr>\n    <th class=\"ColumnHeader\">A<\/th>\n    <th class=\"ColumnHeader\">R<\/th>\n    <th class=\"ColumnHeader\">A<\/th>\n    <th class=\"ColumnHeader\">R<\/th>\n    <th class=\"ColumnHeader\">A<\/th>\n    <th class=\"ColumnHeader\">R<\/th>\n    <th class=\"ColumnHeader\">A<\/th>\n    <th class=\"ColumnHeader\">R<\/th>\n    <th class=\"ColumnHeader\">A<\/th>\n    <th class=\"ColumnHeader\">R<\/th>\n    <th class=\"ColumnHeader\">&nbsp;<\/th>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Arriva Trains Wales<\/th>\n    <td class=\"Cell\">3018<\/td>\n    <td class=\"Cell\">2<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\">815<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">3909<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">CrossCountry<\/th>\n    <td class=\"Cell\">21561<\/td>\n    <td class=\"Cell\">26<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\">709<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\">60<\/td>\n    <td class=\"Cell\">1<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">22928<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">London Midland<\/th>\n    <td class=\"Cell\">5534<\/td>\n    <td class=\"Cell\">3<\/td>\n    <td class=\"Cell\">8599<\/td>\n    <td class=\"Cell\">15<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\">5520<\/td>\n    <td class=\"Cell\">4<\/td>\n    <td class=\"Cell\">27331<\/td>\n    <td class=\"Cell\">23<\/td>\n    <td class=\"Total\">48279<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Virgin Trains<\/th>\n    <td class=\"Cell\">2028<\/td>\n    <td class=\"Cell\">2<\/td>\n    <td class=\"Cell\">6331<\/td>\n    <td class=\"Cell\">7<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">8594<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Total<\/th>\n    <td class=\"Total\">32141<\/td>\n    <td class=\"Total\">33<\/td>\n    <td class=\"Total\">14930<\/td>\n    <td class=\"Total\">22<\/td>\n    <td class=\"Total\">709<\/td>\n    <td class=\"Total\"><\/td>\n    <td class=\"Total\">6395<\/td>\n    <td class=\"Total\">5<\/td>\n    <td class=\"Total\">27331<\/td>\n    <td class=\"Total\">23<\/td>\n    <td class=\"Total\">83710<\/td>\n  <\/tr>\n<\/table>","settings":[]},"evals":[],"jsHooks":[]}</script><p>Another example - setting the text colour:</p>
<div class="sourceCode" id="cb12"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">pivottabler</span>)
<span class="no">pt</span> <span class="kw">&lt;-</span> <span class="no">PivotTable</span>$<span class="fu">new</span>()
<span class="no">pt</span>$<span class="fu">addData</span>(<span class="no">bhmtrains</span>)
<span class="no">pt</span>$<span class="fu">addColumnDataGroups</span>(<span class="st">"TrainCategory"</span>)
<span class="no">cgrps</span> <span class="kw">&lt;-</span> <span class="no">pt</span>$<span class="fu">addColumnDataGroups</span>(<span class="st">"PowerType"</span>)
<span class="no">colorText</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">grp</span>) {
  <span class="kw">if</span>(<span class="fu"><a href="https://rdrr.io/r/base/Logic.html">isTRUE</a></span>(<span class="no">grp</span>$<span class="no">values</span><span class="kw">==</span><span class="st">"DMU"</span>)) <span class="no">grp</span>$<span class="fu">setStyling</span>(<span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">color</span><span class="kw">=</span><span class="st">"blue"</span>))
  <span class="kw">else</span> <span class="kw">if</span>(<span class="fu"><a href="https://rdrr.io/r/base/Logic.html">isTRUE</a></span>(<span class="no">grp</span>$<span class="no">values</span><span class="kw">==</span><span class="st">"EMU"</span>)) <span class="no">grp</span>$<span class="fu">setStyling</span>(<span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">color</span><span class="kw">=</span><span class="st">"green"</span>))
  <span class="kw">else</span> <span class="kw">if</span>(<span class="fu"><a href="https://rdrr.io/r/base/Logic.html">isTRUE</a></span>(<span class="no">grp</span>$<span class="no">values</span><span class="kw">==</span><span class="st">"HST"</span>)) <span class="no">grp</span>$<span class="fu">setStyling</span>(<span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">color</span><span class="kw">=</span><span class="st">"red"</span>))
}
<span class="fu"><a href="https://rdrr.io/r/base/invisible.html">invisible</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(<span class="no">cgrps</span>, <span class="no">colorText</span>))
<span class="no">pt</span>$<span class="fu">addRowDataGroups</span>(<span class="st">"TOC"</span>)
<span class="no">pt</span>$<span class="fu">defineCalculation</span>(<span class="kw">calculationName</span><span class="kw">=</span><span class="st">"TotalTrains"</span>, <span class="kw">summariseExpression</span><span class="kw">=</span><span class="st">"n()"</span>)
<span class="no">pt</span>$<span class="fu">renderPivot</span>()</pre></body></html></div>
<div id="htmlwidget-21e91fb33a97d429d118" style="width:auto;height:auto;" class="pivottabler html-widget"></div>
<script type="application/json" data-for="htmlwidget-21e91fb33a97d429d118">{"x":{"tableCss":".Table {display: table; border-collapse: collapse; }\r\n.ColumnHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px; text-align: center; }\r\n.RowHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px 8px 2px 2px; text-align: left; }\r\n.Cell {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n.OutlineColumnHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px; text-align: center; }\r\n.OutlineRowHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px 8px 2px 2px; text-align: left; }\r\n.OutlineCell {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; background-color: #F8F8F8; font-weight: bold; }\r\n.Total {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n","tableHtml":"<table class=\"Table\">\n  <tr>\n    <th class=\"RowHeader\" rowspan=\"2\">&nbsp;<\/th>\n    <th class=\"ColumnHeader\" colspan=\"4\">Express Passenger<\/th>\n    <th class=\"ColumnHeader\" colspan=\"3\">Ordinary Passenger<\/th>\n    <th class=\"ColumnHeader\">Total<\/th>\n  <\/tr>\n  <tr>\n    <th class=\"ColumnHeader\" style=\"color: blue; \">DMU<\/th>\n    <th class=\"ColumnHeader\" style=\"color: green; \">EMU<\/th>\n    <th class=\"ColumnHeader\" style=\"color: red; \">HST<\/th>\n    <th class=\"ColumnHeader\">Total<\/th>\n    <th class=\"ColumnHeader\" style=\"color: blue; \">DMU<\/th>\n    <th class=\"ColumnHeader\" style=\"color: green; \">EMU<\/th>\n    <th class=\"ColumnHeader\">Total<\/th>\n    <th class=\"ColumnHeader\">&nbsp;<\/th>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Arriva Trains Wales<\/th>\n    <td class=\"Cell\">3079<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">3079<\/td>\n    <td class=\"Cell\">830<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">830<\/td>\n    <td class=\"Total\">3909<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">CrossCountry<\/th>\n    <td class=\"Cell\">22133<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\">732<\/td>\n    <td class=\"Total\">22865<\/td>\n    <td class=\"Cell\">63<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">63<\/td>\n    <td class=\"Total\">22928<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">London Midland<\/th>\n    <td class=\"Cell\">5638<\/td>\n    <td class=\"Cell\">8849<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">14487<\/td>\n    <td class=\"Cell\">5591<\/td>\n    <td class=\"Cell\">28201<\/td>\n    <td class=\"Total\">33792<\/td>\n    <td class=\"Total\">48279<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Virgin Trains<\/th>\n    <td class=\"Cell\">2137<\/td>\n    <td class=\"Cell\">6457<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">8594<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\"><\/td>\n    <td class=\"Total\">8594<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Total<\/th>\n    <td class=\"Total\">32987<\/td>\n    <td class=\"Total\">15306<\/td>\n    <td class=\"Total\">732<\/td>\n    <td class=\"Total\">49025<\/td>\n    <td class=\"Total\">6484<\/td>\n    <td class=\"Total\">28201<\/td>\n    <td class=\"Total\">34685<\/td>\n    <td class=\"Total\">83710<\/td>\n  <\/tr>\n<\/table>","settings":[]},"evals":[],"jsHooks":[]}</script>
</div>
<div id="multiple-calculation-groups" class="section level2">
<h2 class="hasAnchor">
<a href="#multiple-calculation-groups" class="anchor"></a>Multiple Calculation Groups</h2>
<p>Sometimes it is desirable to use different calculations in different parts of the pivot table. Returning to the initial irregular example:</p>
<div class="sourceCode" id="cb13"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">pivottabler</span>)
<span class="no">pt</span> <span class="kw">&lt;-</span> <span class="no">PivotTable</span>$<span class="fu">new</span>()
<span class="no">pt</span>$<span class="fu">addData</span>(<span class="no">bhmtrains</span>)
<span class="no">pt</span>$<span class="fu">addColumnGroup</span>(<span class="kw">variableName</span><span class="kw">=</span><span class="st">"TrainCategory"</span>, <span class="kw">values</span><span class="kw">=</span><span class="st">"Express Passenger"</span>)
<span class="no">pt</span>$<span class="fu">addColumnGroup</span>(<span class="kw">variableName</span><span class="kw">=</span><span class="st">"PowerType"</span>, <span class="kw">values</span><span class="kw">=</span><span class="st">"DMU"</span>)
<span class="no">pt</span>$<span class="fu">addRowDataGroups</span>(<span class="st">"TOC"</span>)
<span class="no">pt</span>$<span class="fu">defineCalculation</span>(<span class="kw">calculationName</span><span class="kw">=</span><span class="st">"TotalTrains"</span>, <span class="kw">summariseExpression</span><span class="kw">=</span><span class="st">"n()"</span>)
<span class="no">pt</span>$<span class="fu">renderPivot</span>()</pre></body></html></div>
<div id="htmlwidget-4eae1cb14115cc826be5" style="width:auto;height:auto;" class="pivottabler html-widget"></div>
<script type="application/json" data-for="htmlwidget-4eae1cb14115cc826be5">{"x":{"tableCss":".Table {display: table; border-collapse: collapse; }\r\n.ColumnHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px; text-align: center; }\r\n.RowHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px 8px 2px 2px; text-align: left; }\r\n.Cell {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n.OutlineColumnHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px; text-align: center; }\r\n.OutlineRowHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px 8px 2px 2px; text-align: left; }\r\n.OutlineCell {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; background-color: #F8F8F8; font-weight: bold; }\r\n.Total {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n","tableHtml":"<table class=\"Table\">\n  <tr>\n    <th class=\"RowHeader\">&nbsp;<\/th>\n    <th class=\"ColumnHeader\">Express Passenger<\/th>\n    <th class=\"ColumnHeader\">DMU<\/th>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Arriva Trains Wales<\/th>\n    <td class=\"Cell\">3079<\/td>\n    <td class=\"Cell\">3909<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">CrossCountry<\/th>\n    <td class=\"Cell\">22865<\/td>\n    <td class=\"Cell\">22196<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">London Midland<\/th>\n    <td class=\"Cell\">14487<\/td>\n    <td class=\"Cell\">11229<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Virgin Trains<\/th>\n    <td class=\"Cell\">8594<\/td>\n    <td class=\"Cell\">2137<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Total<\/th>\n    <td class=\"Total\">49025<\/td>\n    <td class=\"Total\">39471<\/td>\n  <\/tr>\n<\/table>","settings":[]},"evals":[],"jsHooks":[]}</script><p>Suppose we require the number of express trains but the maximum scheduled speed of the DMU trains. We might naively try the following R:</p>
<div class="sourceCode" id="cb14"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">pivottabler</span>)
<span class="no">pt</span> <span class="kw">&lt;-</span> <span class="no">PivotTable</span>$<span class="fu">new</span>()
<span class="no">pt</span>$<span class="fu">addData</span>(<span class="no">bhmtrains</span>)
<span class="no">pt</span>$<span class="fu">addColumnGroup</span>(<span class="kw">variableName</span><span class="kw">=</span><span class="st">"TrainCategory"</span>, <span class="kw">values</span><span class="kw">=</span><span class="st">"Express Passenger"</span>)
<span class="no">pt</span>$<span class="fu">addColumnGroup</span>(<span class="kw">variableName</span><span class="kw">=</span><span class="st">"PowerType"</span>, <span class="kw">values</span><span class="kw">=</span><span class="st">"DMU"</span>)
<span class="no">pt</span>$<span class="fu">addRowDataGroups</span>(<span class="st">"TOC"</span>)
<span class="no">pt</span>$<span class="fu">defineCalculation</span>(<span class="kw">calculationName</span><span class="kw">=</span><span class="st">"TotalTrains"</span>, <span class="kw">caption</span><span class="kw">=</span><span class="st">"Count"</span>,
                     <span class="kw">summariseExpression</span><span class="kw">=</span><span class="st">"n()"</span>)
<span class="no">pt</span>$<span class="fu">defineCalculation</span>(<span class="kw">calculationName</span><span class="kw">=</span><span class="st">"MaxSpeedMPH"</span>, <span class="kw">caption</span><span class="kw">=</span><span class="st">"Maximum Speed"</span>,
                     <span class="kw">summariseExpression</span><span class="kw">=</span><span class="st">"max(SchedSpeedMPH, na.rm=TRUE)"</span>)
<span class="no">pt</span>$<span class="fu">renderPivot</span>()</pre></body></html></div>
<div id="htmlwidget-39dbf397a3fec1a45920" style="width:auto;height:auto;" class="pivottabler html-widget"></div>
<script type="application/json" data-for="htmlwidget-39dbf397a3fec1a45920">{"x":{"tableCss":".Table {display: table; border-collapse: collapse; }\r\n.ColumnHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px; text-align: center; }\r\n.RowHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px 8px 2px 2px; text-align: left; }\r\n.Cell {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n.OutlineColumnHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px; text-align: center; }\r\n.OutlineRowHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px 8px 2px 2px; text-align: left; }\r\n.OutlineCell {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; background-color: #F8F8F8; font-weight: bold; }\r\n.Total {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n","tableHtml":"<table class=\"Table\">\n  <tr>\n    <th class=\"RowHeader\" rowspan=\"2\">&nbsp;<\/th>\n    <th class=\"ColumnHeader\" colspan=\"2\">Express Passenger<\/th>\n    <th class=\"ColumnHeader\" colspan=\"2\">DMU<\/th>\n  <\/tr>\n  <tr>\n    <th class=\"ColumnHeader\">Count<\/th>\n    <th class=\"ColumnHeader\">Maximum Speed<\/th>\n    <th class=\"ColumnHeader\">Count<\/th>\n    <th class=\"ColumnHeader\">Maximum Speed<\/th>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Arriva Trains Wales<\/th>\n    <td class=\"Cell\">3079<\/td>\n    <td class=\"Cell\">90<\/td>\n    <td class=\"Cell\">3909<\/td>\n    <td class=\"Cell\">90<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">CrossCountry<\/th>\n    <td class=\"Cell\">22865<\/td>\n    <td class=\"Cell\">125<\/td>\n    <td class=\"Cell\">22196<\/td>\n    <td class=\"Cell\">125<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">London Midland<\/th>\n    <td class=\"Cell\">14487<\/td>\n    <td class=\"Cell\">110<\/td>\n    <td class=\"Cell\">11229<\/td>\n    <td class=\"Cell\">100<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Virgin Trains<\/th>\n    <td class=\"Cell\">8594<\/td>\n    <td class=\"Cell\">125<\/td>\n    <td class=\"Cell\">2137<\/td>\n    <td class=\"Cell\">125<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Total<\/th>\n    <td class=\"Total\">49025<\/td>\n    <td class=\"Total\">125<\/td>\n    <td class=\"Total\">39471<\/td>\n    <td class=\"Total\">125<\/td>\n  <\/tr>\n<\/table>","settings":[]},"evals":[],"jsHooks":[]}</script><p>This has replicated both calculations across the whole pivot table, which is not what we wanted.</p>
<p>Instead the solution is to define an additional<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a> calculation group, then explicitly add the two calculation groups to the relevant parts of the pivot table:</p>
<div class="sourceCode" id="cb15"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">pivottabler</span>)
<span class="no">pt</span> <span class="kw">&lt;-</span> <span class="no">PivotTable</span>$<span class="fu">new</span>()
<span class="no">pt</span>$<span class="fu">addData</span>(<span class="no">bhmtrains</span>)
<span class="no">cg1</span> <span class="kw">&lt;-</span> <span class="no">pt</span>$<span class="fu">addColumnGroup</span>(<span class="kw">variableName</span><span class="kw">=</span><span class="st">"TrainCategory"</span>, <span class="kw">values</span><span class="kw">=</span><span class="st">"Express Passenger"</span>)
<span class="no">cg2</span> <span class="kw">&lt;-</span> <span class="no">pt</span>$<span class="fu">addColumnGroup</span>(<span class="kw">variableName</span><span class="kw">=</span><span class="st">"PowerType"</span>, <span class="kw">values</span><span class="kw">=</span><span class="st">"DMU"</span>)
<span class="no">pt</span>$<span class="fu">addRowDataGroups</span>(<span class="st">"TOC"</span>)
<span class="no">pt</span>$<span class="fu">defineCalculation</span>(<span class="kw">calculationName</span><span class="kw">=</span><span class="st">"TotalTrains"</span>, <span class="kw">summariseExpression</span><span class="kw">=</span><span class="st">"n()"</span>)
<span class="no">pt</span>$<span class="fu">defineCalculation</span>(<span class="kw">calculationGroupName</span><span class="kw">=</span><span class="st">"calcGrp2"</span>, <span class="kw">calculationName</span><span class="kw">=</span><span class="st">"MaxSpeedMPH"</span>,
                     <span class="kw">summariseExpression</span><span class="kw">=</span><span class="st">"max(SchedSpeedMPH, na.rm=TRUE)"</span>)
<span class="no">cg1</span>$<span class="fu">addCalculationGroups</span>(<span class="st">"default"</span>)
<span class="no">cg2</span>$<span class="fu">addCalculationGroups</span>(<span class="st">"calcGrp2"</span>)
<span class="no">pt</span>$<span class="fu">renderPivot</span>()</pre></body></html></div>
<div id="htmlwidget-9a6de14e7c5e1a99fbff" style="width:auto;height:auto;" class="pivottabler html-widget"></div>
<script type="application/json" data-for="htmlwidget-9a6de14e7c5e1a99fbff">{"x":{"tableCss":".Table {display: table; border-collapse: collapse; }\r\n.ColumnHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px; text-align: center; }\r\n.RowHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px 8px 2px 2px; text-align: left; }\r\n.Cell {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n.OutlineColumnHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px; text-align: center; }\r\n.OutlineRowHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px 8px 2px 2px; text-align: left; }\r\n.OutlineCell {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; background-color: #F8F8F8; font-weight: bold; }\r\n.Total {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n","tableHtml":"<table class=\"Table\">\n  <tr>\n    <th class=\"RowHeader\">&nbsp;<\/th>\n    <th class=\"ColumnHeader\">Express Passenger<\/th>\n    <th class=\"ColumnHeader\">DMU<\/th>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Arriva Trains Wales<\/th>\n    <td class=\"Cell\">3079<\/td>\n    <td class=\"Cell\">90<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">CrossCountry<\/th>\n    <td class=\"Cell\">22865<\/td>\n    <td class=\"Cell\">125<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">London Midland<\/th>\n    <td class=\"Cell\">14487<\/td>\n    <td class=\"Cell\">100<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Virgin Trains<\/th>\n    <td class=\"Cell\">8594<\/td>\n    <td class=\"Cell\">125<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Total<\/th>\n    <td class=\"Total\">49025<\/td>\n    <td class=\"Total\">125<\/td>\n  <\/tr>\n<\/table>","settings":[]},"evals":[],"jsHooks":[]}</script><p>Pivot tables like the above are quite likely to cause confusion. Either the caption of the existing data groups needs changing or additional empty groups with captions should be added. Both of these are demonstrated below.</p>
<div id="changing-the-data-group-captions" class="section level3">
<h3 class="hasAnchor">
<a href="#changing-the-data-group-captions" class="anchor"></a>Changing the data group captions</h3>
<p>The example below explicitly specifies the captions of the column data groups.</p>
<div class="sourceCode" id="cb16"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">pivottabler</span>)
<span class="no">pt</span> <span class="kw">&lt;-</span> <span class="no">PivotTable</span>$<span class="fu">new</span>()
<span class="no">pt</span>$<span class="fu">addData</span>(<span class="no">bhmtrains</span>)
<span class="no">cg1</span> <span class="kw">&lt;-</span> <span class="no">pt</span>$<span class="fu">addColumnGroup</span>(<span class="kw">variableName</span><span class="kw">=</span><span class="st">"TrainCategory"</span>, <span class="kw">values</span><span class="kw">=</span><span class="st">"Express Passenger"</span>,
                         <span class="kw">caption</span><span class="kw">=</span><span class="st">"Express Passenger (Count)"</span>)
<span class="no">cg2</span> <span class="kw">&lt;-</span> <span class="no">pt</span>$<span class="fu">addColumnGroup</span>(<span class="kw">variableName</span><span class="kw">=</span><span class="st">"PowerType"</span>, <span class="kw">values</span><span class="kw">=</span><span class="st">"DMU"</span>,
                         <span class="kw">caption</span><span class="kw">=</span><span class="st">"DMU (Maximum Speed)"</span>)
<span class="no">pt</span>$<span class="fu">addRowDataGroups</span>(<span class="st">"TOC"</span>)
<span class="no">pt</span>$<span class="fu">defineCalculation</span>(<span class="kw">calculationName</span><span class="kw">=</span><span class="st">"TotalTrains"</span>, <span class="kw">summariseExpression</span><span class="kw">=</span><span class="st">"n()"</span>)
<span class="no">pt</span>$<span class="fu">defineCalculation</span>(<span class="kw">calculationGroupName</span><span class="kw">=</span><span class="st">"calcGrp2"</span>, <span class="kw">calculationName</span><span class="kw">=</span><span class="st">"MaxSpeedMPH"</span>,
                     <span class="kw">summariseExpression</span><span class="kw">=</span><span class="st">"max(SchedSpeedMPH, na.rm=TRUE)"</span>)
<span class="no">cg1</span>$<span class="fu">addCalculationGroups</span>(<span class="st">"default"</span>)
<span class="no">cg2</span>$<span class="fu">addCalculationGroups</span>(<span class="st">"calcGrp2"</span>)
<span class="no">pt</span>$<span class="fu">renderPivot</span>()</pre></body></html></div>
<div id="htmlwidget-793745e8c7442483bea7" style="width:auto;height:auto;" class="pivottabler html-widget"></div>
<script type="application/json" data-for="htmlwidget-793745e8c7442483bea7">{"x":{"tableCss":".Table {display: table; border-collapse: collapse; }\r\n.ColumnHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px; text-align: center; }\r\n.RowHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px 8px 2px 2px; text-align: left; }\r\n.Cell {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n.OutlineColumnHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px; text-align: center; }\r\n.OutlineRowHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px 8px 2px 2px; text-align: left; }\r\n.OutlineCell {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; background-color: #F8F8F8; font-weight: bold; }\r\n.Total {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n","tableHtml":"<table class=\"Table\">\n  <tr>\n    <th class=\"RowHeader\">&nbsp;<\/th>\n    <th class=\"ColumnHeader\">Express Passenger (Count)<\/th>\n    <th class=\"ColumnHeader\">DMU (Maximum Speed)<\/th>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Arriva Trains Wales<\/th>\n    <td class=\"Cell\">3079<\/td>\n    <td class=\"Cell\">90<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">CrossCountry<\/th>\n    <td class=\"Cell\">22865<\/td>\n    <td class=\"Cell\">125<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">London Midland<\/th>\n    <td class=\"Cell\">14487<\/td>\n    <td class=\"Cell\">100<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Virgin Trains<\/th>\n    <td class=\"Cell\">8594<\/td>\n    <td class=\"Cell\">125<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Total<\/th>\n    <td class=\"Total\">49025<\/td>\n    <td class=\"Total\">125<\/td>\n  <\/tr>\n<\/table>","settings":[]},"evals":[],"jsHooks":[]}</script>
</div>
<div id="adding-purely-descriptive-data-groups" class="section level3">
<h3 class="hasAnchor">
<a href="#adding-purely-descriptive-data-groups" class="anchor"></a>Adding purely descriptive data groups</h3>
<p>The example below adds two data groups that display a caption only - purely for display purposes.</p>
<div class="sourceCode" id="cb17"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">pivottabler</span>)
<span class="no">pt</span> <span class="kw">&lt;-</span> <span class="no">PivotTable</span>$<span class="fu">new</span>()
<span class="no">pt</span>$<span class="fu">addData</span>(<span class="no">bhmtrains</span>)
<span class="no">cg1</span> <span class="kw">&lt;-</span> <span class="no">pt</span>$<span class="fu">addColumnGroup</span>(<span class="kw">variableName</span><span class="kw">=</span><span class="st">"TrainCategory"</span>, <span class="kw">values</span><span class="kw">=</span><span class="st">"Express Passenger"</span>)
<span class="no">cg2</span> <span class="kw">&lt;-</span> <span class="no">pt</span>$<span class="fu">addColumnGroup</span>(<span class="kw">variableName</span><span class="kw">=</span><span class="st">"PowerType"</span>, <span class="kw">values</span><span class="kw">=</span><span class="st">"DMU"</span>)
<span class="no">pt</span>$<span class="fu">addRowDataGroups</span>(<span class="st">"TOC"</span>)
<span class="no">pt</span>$<span class="fu">defineCalculation</span>(<span class="kw">calculationName</span><span class="kw">=</span><span class="st">"TotalTrains"</span>, <span class="kw">summariseExpression</span><span class="kw">=</span><span class="st">"n()"</span>)
<span class="no">pt</span>$<span class="fu">defineCalculation</span>(<span class="kw">calculationGroupName</span><span class="kw">=</span><span class="st">"calcGrp2"</span>, <span class="kw">calculationName</span><span class="kw">=</span><span class="st">"MaxSpeedMPH"</span>,
                     <span class="kw">summariseExpression</span><span class="kw">=</span><span class="st">"max(SchedSpeedMPH, na.rm=TRUE)"</span>)
<span class="no">cg3</span> <span class="kw">&lt;-</span> <span class="no">cg1</span>$<span class="fu">addChildGroup</span>(<span class="kw">caption</span><span class="kw">=</span><span class="st">"Count"</span>)
<span class="no">cg4</span> <span class="kw">&lt;-</span> <span class="no">cg2</span>$<span class="fu">addChildGroup</span>(<span class="kw">caption</span><span class="kw">=</span><span class="st">"Maximum Speed"</span>)
<span class="no">cg3</span>$<span class="fu">addCalculationGroups</span>(<span class="st">"default"</span>)
<span class="no">cg4</span>$<span class="fu">addCalculationGroups</span>(<span class="st">"calcGrp2"</span>)
<span class="no">pt</span>$<span class="fu">renderPivot</span>()</pre></body></html></div>
<div id="htmlwidget-7e0cb3dc2c6f1ac5e555" style="width:auto;height:auto;" class="pivottabler html-widget"></div>
<script type="application/json" data-for="htmlwidget-7e0cb3dc2c6f1ac5e555">{"x":{"tableCss":".Table {display: table; border-collapse: collapse; }\r\n.ColumnHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px; text-align: center; }\r\n.RowHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px 8px 2px 2px; text-align: left; }\r\n.Cell {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n.OutlineColumnHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px; text-align: center; }\r\n.OutlineRowHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px 8px 2px 2px; text-align: left; }\r\n.OutlineCell {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; background-color: #F8F8F8; font-weight: bold; }\r\n.Total {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n","tableHtml":"<table class=\"Table\">\n  <tr>\n    <th class=\"RowHeader\" rowspan=\"2\">&nbsp;<\/th>\n    <th class=\"ColumnHeader\">Express Passenger<\/th>\n    <th class=\"ColumnHeader\">DMU<\/th>\n  <\/tr>\n  <tr>\n    <th class=\"ColumnHeader\">Count<\/th>\n    <th class=\"ColumnHeader\">Maximum Speed<\/th>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Arriva Trains Wales<\/th>\n    <td class=\"Cell\">3079<\/td>\n    <td class=\"Cell\">90<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">CrossCountry<\/th>\n    <td class=\"Cell\">22865<\/td>\n    <td class=\"Cell\">125<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">London Midland<\/th>\n    <td class=\"Cell\">14487<\/td>\n    <td class=\"Cell\">100<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Virgin Trains<\/th>\n    <td class=\"Cell\">8594<\/td>\n    <td class=\"Cell\">125<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Total<\/th>\n    <td class=\"Total\">49025<\/td>\n    <td class=\"Total\">125<\/td>\n  <\/tr>\n<\/table>","settings":[]},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div id="combining-multiple-pivot-tables" class="section level2">
<h2 class="hasAnchor">
<a href="#combining-multiple-pivot-tables" class="anchor"></a>Combining Multiple Pivot Tables</h2>
<div id="example-1" class="section level3">
<h3 class="hasAnchor">
<a href="#example-1" class="anchor"></a>Example 1</h3>
<p>The example below combines two pivot tables in one, calling <code>pt$addRowDataGroups()</code> twice specifying <code>atLevel=1</code> both times:</p>
<div class="sourceCode" id="cb18"><html><body><pre class="r"><span class="co"># some sample school student grade data</span>
<span class="no">gender</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"F"</span>, <span class="st">"F"</span>, <span class="st">"F"</span>, <span class="st">"F"</span>, <span class="st">"F"</span>, <span class="st">"F"</span>, <span class="st">"F"</span>, <span class="st">"F"</span>, <span class="st">"F"</span>, <span class="st">"F"</span>, <span class="st">"F"</span>, <span class="st">"F"</span>, <span class="st">"F"</span>, <span class="st">"F"</span>,
            <span class="st">"F"</span>, <span class="st">"F"</span>, <span class="st">"F"</span>, <span class="st">"F"</span>, <span class="st">"F"</span>, <span class="st">"F"</span>, <span class="st">"M"</span>, <span class="st">"M"</span>, <span class="st">"M"</span>, <span class="st">"M"</span>, <span class="st">"M"</span>, <span class="st">"M"</span>, <span class="st">"M"</span>, <span class="st">"M"</span>,
            <span class="st">"M"</span>, <span class="st">"M"</span>, <span class="st">"M"</span>, <span class="st">"M"</span>, <span class="st">"M"</span>, <span class="st">"M"</span>, <span class="st">"M"</span>, <span class="st">"M"</span>, <span class="st">"M"</span>, <span class="st">"M"</span>, <span class="st">"M"</span>, <span class="st">"M"</span>)
<span class="no">age</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">19</span>, <span class="fl">19</span>, <span class="fl">19</span>, <span class="fl">19</span>, <span class="fl">19</span>, <span class="fl">20</span>, <span class="fl">20</span>, <span class="fl">20</span>, <span class="fl">20</span>, <span class="fl">20</span>, <span class="fl">21</span>, <span class="fl">21</span>, <span class="fl">21</span>, <span class="fl">21</span>, <span class="fl">21</span>, <span class="fl">22</span>, <span class="fl">22</span>, <span class="fl">22</span>,
         <span class="fl">22</span>, <span class="fl">22</span>, <span class="fl">19</span>, <span class="fl">19</span>, <span class="fl">19</span>, <span class="fl">19</span>, <span class="fl">19</span>, <span class="fl">20</span>, <span class="fl">20</span>, <span class="fl">20</span>, <span class="fl">20</span>, <span class="fl">20</span>, <span class="fl">21</span>, <span class="fl">21</span>, <span class="fl">21</span>, <span class="fl">21</span>, <span class="fl">21</span>, <span class="fl">22</span>,
         <span class="fl">22</span>, <span class="fl">22</span>, <span class="fl">22</span>, <span class="fl">22</span>)
<span class="no">grade</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>, <span class="st">"D"</span>, <span class="st">"E"</span>, <span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>, <span class="st">"D"</span>, <span class="st">"E"</span>, <span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>, <span class="st">"D"</span>,
           <span class="st">"E"</span>, <span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>, <span class="st">"D"</span>, <span class="st">"E"</span>, <span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>, <span class="st">"D"</span>, <span class="st">"E"</span>, <span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>,
           <span class="st">"D"</span>, <span class="st">"E"</span>, <span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>, <span class="st">"D"</span>, <span class="st">"E"</span>, <span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>, <span class="st">"D"</span>, <span class="st">"E"</span>)
<span class="no">counts</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">6</span>, <span class="fl">16</span>, <span class="fl">56</span>, <span class="fl">37</span>, <span class="fl">213</span>, <span class="fl">14</span>, <span class="fl">21</span>, <span class="fl">61</span>, <span class="fl">45</span>, <span class="fl">191</span>, <span class="fl">30</span>, <span class="fl">54</span>, <span class="fl">74</span>, <span class="fl">82</span>, <span class="fl">246</span>, <span class="fl">91</span>, <span class="fl">46</span>,
            <span class="fl">29</span>, <span class="fl">71</span>, <span class="fl">296</span>, <span class="fl">3</span>, <span class="fl">6</span>, <span class="fl">21</span>, <span class="fl">35</span>, <span class="fl">162</span>, <span class="fl">14</span>, <span class="fl">11</span>, <span class="fl">29</span>, <span class="fl">22</span>, <span class="fl">204</span>, <span class="fl">15</span>, <span class="fl">30</span>, <span class="fl">49</span>, <span class="fl">75</span>,
            <span class="fl">253</span>, <span class="fl">45</span>, <span class="fl">22</span>, <span class="fl">30</span>, <span class="fl">30</span>, <span class="fl">319</span>)
<span class="no">df</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="no">gender</span>, <span class="no">age</span>, <span class="no">grade</span>, <span class="no">counts</span>)

<span class="co"># two pivot tables in one</span>
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">pivottabler</span>)
<span class="no">pt</span> <span class="kw">&lt;-</span> <span class="no">PivotTable</span>$<span class="fu">new</span>()
<span class="no">pt</span>$<span class="fu">addData</span>(<span class="no">df</span>)
<span class="no">pt</span>$<span class="fu">addColumnDataGroups</span>(<span class="st">"grade"</span>)
<span class="no">pt</span>$<span class="fu">addRowGroup</span>(<span class="kw">caption</span><span class="kw">=</span><span class="st">"Age"</span>, <span class="kw">isEmpty</span><span class="kw">=</span><span class="fl">TRUE</span>, <span class="kw">styleDeclarations</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">color</span><span class="kw">=</span><span class="st">"blue"</span>))
<span class="no">pt</span>$<span class="fu">addRowDataGroups</span>(<span class="st">"age"</span>, <span class="kw">atLevel</span><span class="kw">=</span><span class="fl">1</span>)
<span class="no">pt</span>$<span class="fu">addRowGroup</span>(<span class="kw">caption</span><span class="kw">=</span><span class="st">"Gender"</span>, <span class="kw">isEmpty</span><span class="kw">=</span><span class="fl">TRUE</span>, <span class="kw">styleDeclarations</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">color</span><span class="kw">=</span><span class="st">"blue"</span>))
<span class="no">pt</span>$<span class="fu">addRowDataGroups</span>(<span class="st">"gender"</span>, <span class="kw">atLevel</span><span class="kw">=</span><span class="fl">1</span>)
<span class="no">pt</span>$<span class="fu">defineCalculation</span>(<span class="kw">calculationName</span><span class="kw">=</span><span class="st">"GradeCounts"</span>, <span class="kw">summariseExpression</span><span class="kw">=</span><span class="st">"sum(counts)"</span>)
<span class="no">pt</span>$<span class="fu">renderPivot</span>()</pre></body></html></div>
<div id="htmlwidget-86d0a30d7dee39120c3e" style="width:auto;height:auto;" class="pivottabler html-widget"></div>
<script type="application/json" data-for="htmlwidget-86d0a30d7dee39120c3e">{"x":{"tableCss":".Table {display: table; border-collapse: collapse; }\r\n.ColumnHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px; text-align: center; }\r\n.RowHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px 8px 2px 2px; text-align: left; }\r\n.Cell {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n.OutlineColumnHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px; text-align: center; }\r\n.OutlineRowHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px 8px 2px 2px; text-align: left; }\r\n.OutlineCell {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; background-color: #F8F8F8; font-weight: bold; }\r\n.Total {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n","tableHtml":"<table class=\"Table\">\n  <tr>\n    <th class=\"RowHeader\">&nbsp;<\/th>\n    <th class=\"ColumnHeader\">A<\/th>\n    <th class=\"ColumnHeader\">B<\/th>\n    <th class=\"ColumnHeader\">C<\/th>\n    <th class=\"ColumnHeader\">D<\/th>\n    <th class=\"ColumnHeader\">E<\/th>\n    <th class=\"ColumnHeader\">Total<\/th>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\" style=\"color: blue; \">Age<\/th>\n    <td class=\"Cell\" colspan=\"6\">&nbsp;<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">19<\/th>\n    <td class=\"Cell\">9<\/td>\n    <td class=\"Cell\">22<\/td>\n    <td class=\"Cell\">77<\/td>\n    <td class=\"Cell\">72<\/td>\n    <td class=\"Cell\">375<\/td>\n    <td class=\"Total\">555<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">20<\/th>\n    <td class=\"Cell\">28<\/td>\n    <td class=\"Cell\">32<\/td>\n    <td class=\"Cell\">90<\/td>\n    <td class=\"Cell\">67<\/td>\n    <td class=\"Cell\">395<\/td>\n    <td class=\"Total\">612<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">21<\/th>\n    <td class=\"Cell\">45<\/td>\n    <td class=\"Cell\">84<\/td>\n    <td class=\"Cell\">123<\/td>\n    <td class=\"Cell\">157<\/td>\n    <td class=\"Cell\">499<\/td>\n    <td class=\"Total\">908<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">22<\/th>\n    <td class=\"Cell\">136<\/td>\n    <td class=\"Cell\">68<\/td>\n    <td class=\"Cell\">59<\/td>\n    <td class=\"Cell\">101<\/td>\n    <td class=\"Cell\">615<\/td>\n    <td class=\"Total\">979<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Total<\/th>\n    <td class=\"Total\">218<\/td>\n    <td class=\"Total\">206<\/td>\n    <td class=\"Total\">349<\/td>\n    <td class=\"Total\">397<\/td>\n    <td class=\"Total\">1884<\/td>\n    <td class=\"Total\">3054<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\" style=\"color: blue; \">Gender<\/th>\n    <td class=\"Cell\" colspan=\"6\">&nbsp;<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">F<\/th>\n    <td class=\"Cell\">141<\/td>\n    <td class=\"Cell\">137<\/td>\n    <td class=\"Cell\">220<\/td>\n    <td class=\"Cell\">235<\/td>\n    <td class=\"Cell\">946<\/td>\n    <td class=\"Total\">1679<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">M<\/th>\n    <td class=\"Cell\">77<\/td>\n    <td class=\"Cell\">69<\/td>\n    <td class=\"Cell\">129<\/td>\n    <td class=\"Cell\">162<\/td>\n    <td class=\"Cell\">938<\/td>\n    <td class=\"Total\">1375<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Total<\/th>\n    <td class=\"Total\">218<\/td>\n    <td class=\"Total\">206<\/td>\n    <td class=\"Total\">349<\/td>\n    <td class=\"Total\">397<\/td>\n    <td class=\"Total\">1884<\/td>\n    <td class=\"Total\">3054<\/td>\n  <\/tr>\n<\/table>","settings":[]},"evals":[],"jsHooks":[]}</script><p>The example above allows each set of row groups to render a total row. To prevent this and instead render a single total row at the bottom of the pivot table, specify <code>addTotal=FALSE</code> when calling <code>pt$addRowDataGroups()</code>, then call <code>pt$addRowGroup()</code> a third time to add the total row at the bottom:</p>
<div class="sourceCode" id="cb19"><html><body><pre class="r"><span class="co"># some sample school student grade data</span>
<span class="no">gender</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"F"</span>, <span class="st">"F"</span>, <span class="st">"F"</span>, <span class="st">"F"</span>, <span class="st">"F"</span>, <span class="st">"F"</span>, <span class="st">"F"</span>, <span class="st">"F"</span>, <span class="st">"F"</span>, <span class="st">"F"</span>, <span class="st">"F"</span>, <span class="st">"F"</span>, <span class="st">"F"</span>, <span class="st">"F"</span>,
            <span class="st">"F"</span>, <span class="st">"F"</span>, <span class="st">"F"</span>, <span class="st">"F"</span>, <span class="st">"F"</span>, <span class="st">"F"</span>, <span class="st">"M"</span>, <span class="st">"M"</span>, <span class="st">"M"</span>, <span class="st">"M"</span>, <span class="st">"M"</span>, <span class="st">"M"</span>, <span class="st">"M"</span>, <span class="st">"M"</span>,
            <span class="st">"M"</span>, <span class="st">"M"</span>, <span class="st">"M"</span>, <span class="st">"M"</span>, <span class="st">"M"</span>, <span class="st">"M"</span>, <span class="st">"M"</span>, <span class="st">"M"</span>, <span class="st">"M"</span>, <span class="st">"M"</span>, <span class="st">"M"</span>, <span class="st">"M"</span>)
<span class="no">age</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">19</span>, <span class="fl">19</span>, <span class="fl">19</span>, <span class="fl">19</span>, <span class="fl">19</span>, <span class="fl">20</span>, <span class="fl">20</span>, <span class="fl">20</span>, <span class="fl">20</span>, <span class="fl">20</span>, <span class="fl">21</span>, <span class="fl">21</span>, <span class="fl">21</span>, <span class="fl">21</span>, <span class="fl">21</span>, <span class="fl">22</span>, <span class="fl">22</span>, <span class="fl">22</span>,
         <span class="fl">22</span>, <span class="fl">22</span>, <span class="fl">19</span>, <span class="fl">19</span>, <span class="fl">19</span>, <span class="fl">19</span>, <span class="fl">19</span>, <span class="fl">20</span>, <span class="fl">20</span>, <span class="fl">20</span>, <span class="fl">20</span>, <span class="fl">20</span>, <span class="fl">21</span>, <span class="fl">21</span>, <span class="fl">21</span>, <span class="fl">21</span>, <span class="fl">21</span>, <span class="fl">22</span>,
         <span class="fl">22</span>, <span class="fl">22</span>, <span class="fl">22</span>, <span class="fl">22</span>)
<span class="no">grade</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>, <span class="st">"D"</span>, <span class="st">"E"</span>, <span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>, <span class="st">"D"</span>, <span class="st">"E"</span>, <span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>, <span class="st">"D"</span>,
           <span class="st">"E"</span>, <span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>, <span class="st">"D"</span>, <span class="st">"E"</span>, <span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>, <span class="st">"D"</span>, <span class="st">"E"</span>, <span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>,
           <span class="st">"D"</span>, <span class="st">"E"</span>, <span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>, <span class="st">"D"</span>, <span class="st">"E"</span>, <span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>, <span class="st">"D"</span>, <span class="st">"E"</span>)
<span class="no">counts</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">6</span>, <span class="fl">16</span>, <span class="fl">56</span>, <span class="fl">37</span>, <span class="fl">213</span>, <span class="fl">14</span>, <span class="fl">21</span>, <span class="fl">61</span>, <span class="fl">45</span>, <span class="fl">191</span>, <span class="fl">30</span>, <span class="fl">54</span>, <span class="fl">74</span>, <span class="fl">82</span>, <span class="fl">246</span>, <span class="fl">91</span>, <span class="fl">46</span>,
            <span class="fl">29</span>, <span class="fl">71</span>, <span class="fl">296</span>, <span class="fl">3</span>, <span class="fl">6</span>, <span class="fl">21</span>, <span class="fl">35</span>, <span class="fl">162</span>, <span class="fl">14</span>, <span class="fl">11</span>, <span class="fl">29</span>, <span class="fl">22</span>, <span class="fl">204</span>, <span class="fl">15</span>, <span class="fl">30</span>, <span class="fl">49</span>, <span class="fl">75</span>,
            <span class="fl">253</span>, <span class="fl">45</span>, <span class="fl">22</span>, <span class="fl">30</span>, <span class="fl">30</span>, <span class="fl">319</span>)
<span class="no">df</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="no">gender</span>, <span class="no">age</span>, <span class="no">grade</span>, <span class="no">counts</span>)

<span class="co"># two pivot tables in one</span>
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">pivottabler</span>)
<span class="no">pt</span> <span class="kw">&lt;-</span> <span class="no">PivotTable</span>$<span class="fu">new</span>()
<span class="no">pt</span>$<span class="fu">addData</span>(<span class="no">df</span>)
<span class="no">pt</span>$<span class="fu">addColumnDataGroups</span>(<span class="st">"grade"</span>)
<span class="no">pt</span>$<span class="fu">addRowGroup</span>(<span class="kw">caption</span><span class="kw">=</span><span class="st">"Age"</span>, <span class="kw">isEmpty</span><span class="kw">=</span><span class="fl">TRUE</span>, <span class="kw">isOutline</span><span class="kw">=</span><span class="fl">TRUE</span>,
               <span class="kw">styleDeclarations</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">color</span><span class="kw">=</span><span class="st">"blue"</span>))
<span class="no">pt</span>$<span class="fu">addRowDataGroups</span>(<span class="st">"age"</span>, <span class="kw">atLevel</span><span class="kw">=</span><span class="fl">1</span>, <span class="kw">addTotal</span><span class="kw">=</span><span class="fl">FALSE</span>)
<span class="no">pt</span>$<span class="fu">addRowGroup</span>(<span class="kw">caption</span><span class="kw">=</span><span class="st">"Gender"</span>, <span class="kw">isEmpty</span><span class="kw">=</span><span class="fl">TRUE</span>, <span class="kw">isOutline</span><span class="kw">=</span><span class="fl">TRUE</span>,
               <span class="kw">styleDeclarations</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">color</span><span class="kw">=</span><span class="st">"blue"</span>))
<span class="no">pt</span>$<span class="fu">addRowDataGroups</span>(<span class="st">"gender"</span>, <span class="kw">atLevel</span><span class="kw">=</span><span class="fl">1</span>, <span class="kw">addTotal</span><span class="kw">=</span><span class="fl">FALSE</span>)
<span class="no">pt</span>$<span class="fu">defineCalculation</span>(<span class="kw">calculationName</span><span class="kw">=</span><span class="st">"GradeCounts"</span>, <span class="kw">summariseExpression</span><span class="kw">=</span><span class="st">"sum(counts)"</span>)
<span class="no">pt</span>$<span class="fu">addRowGroup</span>(<span class="kw">caption</span><span class="kw">=</span><span class="st">"Total"</span>, <span class="kw">isOutline</span><span class="kw">=</span><span class="fl">TRUE</span>, <span class="kw">isTotal</span><span class="kw">=</span><span class="fl">TRUE</span>, <span class="kw">isLevelTotal</span><span class="kw">=</span><span class="fl">TRUE</span>,
               <span class="kw">styleDeclarations</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">color</span><span class="kw">=</span><span class="st">"blue"</span>), <span class="kw">cellStyleDeclarations</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">color</span><span class="kw">=</span><span class="st">"blue"</span>))
<span class="no">pt</span>$<span class="fu">renderPivot</span>()</pre></body></html></div>
<div id="htmlwidget-93e95db68c3b4441bead" style="width:auto;height:auto;" class="pivottabler html-widget"></div>
<script type="application/json" data-for="htmlwidget-93e95db68c3b4441bead">{"x":{"tableCss":".Table {display: table; border-collapse: collapse; }\r\n.ColumnHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px; text-align: center; }\r\n.RowHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px 8px 2px 2px; text-align: left; }\r\n.Cell {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n.OutlineColumnHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px; text-align: center; }\r\n.OutlineRowHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px 8px 2px 2px; text-align: left; }\r\n.OutlineCell {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; background-color: #F8F8F8; font-weight: bold; }\r\n.Total {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n","tableHtml":"<table class=\"Table\">\n  <tr>\n    <th class=\"RowHeader\">&nbsp;<\/th>\n    <th class=\"ColumnHeader\">A<\/th>\n    <th class=\"ColumnHeader\">B<\/th>\n    <th class=\"ColumnHeader\">C<\/th>\n    <th class=\"ColumnHeader\">D<\/th>\n    <th class=\"ColumnHeader\">E<\/th>\n    <th class=\"ColumnHeader\">Total<\/th>\n  <\/tr>\n  <tr>\n    <th class=\"OutlineRowHeader\" style=\"color: blue; \">Age<\/th>\n    <td class=\"OutlineCell\" colspan=\"6\">&nbsp;<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">19<\/th>\n    <td class=\"Cell\">9<\/td>\n    <td class=\"Cell\">22<\/td>\n    <td class=\"Cell\">77<\/td>\n    <td class=\"Cell\">72<\/td>\n    <td class=\"Cell\">375<\/td>\n    <td class=\"Total\">555<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">20<\/th>\n    <td class=\"Cell\">28<\/td>\n    <td class=\"Cell\">32<\/td>\n    <td class=\"Cell\">90<\/td>\n    <td class=\"Cell\">67<\/td>\n    <td class=\"Cell\">395<\/td>\n    <td class=\"Total\">612<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">21<\/th>\n    <td class=\"Cell\">45<\/td>\n    <td class=\"Cell\">84<\/td>\n    <td class=\"Cell\">123<\/td>\n    <td class=\"Cell\">157<\/td>\n    <td class=\"Cell\">499<\/td>\n    <td class=\"Total\">908<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">22<\/th>\n    <td class=\"Cell\">136<\/td>\n    <td class=\"Cell\">68<\/td>\n    <td class=\"Cell\">59<\/td>\n    <td class=\"Cell\">101<\/td>\n    <td class=\"Cell\">615<\/td>\n    <td class=\"Total\">979<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"OutlineRowHeader\" style=\"color: blue; \">Gender<\/th>\n    <td class=\"OutlineCell\" colspan=\"6\">&nbsp;<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">F<\/th>\n    <td class=\"Cell\">141<\/td>\n    <td class=\"Cell\">137<\/td>\n    <td class=\"Cell\">220<\/td>\n    <td class=\"Cell\">235<\/td>\n    <td class=\"Cell\">946<\/td>\n    <td class=\"Total\">1679<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">M<\/th>\n    <td class=\"Cell\">77<\/td>\n    <td class=\"Cell\">69<\/td>\n    <td class=\"Cell\">129<\/td>\n    <td class=\"Cell\">162<\/td>\n    <td class=\"Cell\">938<\/td>\n    <td class=\"Total\">1375<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"OutlineRowHeader\" style=\"color: blue; \">Total<\/th>\n    <td class=\"OutlineCell\" style=\"color: blue; \">218<\/td>\n    <td class=\"OutlineCell\" style=\"color: blue; \">206<\/td>\n    <td class=\"OutlineCell\" style=\"color: blue; \">349<\/td>\n    <td class=\"OutlineCell\" style=\"color: blue; \">397<\/td>\n    <td class=\"OutlineCell\" style=\"color: blue; \">1884<\/td>\n    <td class=\"OutlineCell\" style=\"color: blue; \">3054<\/td>\n  <\/tr>\n<\/table>","settings":[]},"evals":[],"jsHooks":[]}</script>
</div>
<div id="example-2" class="section level3">
<h3 class="hasAnchor">
<a href="#example-2" class="anchor"></a>Example 2</h3>
<p>Another example of a pivot table that effectively contains two pivot tables:</p>
<div class="sourceCode" id="cb20"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">pivottabler</span>)
<span class="no">pt</span> <span class="kw">&lt;-</span> <span class="no">PivotTable</span>$<span class="fu">new</span>()
<span class="no">pt</span>$<span class="fu">addData</span>(<span class="no">bhmtrains</span>)
<span class="no">pt</span>$<span class="fu">addColumnDataGroups</span>(<span class="st">"TrainCategory"</span>)
<span class="co"># Rows: TOC breakdown</span>
<span class="no">grp1</span> <span class="kw">&lt;-</span> <span class="no">pt</span>$<span class="fu">addRowGroup</span>(<span class="kw">caption</span><span class="kw">=</span><span class="st">"By TOC"</span>)
<span class="no">grp1</span>$<span class="fu">addDataGroups</span>(<span class="st">"TOC"</span>, <span class="kw">addTotal</span><span class="kw">=</span><span class="fl">FALSE</span>)
<span class="co"># Rows: Power Type breakdown</span>
<span class="no">grp2</span> <span class="kw">&lt;-</span> <span class="no">pt</span>$<span class="fu">addRowGroup</span>(<span class="kw">caption</span><span class="kw">=</span><span class="st">"By Power Type"</span>)
<span class="no">grp2</span>$<span class="fu">addDataGroups</span>(<span class="st">"PowerType"</span>, <span class="kw">addTotal</span><span class="kw">=</span><span class="fl">FALSE</span>)
<span class="co"># Rows: Total</span>
<span class="no">grp3</span> <span class="kw">&lt;-</span> <span class="no">pt</span>$<span class="fu">addRowGroup</span>(<span class="kw">caption</span><span class="kw">=</span><span class="st">"Total"</span>)
<span class="co"># Row Group Headings</span>
<span class="no">pt</span>$<span class="fu">setRowDataGroupHeader</span>(<span class="kw">levelNumber</span><span class="kw">=</span><span class="fl">1</span>, <span class="kw">header</span><span class="kw">=</span><span class="st">"Breakdown"</span>)
<span class="no">pt</span>$<span class="fu">setRowDataGroupHeader</span>(<span class="kw">levelNumber</span><span class="kw">=</span><span class="fl">2</span>, <span class="kw">header</span><span class="kw">=</span><span class="st">"Subset"</span>)
<span class="co"># Finish...</span>
<span class="no">pt</span>$<span class="fu">defineCalculation</span>(<span class="kw">calculationName</span><span class="kw">=</span><span class="st">"TotalTrains"</span>, <span class="kw">summariseExpression</span><span class="kw">=</span><span class="st">"n()"</span>)
<span class="no">pt</span>$<span class="no">theme</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/getStandardTableTheme.html">getStandardTableTheme</a></span>(<span class="no">pt</span>)
<span class="no">pt</span>$<span class="fu">renderPivot</span>(<span class="kw">showRowGroupHeaders</span><span class="kw">=</span><span class="fl">TRUE</span>)</pre></body></html></div>
<div id="htmlwidget-9f936eb732cb1b9d0d31" style="width:auto;height:auto;" class="pivottabler html-widget"></div>
<script type="application/json" data-for="htmlwidget-9f936eb732cb1b9d0d31">{"x":{"tableCss":".Table {display: table; border-collapse: collapse; }\r\n.LeftColumnHeader {font-family: Arial; font-size: 0.75em; padding: 2px; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; text-align: left; }\r\n.CentreColumnHeader {font-family: Arial; font-size: 0.75em; padding: 2px; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; text-align: center; }\r\n.LeftCell {font-family: Arial; font-size: 0.75em; padding: 2px 8px 2px 2px; border: 1px solid lightgray; vertical-align: middle; font-weight: normal; text-align: left; }\r\n.RightCell {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; font-weight: normal; text-align: right; }\r\n.OutlineCentreColumnHeader {font-family: Arial; font-size: 0.75em; padding: 2px; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; text-align: center; }\r\n.OutlineLeftCell {font-family: Arial; font-size: 0.75em; padding: 2px 8px 2px 2px; border: 1px solid lightgray; vertical-align: middle; font-weight: normal; text-align: left; }\r\n.OutlineRightCell {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; font-weight: normal; text-align: right; }\r\n.Total {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; font-weight: normal; text-align: right; }\r\n","tableHtml":"<table class=\"Table\">\n  <tr>\n    <th class=\"LeftColumnHeader\">Breakdown<\/th>\n    <th class=\"LeftColumnHeader\">Subset<\/th>\n    <th class=\"CentreColumnHeader\">Express Passenger<\/th>\n    <th class=\"CentreColumnHeader\">Ordinary Passenger<\/th>\n    <th class=\"CentreColumnHeader\">Total<\/th>\n  <\/tr>\n  <tr>\n    <th class=\"LeftCell\" rowspan=\"4\">By TOC<\/th>\n    <th class=\"LeftCell\">Arriva Trains Wales<\/th>\n    <td class=\"RightCell\">3079<\/td>\n    <td class=\"RightCell\">830<\/td>\n    <td class=\"Total\">3909<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"LeftCell\">CrossCountry<\/th>\n    <td class=\"RightCell\">22865<\/td>\n    <td class=\"RightCell\">63<\/td>\n    <td class=\"Total\">22928<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"LeftCell\">London Midland<\/th>\n    <td class=\"RightCell\">14487<\/td>\n    <td class=\"RightCell\">33792<\/td>\n    <td class=\"Total\">48279<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"LeftCell\">Virgin Trains<\/th>\n    <td class=\"RightCell\">8594<\/td>\n    <td class=\"RightCell\"><\/td>\n    <td class=\"Total\">8594<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"LeftCell\" rowspan=\"3\">By Power Type<\/th>\n    <th class=\"LeftCell\">DMU<\/th>\n    <td class=\"RightCell\">32987<\/td>\n    <td class=\"RightCell\">6484<\/td>\n    <td class=\"Total\">39471<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"LeftCell\">EMU<\/th>\n    <td class=\"RightCell\">15306<\/td>\n    <td class=\"RightCell\">28201<\/td>\n    <td class=\"Total\">43507<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"LeftCell\">HST<\/th>\n    <td class=\"RightCell\">732<\/td>\n    <td class=\"RightCell\"><\/td>\n    <td class=\"Total\">732<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"LeftCell\">Total<\/th>\n    <th class=\"LeftCell\">&nbsp;<\/th>\n    <td class=\"RightCell\">49025<\/td>\n    <td class=\"RightCell\">34685<\/td>\n    <td class=\"Total\">83710<\/td>\n  <\/tr>\n<\/table>","settings":[]},"evals":[],"jsHooks":[]}</script><p>Rendering the same table as in outline layout:</p>
<div class="sourceCode" id="cb21"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">pivottabler</span>)
<span class="no">pt</span> <span class="kw">&lt;-</span> <span class="no">PivotTable</span>$<span class="fu">new</span>()
<span class="no">pt</span>$<span class="fu">addData</span>(<span class="no">bhmtrains</span>)
<span class="no">pt</span>$<span class="fu">addColumnDataGroups</span>(<span class="st">"TrainCategory"</span>)
<span class="co"># Rows: TOC breakdown</span>
<span class="no">grp1a</span> <span class="kw">&lt;-</span> <span class="no">pt</span>$<span class="fu">addRowGroup</span>(<span class="kw">caption</span><span class="kw">=</span><span class="st">"By TOC"</span>, <span class="kw">isOutline</span><span class="kw">=</span><span class="fl">TRUE</span>, <span class="kw">isEmpty</span><span class="kw">=</span><span class="fl">TRUE</span>,
                        <span class="kw">sortAnchor</span><span class="kw">=</span><span class="st">"next"</span>, <span class="kw">styleDeclarations</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">color</span><span class="kw">=</span><span class="st">"blue"</span>))
<span class="no">grp1b</span> <span class="kw">&lt;-</span> <span class="no">pt</span>$<span class="fu">addRowGroup</span>()
<span class="no">grp1a</span>$<span class="no">outlineLinkedGroupId</span> <span class="kw">&lt;-</span> <span class="no">grp1b</span>$<span class="no">instanceId</span>
<span class="no">grp1b</span>$<span class="fu">addDataGroups</span>(<span class="st">"TOC"</span>, <span class="kw">addTotal</span><span class="kw">=</span><span class="fl">FALSE</span>)
<span class="co"># Rows: Power Type breakdown</span>
<span class="no">grp2a</span> <span class="kw">&lt;-</span> <span class="no">pt</span>$<span class="fu">addRowGroup</span>(<span class="kw">caption</span><span class="kw">=</span><span class="st">"By Power Type"</span>, <span class="kw">isOutline</span><span class="kw">=</span><span class="fl">TRUE</span>, <span class="kw">isEmpty</span><span class="kw">=</span><span class="fl">TRUE</span>,
                        <span class="kw">sortAnchor</span><span class="kw">=</span><span class="st">"next"</span>, <span class="kw">styleDeclarations</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">color</span><span class="kw">=</span><span class="st">"blue"</span>))
<span class="no">grp2b</span> <span class="kw">&lt;-</span> <span class="no">pt</span>$<span class="fu">addRowGroup</span>()
<span class="no">grp2a</span>$<span class="no">outlineLinkedGroupId</span> <span class="kw">&lt;-</span> <span class="no">grp2b</span>$<span class="no">instanceId</span>
<span class="no">grp2b</span>$<span class="fu">addDataGroups</span>(<span class="st">"PowerType"</span>, <span class="kw">addTotal</span><span class="kw">=</span><span class="fl">FALSE</span>)
<span class="co"># Rows: Total</span>
<span class="no">grp3</span> <span class="kw">&lt;-</span> <span class="no">pt</span>$<span class="fu">addRowGroup</span>(<span class="kw">caption</span><span class="kw">=</span><span class="st">"Total"</span>, <span class="kw">isOutline</span><span class="kw">=</span><span class="fl">TRUE</span>, <span class="kw">sortAnchor</span><span class="kw">=</span><span class="st">"fixed"</span>,
                       <span class="kw">styleDeclarations</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">color</span><span class="kw">=</span><span class="st">"blue"</span>))
<span class="co"># Finish...</span>
<span class="no">pt</span>$<span class="fu">defineCalculation</span>(<span class="kw">calculationName</span><span class="kw">=</span><span class="st">"TotalTrains"</span>, <span class="kw">summariseExpression</span><span class="kw">=</span><span class="st">"n()"</span>)
<span class="no">pt</span>$<span class="fu">renderPivot</span>()</pre></body></html></div>
<div id="htmlwidget-3179679be56a4e90fb28" style="width:auto;height:auto;" class="pivottabler html-widget"></div>
<script type="application/json" data-for="htmlwidget-3179679be56a4e90fb28">{"x":{"tableCss":".Table {display: table; border-collapse: collapse; }\r\n.ColumnHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px; text-align: center; }\r\n.RowHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px 8px 2px 2px; text-align: left; }\r\n.Cell {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n.OutlineColumnHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px; text-align: center; }\r\n.OutlineRowHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px 8px 2px 2px; text-align: left; }\r\n.OutlineCell {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; background-color: #F8F8F8; font-weight: bold; }\r\n.Total {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n","tableHtml":"<table class=\"Table\">\n  <tr>\n    <th class=\"RowHeader\" colspan=\"2\">&nbsp;<\/th>\n    <th class=\"ColumnHeader\">Express Passenger<\/th>\n    <th class=\"ColumnHeader\">Ordinary Passenger<\/th>\n    <th class=\"ColumnHeader\">Total<\/th>\n  <\/tr>\n  <tr>\n    <th class=\"OutlineRowHeader\" style=\"color: blue; \" colspan=\"2\">By TOC<\/th>\n    <td class=\"OutlineCell\" colspan=\"3\">&nbsp;<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\" rowspan=\"4\">&nbsp;<\/th>\n    <th class=\"RowHeader\">Arriva Trains Wales<\/th>\n    <td class=\"Cell\">3079<\/td>\n    <td class=\"Cell\">830<\/td>\n    <td class=\"Total\">3909<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">CrossCountry<\/th>\n    <td class=\"Cell\">22865<\/td>\n    <td class=\"Cell\">63<\/td>\n    <td class=\"Total\">22928<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">London Midland<\/th>\n    <td class=\"Cell\">14487<\/td>\n    <td class=\"Cell\">33792<\/td>\n    <td class=\"Total\">48279<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Virgin Trains<\/th>\n    <td class=\"Cell\">8594<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">8594<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"OutlineRowHeader\" style=\"color: blue; \" colspan=\"2\">By Power Type<\/th>\n    <td class=\"OutlineCell\" colspan=\"3\">&nbsp;<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\" rowspan=\"3\">&nbsp;<\/th>\n    <th class=\"RowHeader\">DMU<\/th>\n    <td class=\"Cell\">32987<\/td>\n    <td class=\"Cell\">6484<\/td>\n    <td class=\"Total\">39471<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">EMU<\/th>\n    <td class=\"Cell\">15306<\/td>\n    <td class=\"Cell\">28201<\/td>\n    <td class=\"Total\">43507<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">HST<\/th>\n    <td class=\"Cell\">732<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">732<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"OutlineRowHeader\" style=\"color: blue; \" colspan=\"2\">Total<\/th>\n    <td class=\"OutlineCell\">49025<\/td>\n    <td class=\"OutlineCell\">34685<\/td>\n    <td class=\"OutlineCell\">83710<\/td>\n  <\/tr>\n<\/table>","settings":[]},"evals":[],"jsHooks":[]}</script><p>In the example above, <code>sortAnchor</code> links that data group to the next/previous group which is also linked via <code>outlineLinkedGroupId</code>. These are set so that the outline group and those groups beneath it stay together when the data groups in the pivot table are sorted. If there is no intention to sort the pivot table using <code>pt$sortRowDataGroups()</code> then these arguments/lines are not needed.</p>
</div>
</div>
<div id="custom-layout-changes" class="section level2">
<h2 class="hasAnchor">
<a href="#custom-layout-changes" class="anchor"></a>Custom Layout Changes</h2>
<div id="working-with-empty-rows-andor-columns" class="section level3">
<h3 class="hasAnchor">
<a href="#working-with-empty-rows-andor-columns" class="anchor"></a>Working with empty rows and/or columns</h3>
<p>Sometimes, after a pivot table is evaluated, some rows and/or columns will contain no calculation results (i.e. NULL values). For example:</p>
<div class="sourceCode" id="cb22"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">pivottabler</span>)
<span class="no">pt</span> <span class="kw">&lt;-</span> <span class="no">PivotTable</span>$<span class="fu">new</span>()
<span class="no">pt</span>$<span class="fu">addData</span>(<span class="no">bhmtrains</span>)
<span class="no">pt</span>$<span class="fu">addColumnDataGroups</span>(<span class="st">"TrainCategory"</span>)
<span class="no">pt</span>$<span class="fu">addRowDataGroups</span>(<span class="st">"TOC"</span>)
<span class="no">pt</span>$<span class="fu">addRowDataGroups</span>(<span class="st">"PowerType"</span>, <span class="kw">onlyCombinationsThatExist</span><span class="kw">=</span><span class="fl">FALSE</span>)
<span class="no">pt</span>$<span class="fu">defineCalculation</span>(<span class="kw">calculationName</span><span class="kw">=</span><span class="st">"TotalTrains"</span>, <span class="kw">summariseExpression</span><span class="kw">=</span><span class="st">"n()"</span>)
<span class="no">pt</span>$<span class="fu">evaluatePivot</span>()
<span class="no">pt</span>$<span class="fu">renderPivot</span>()</pre></body></html></div>
<div id="htmlwidget-f1c3e43957cfbee7a850" style="width:auto;height:auto;" class="pivottabler html-widget"></div>
<script type="application/json" data-for="htmlwidget-f1c3e43957cfbee7a850">{"x":{"tableCss":".Table {display: table; border-collapse: collapse; }\r\n.ColumnHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px; text-align: center; }\r\n.RowHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px 8px 2px 2px; text-align: left; }\r\n.Cell {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n.OutlineColumnHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px; text-align: center; }\r\n.OutlineRowHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px 8px 2px 2px; text-align: left; }\r\n.OutlineCell {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; background-color: #F8F8F8; font-weight: bold; }\r\n.Total {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n","tableHtml":"<table class=\"Table\">\n  <tr>\n    <th class=\"RowHeader\" colspan=\"2\">&nbsp;<\/th>\n    <th class=\"ColumnHeader\">Express Passenger<\/th>\n    <th class=\"ColumnHeader\">Ordinary Passenger<\/th>\n    <th class=\"ColumnHeader\">Total<\/th>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\" rowspan=\"4\">Arriva Trains Wales<\/th>\n    <th class=\"RowHeader\">DMU<\/th>\n    <td class=\"Cell\">3079<\/td>\n    <td class=\"Cell\">830<\/td>\n    <td class=\"Total\">3909<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">EMU<\/th>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\"><\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">HST<\/th>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\"><\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Total<\/th>\n    <td class=\"Total\">3079<\/td>\n    <td class=\"Total\">830<\/td>\n    <td class=\"Total\">3909<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\" rowspan=\"4\">CrossCountry<\/th>\n    <th class=\"RowHeader\">DMU<\/th>\n    <td class=\"Cell\">22133<\/td>\n    <td class=\"Cell\">63<\/td>\n    <td class=\"Total\">22196<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">EMU<\/th>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\"><\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">HST<\/th>\n    <td class=\"Cell\">732<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">732<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Total<\/th>\n    <td class=\"Total\">22865<\/td>\n    <td class=\"Total\">63<\/td>\n    <td class=\"Total\">22928<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\" rowspan=\"4\">London Midland<\/th>\n    <th class=\"RowHeader\">DMU<\/th>\n    <td class=\"Cell\">5638<\/td>\n    <td class=\"Cell\">5591<\/td>\n    <td class=\"Total\">11229<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">EMU<\/th>\n    <td class=\"Cell\">8849<\/td>\n    <td class=\"Cell\">28201<\/td>\n    <td class=\"Total\">37050<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">HST<\/th>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\"><\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Total<\/th>\n    <td class=\"Total\">14487<\/td>\n    <td class=\"Total\">33792<\/td>\n    <td class=\"Total\">48279<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\" rowspan=\"4\">Virgin Trains<\/th>\n    <th class=\"RowHeader\">DMU<\/th>\n    <td class=\"Cell\">2137<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">2137<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">EMU<\/th>\n    <td class=\"Cell\">6457<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">6457<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">HST<\/th>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\"><\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Total<\/th>\n    <td class=\"Total\">8594<\/td>\n    <td class=\"Total\"><\/td>\n    <td class=\"Total\">8594<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Total<\/th>\n    <th class=\"RowHeader\">&nbsp;<\/th>\n    <td class=\"Total\">49025<\/td>\n    <td class=\"Total\">34685<\/td>\n    <td class=\"Total\">83710<\/td>\n  <\/tr>\n<\/table>","settings":[]},"evals":[],"jsHooks":[]}</script><p>The rows/columns containing no calculation values can be found using the <code>pt$getEmptyRows()</code> or <code>pt$getEmptyColumns()</code> functions:</p>
<div class="sourceCode" id="cb23"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span>(<span class="st">"Empty rows: "</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="no">pt</span>$<span class="fu">getEmptyRows</span>(), <span class="kw">collapse</span><span class="kw">=</span><span class="st">", "</span>))</pre></body></html></div>
<pre><code>## Empty rows:  2, 3, 6, 11, 15</code></pre>
<p>“Empty” is defined as the following cell values:</p>
<ul>
<li>NULL is always interpreted as empty.</li>
<li>NA is interpreted as empty by default, though this can be overridden using the argument <code>NAasEmpty=FALSE</code>.</li>
<li>0 is NOT interpreted as empty by default, though this can be overridden using the argument <code>zeroAsEmpty=TRUE</code>.</li>
</ul>
<p>The empty rows/columns can also be easily removed as described in the next section.</p>
</div>
<div id="removing-rows-andor-columns" class="section level3">
<h3 class="hasAnchor">
<a href="#removing-rows-andor-columns" class="anchor"></a>Removing rows and/or columns</h3>
<p>It is possible to remove specific rows and/or columns from a pivot table using any one of the following:</p>
<ul>
<li>
<code>pt$removeRow(2)</code> removes the second row from the pivot table.</li>
<li>
<code>pt$removeRows(c(2, 4))</code> removes the second and fourth rows from the pivot table.</li>
<li>
<code>pt$removeEmptyRows()</code> removes all rows from the pivot table where all cells (i.e. calculation values) have no value (i.e. are NULL).</li>
<li>
<code>pt$removeColumn(2)</code> removes the second column from the pivot table.</li>
<li>
<code>pt$removeColumns(c(2, 4))</code> removes the second and fourth columns from the pivot table.</li>
<li>
<code>pt$removeEmptyColumns()</code> removes all columns from the pivot table where all cells (i.e. calculation values) have no value (i.e. are NULL).</li>
</ul>
<p>Note the row/column numbers above do not include the headings.</p>
<p><code>pt$removeEmptyRows()</code> and <code>pt$removeEmptyColumns()</code> also support the <code>NAasEmpty</code> and <code>zeroAsEmpty</code> arguments as described in the previous section.</p>
<p>As an example of removing rows, consider the second and fourth rows highlighted in the pivot table below:</p>
<div class="sourceCode" id="cb25"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">pivottabler</span>)
<span class="no">pt</span> <span class="kw">&lt;-</span> <span class="no">PivotTable</span>$<span class="fu">new</span>()
<span class="no">pt</span>$<span class="fu">addData</span>(<span class="no">bhmtrains</span>)
<span class="no">pt</span>$<span class="fu">addColumnDataGroups</span>(<span class="st">"TrainCategory"</span>)
<span class="no">pt</span>$<span class="fu">addColumnDataGroups</span>(<span class="st">"PowerType"</span>)
<span class="no">pt</span>$<span class="fu">addRowDataGroups</span>(<span class="st">"TOC"</span>)
<span class="no">pt</span>$<span class="fu">defineCalculation</span>(<span class="kw">calculationName</span><span class="kw">=</span><span class="st">"TotalTrains"</span>, <span class="kw">summariseExpression</span><span class="kw">=</span><span class="st">"n()"</span>)
<span class="no">pt</span>$<span class="fu">evaluatePivot</span>()
<span class="no">cells</span> <span class="kw">&lt;-</span> <span class="no">pt</span>$<span class="fu">getCells</span>(<span class="kw">rowNumbers</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">2</span>, <span class="fl">4</span>))
<span class="no">pt</span>$<span class="fu">setStyling</span>(<span class="kw">cells</span><span class="kw">=</span><span class="no">cells</span>, <span class="kw">declarations</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">"background-color"</span><span class="kw">=</span><span class="st">"#FFCC66"</span>))
<span class="no">pt</span>$<span class="fu">renderPivot</span>()</pre></body></html></div>
<div id="htmlwidget-825dbc5bd541331b9c14" style="width:auto;height:auto;" class="pivottabler html-widget"></div>
<script type="application/json" data-for="htmlwidget-825dbc5bd541331b9c14">{"x":{"tableCss":".Table {display: table; border-collapse: collapse; }\r\n.ColumnHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px; text-align: center; }\r\n.RowHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px 8px 2px 2px; text-align: left; }\r\n.Cell {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n.OutlineColumnHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px; text-align: center; }\r\n.OutlineRowHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px 8px 2px 2px; text-align: left; }\r\n.OutlineCell {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; background-color: #F8F8F8; font-weight: bold; }\r\n.Total {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n","tableHtml":"<table class=\"Table\">\n  <tr>\n    <th class=\"RowHeader\" rowspan=\"2\">&nbsp;<\/th>\n    <th class=\"ColumnHeader\" colspan=\"4\">Express Passenger<\/th>\n    <th class=\"ColumnHeader\" colspan=\"3\">Ordinary Passenger<\/th>\n    <th class=\"ColumnHeader\">Total<\/th>\n  <\/tr>\n  <tr>\n    <th class=\"ColumnHeader\">DMU<\/th>\n    <th class=\"ColumnHeader\">EMU<\/th>\n    <th class=\"ColumnHeader\">HST<\/th>\n    <th class=\"ColumnHeader\">Total<\/th>\n    <th class=\"ColumnHeader\">DMU<\/th>\n    <th class=\"ColumnHeader\">EMU<\/th>\n    <th class=\"ColumnHeader\">Total<\/th>\n    <th class=\"ColumnHeader\">&nbsp;<\/th>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Arriva Trains Wales<\/th>\n    <td class=\"Cell\">3079<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">3079<\/td>\n    <td class=\"Cell\">830<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">830<\/td>\n    <td class=\"Total\">3909<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">CrossCountry<\/th>\n    <td class=\"Cell\" style=\"background-color: #FFCC66; \">22133<\/td>\n    <td class=\"Cell\" style=\"background-color: #FFCC66; \"><\/td>\n    <td class=\"Cell\" style=\"background-color: #FFCC66; \">732<\/td>\n    <td class=\"Total\" style=\"background-color: #FFCC66; \">22865<\/td>\n    <td class=\"Cell\" style=\"background-color: #FFCC66; \">63<\/td>\n    <td class=\"Cell\" style=\"background-color: #FFCC66; \"><\/td>\n    <td class=\"Total\" style=\"background-color: #FFCC66; \">63<\/td>\n    <td class=\"Total\" style=\"background-color: #FFCC66; \">22928<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">London Midland<\/th>\n    <td class=\"Cell\">5638<\/td>\n    <td class=\"Cell\">8849<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">14487<\/td>\n    <td class=\"Cell\">5591<\/td>\n    <td class=\"Cell\">28201<\/td>\n    <td class=\"Total\">33792<\/td>\n    <td class=\"Total\">48279<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Virgin Trains<\/th>\n    <td class=\"Cell\" style=\"background-color: #FFCC66; \">2137<\/td>\n    <td class=\"Cell\" style=\"background-color: #FFCC66; \">6457<\/td>\n    <td class=\"Cell\" style=\"background-color: #FFCC66; \"><\/td>\n    <td class=\"Total\" style=\"background-color: #FFCC66; \">8594<\/td>\n    <td class=\"Cell\" style=\"background-color: #FFCC66; \"><\/td>\n    <td class=\"Cell\" style=\"background-color: #FFCC66; \"><\/td>\n    <td class=\"Total\" style=\"background-color: #FFCC66; \"><\/td>\n    <td class=\"Total\" style=\"background-color: #FFCC66; \">8594<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Total<\/th>\n    <td class=\"Total\">32987<\/td>\n    <td class=\"Total\">15306<\/td>\n    <td class=\"Total\">732<\/td>\n    <td class=\"Total\">49025<\/td>\n    <td class=\"Total\">6484<\/td>\n    <td class=\"Total\">28201<\/td>\n    <td class=\"Total\">34685<\/td>\n    <td class=\"Total\">83710<\/td>\n  <\/tr>\n<\/table>","settings":[]},"evals":[],"jsHooks":[]}</script><p>To remove these rows:</p>
<div class="sourceCode" id="cb26"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">pivottabler</span>)
<span class="no">pt</span> <span class="kw">&lt;-</span> <span class="no">PivotTable</span>$<span class="fu">new</span>()
<span class="no">pt</span>$<span class="fu">addData</span>(<span class="no">bhmtrains</span>)
<span class="no">pt</span>$<span class="fu">addColumnDataGroups</span>(<span class="st">"TrainCategory"</span>)
<span class="no">pt</span>$<span class="fu">addColumnDataGroups</span>(<span class="st">"PowerType"</span>)
<span class="no">pt</span>$<span class="fu">addRowDataGroups</span>(<span class="st">"TOC"</span>)
<span class="no">pt</span>$<span class="fu">defineCalculation</span>(<span class="kw">calculationName</span><span class="kw">=</span><span class="st">"TotalTrains"</span>, <span class="kw">summariseExpression</span><span class="kw">=</span><span class="st">"n()"</span>)
<span class="no">pt</span>$<span class="fu">evaluatePivot</span>()
<span class="no">pt</span>$<span class="fu">removeRows</span>(<span class="kw">rowNumbers</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">2</span>, <span class="fl">4</span>))
<span class="no">pt</span>$<span class="fu">renderPivot</span>()</pre></body></html></div>
<div id="htmlwidget-6a0ded30991a7700fcf0" style="width:auto;height:auto;" class="pivottabler html-widget"></div>
<script type="application/json" data-for="htmlwidget-6a0ded30991a7700fcf0">{"x":{"tableCss":".Table {display: table; border-collapse: collapse; }\r\n.ColumnHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px; text-align: center; }\r\n.RowHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px 8px 2px 2px; text-align: left; }\r\n.Cell {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n.OutlineColumnHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px; text-align: center; }\r\n.OutlineRowHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px 8px 2px 2px; text-align: left; }\r\n.OutlineCell {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; background-color: #F8F8F8; font-weight: bold; }\r\n.Total {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n","tableHtml":"<table class=\"Table\">\n  <tr>\n    <th class=\"RowHeader\" rowspan=\"2\">&nbsp;<\/th>\n    <th class=\"ColumnHeader\" colspan=\"4\">Express Passenger<\/th>\n    <th class=\"ColumnHeader\" colspan=\"3\">Ordinary Passenger<\/th>\n    <th class=\"ColumnHeader\">Total<\/th>\n  <\/tr>\n  <tr>\n    <th class=\"ColumnHeader\">DMU<\/th>\n    <th class=\"ColumnHeader\">EMU<\/th>\n    <th class=\"ColumnHeader\">HST<\/th>\n    <th class=\"ColumnHeader\">Total<\/th>\n    <th class=\"ColumnHeader\">DMU<\/th>\n    <th class=\"ColumnHeader\">EMU<\/th>\n    <th class=\"ColumnHeader\">Total<\/th>\n    <th class=\"ColumnHeader\">&nbsp;<\/th>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Arriva Trains Wales<\/th>\n    <td class=\"Cell\">3079<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">3079<\/td>\n    <td class=\"Cell\">830<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">830<\/td>\n    <td class=\"Total\">3909<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">London Midland<\/th>\n    <td class=\"Cell\">5638<\/td>\n    <td class=\"Cell\">8849<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">14487<\/td>\n    <td class=\"Cell\">5591<\/td>\n    <td class=\"Cell\">28201<\/td>\n    <td class=\"Total\">33792<\/td>\n    <td class=\"Total\">48279<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Total<\/th>\n    <td class=\"Total\">32987<\/td>\n    <td class=\"Total\">15306<\/td>\n    <td class=\"Total\">732<\/td>\n    <td class=\"Total\">49025<\/td>\n    <td class=\"Total\">6484<\/td>\n    <td class=\"Total\">28201<\/td>\n    <td class=\"Total\">34685<\/td>\n    <td class=\"Total\">83710<\/td>\n  <\/tr>\n<\/table>","settings":[]},"evals":[],"jsHooks":[]}</script><p>Note that removing rows and/or columns does NOT recalculate the other cells in the pivot table, e.g. the values of the totals are not updated.</p>
</div>
<div id="converting-to-a-basictabler-table" class="section level3">
<h3 class="hasAnchor">
<a href="#converting-to-a-basictabler-table" class="anchor"></a>Converting to a basictabler table</h3>
<p>The <code>asBasicTable()</code> function allows a pivot table to be converted to a basic table - from the <code>basictabler</code> package.</p>
<p>The <code>basictabler</code> package allows free-form tables to be constructed, in contrast to <code>pivottabler</code> which creates pivot tables with relatively fixed structures. <code>pivottabler</code> contains calculation logic - to calculate the values of cells within the pivot table. <code>basictabler</code> contains no calculation logic - cell values must be provided either from a data frame, row-by-row, column-by-column or cell-by-cell.</p>
<p>Converting a pivot table to a basic table allows the structure of pivot tables to be altered after they have been created, e.g.</p>
<div class="sourceCode" id="cb27"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">pivottabler</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">dplyr</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">lubridate</span>)
<span class="no">trains</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="no">bhmtrains</span>,
                 <span class="kw">GbttDate</span><span class="kw">=</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html">if_else</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span>(<span class="no">GbttArrival</span>), <span class="no">GbttDeparture</span>, <span class="no">GbttArrival</span>),
                 <span class="kw">GbttMonth</span><span class="kw">=</span><span class="fu"><a href="http://lubridate.tidyverse.org/reference/make_datetime.html">make_date</a></span>(<span class="kw">year</span><span class="kw">=</span><span class="fu"><a href="http://lubridate.tidyverse.org/reference/year.html">year</a></span>(<span class="no">GbttDate</span>), <span class="kw">month</span><span class="kw">=</span><span class="fu"><a href="http://lubridate.tidyverse.org/reference/month.html">month</a></span>(<span class="no">GbttDate</span>), <span class="kw">day</span><span class="kw">=</span><span class="fl">1</span>))

<span class="no">pt</span> <span class="kw">&lt;-</span> <span class="no">PivotTable</span>$<span class="fu">new</span>()
<span class="no">pt</span>$<span class="fu">addData</span>(<span class="no">trains</span>)
<span class="no">pt</span>$<span class="fu">addColumnDataGroups</span>(<span class="st">"GbttMonth"</span>, <span class="kw">dataFormat</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">format</span><span class="kw">=</span><span class="st">"%B %Y"</span>))
<span class="no">pt</span>$<span class="fu">addColumnDataGroups</span>(<span class="st">"PowerType"</span>)
<span class="no">pt</span>$<span class="fu">addRowDataGroups</span>(<span class="st">"TOC"</span>)
<span class="no">pt</span>$<span class="fu">defineCalculation</span>(<span class="kw">calculationName</span><span class="kw">=</span><span class="st">"TotalTrains"</span>, <span class="kw">summariseExpression</span><span class="kw">=</span><span class="st">"n()"</span>)
<span class="no">pt</span>$<span class="fu">evaluatePivot</span>()

<span class="co"># convert the pivot table to a basic table, insert a new row, merge cells and highlight</span>
<span class="no">bt</span> <span class="kw">&lt;-</span> <span class="no">pt</span>$<span class="fu">asBasicTable</span>()
<span class="no">bt</span>$<span class="no">cells</span>$<span class="fu">insertRow</span>(<span class="fl">5</span>)
<span class="no">bt</span>$<span class="no">cells</span>$<span class="fu">setCell</span>(<span class="fl">5</span>, <span class="fl">2</span>, <span class="kw">rawValue</span><span class="kw">=</span><span class="st">"The values below are significantly higher than expected."</span>,
                 <span class="kw">styleDeclarations</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">"text-align"</span><span class="kw">=</span><span class="st">"left"</span>, <span class="st">"background-color"</span><span class="kw">=</span><span class="st">"yellow"</span>,
                                        <span class="st">"font-weight"</span><span class="kw">=</span><span class="st">"bold"</span>, <span class="st">"font-style"</span><span class="kw">=</span><span class="st">"italic"</span>))
<span class="no">bt</span>$<span class="fu">mergeCells</span>(<span class="kw">rFrom</span><span class="kw">=</span><span class="fl">5</span>, <span class="kw">cFrom</span><span class="kw">=</span><span class="fl">2</span>, <span class="kw">rSpan</span><span class="kw">=</span><span class="fl">1</span>, <span class="kw">cSpan</span><span class="kw">=</span><span class="fl">13</span>)
<span class="no">bt</span>$<span class="fu">setStyling</span>(<span class="kw">rFrom</span><span class="kw">=</span><span class="fl">6</span>, <span class="kw">cFrom</span><span class="kw">=</span><span class="fl">2</span>, <span class="kw">rTo</span><span class="kw">=</span><span class="fl">6</span>, <span class="kw">cTo</span><span class="kw">=</span><span class="fl">14</span>,
              <span class="kw">declarations</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">"text-align"</span><span class="kw">=</span><span class="st">"left"</span>, <span class="st">"background-color"</span><span class="kw">=</span><span class="st">"yellow"</span>))
<span class="no">bt</span>$<span class="fu">renderTable</span>()</pre></body></html></div>
<div id="htmlwidget-eefbdeb3d5789e32cfbe" style="width:auto;height:auto;" class="basictabler html-widget"></div>
<script type="application/json" data-for="htmlwidget-eefbdeb3d5789e32cfbe">{"x":{"tableCss":".Table {display: table; border-collapse: collapse; }\r\n.ColumnHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px; text-align: center; }\r\n.RowHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px 8px 2px 2px; text-align: left; }\r\n.Cell {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n.OutlineColumnHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px; text-align: center; }\r\n.OutlineRowHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px 8px 2px 2px; text-align: left; }\r\n.OutlineCell {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; background-color: #F8F8F8; font-weight: bold; }\r\n.Total {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n","tableHtml":"<table class=\"Table\">\n  <tr>\n    <th rowspan=\"2\" class=\"RowHeader\">&nbsp;<\/th>\n    <th colspan=\"4\" class=\"ColumnHeader\">December 2016<\/th>\n    <th colspan=\"4\" class=\"ColumnHeader\">January 2017<\/th>\n    <th colspan=\"4\" class=\"ColumnHeader\">February 2017<\/th>\n    <th class=\"ColumnHeader\">Total<\/th>\n  <\/tr>\n  <tr>\n    <th class=\"ColumnHeader\">DMU<\/th>\n    <th class=\"ColumnHeader\">EMU<\/th>\n    <th class=\"ColumnHeader\">HST<\/th>\n    <th class=\"ColumnHeader\">Total<\/th>\n    <th class=\"ColumnHeader\">DMU<\/th>\n    <th class=\"ColumnHeader\">EMU<\/th>\n    <th class=\"ColumnHeader\">HST<\/th>\n    <th class=\"ColumnHeader\">Total<\/th>\n    <th class=\"ColumnHeader\">DMU<\/th>\n    <th class=\"ColumnHeader\">EMU<\/th>\n    <th class=\"ColumnHeader\">HST<\/th>\n    <th class=\"ColumnHeader\">Total<\/th>\n    <th class=\"ColumnHeader\"><\/th>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Arriva Trains Wales<\/th>\n    <td class=\"Cell\">1291<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">1291<\/td>\n    <td class=\"Cell\">1402<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">1402<\/td>\n    <td class=\"Cell\">1216<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">1216<\/td>\n    <td class=\"Total\">3909<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">CrossCountry<\/th>\n    <td class=\"Cell\">7314<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\">236<\/td>\n    <td class=\"Total\">7550<\/td>\n    <td class=\"Cell\">7777<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\">256<\/td>\n    <td class=\"Total\">8033<\/td>\n    <td class=\"Cell\">7105<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\">240<\/td>\n    <td class=\"Total\">7345<\/td>\n    <td class=\"Total\">22928<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\"><\/th>\n    <td colspan=\"13\" class=\"Cell\" style=\"text-align: left; background-color: yellow; font-weight: bold; font-style: italic; \">The values below are significantly higher than expected.<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">London Midland<\/th>\n    <td class=\"Cell\" style=\"text-align: left; background-color: yellow; \">3635<\/td>\n    <td class=\"Cell\" style=\"text-align: left; background-color: yellow; \">11967<\/td>\n    <td class=\"Cell\" style=\"text-align: left; background-color: yellow; \"><\/td>\n    <td class=\"Total\" style=\"text-align: left; background-color: yellow; \">15602<\/td>\n    <td class=\"Cell\" style=\"text-align: left; background-color: yellow; \">3967<\/td>\n    <td class=\"Cell\" style=\"text-align: left; background-color: yellow; \">13062<\/td>\n    <td class=\"Cell\" style=\"text-align: left; background-color: yellow; \"><\/td>\n    <td class=\"Total\" style=\"text-align: left; background-color: yellow; \">17029<\/td>\n    <td class=\"Cell\" style=\"text-align: left; background-color: yellow; \">3627<\/td>\n    <td class=\"Cell\" style=\"text-align: left; background-color: yellow; \">12021<\/td>\n    <td class=\"Cell\" style=\"text-align: left; background-color: yellow; \"><\/td>\n    <td class=\"Total\" style=\"text-align: left; background-color: yellow; \">15648<\/td>\n    <td class=\"Total\" style=\"text-align: left; background-color: yellow; \">48279<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Virgin Trains<\/th>\n    <td class=\"Cell\">740<\/td>\n    <td class=\"Cell\">2137<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">2877<\/td>\n    <td class=\"Cell\">728<\/td>\n    <td class=\"Cell\">2276<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">3004<\/td>\n    <td class=\"Cell\">669<\/td>\n    <td class=\"Cell\">2044<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">2713<\/td>\n    <td class=\"Total\">8594<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Total<\/th>\n    <td class=\"Total\">12980<\/td>\n    <td class=\"Total\">14104<\/td>\n    <td class=\"Total\">236<\/td>\n    <td class=\"Total\">27320<\/td>\n    <td class=\"Total\">13874<\/td>\n    <td class=\"Total\">15338<\/td>\n    <td class=\"Total\">256<\/td>\n    <td class=\"Total\">29468<\/td>\n    <td class=\"Total\">12617<\/td>\n    <td class=\"Total\">14065<\/td>\n    <td class=\"Total\">240<\/td>\n    <td class=\"Total\">26922<\/td>\n    <td class=\"Total\">83710<\/td>\n  <\/tr>\n<\/table>","settings":[]},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div id="further-reading" class="section level2">
<h2 class="hasAnchor">
<a href="#further-reading" class="anchor"></a>Further Reading</h2>
<p>The full set of vignettes is:</p>
<ol style="list-style-type: decimal">
<li><a href="v01-introduction.html">Introduction</a></li>
<li><a href="v02-datagroups.html">Data Groups</a></li>
<li><a href="v03-calculations.html">Calculations</a></li>
<li><a href="v04-regularlayout.html">Regular Layout</a></li>
<li><a href="v05-outputs.html">Outputs</a></li>
<li><a href="v06-latexoutput.html">Latex Output</a></li>
<li><a href="v07-styling.html">Styling</a></li>
<li><a href="v08-findingandformatting.html">Finding and Formatting</a></li>
<li><a href="v09-cellcontext.html">Cell Context</a></li>
<li><a href="v10-navigatingapivottable.html">Navigating a Pivot Table</a></li>
<li><a href="v11-irregularlayout.html">Irregular Layout</a></li>
<li><a href="v12-performance.html">Performance</a></li>
<li><a href="v13-excelexport.html">Excel Export</a></li>
<li><a href="v14-shiny.html">Shiny</a></li>
<li><a href="vA1-appendix.html">Appendix: Details</a></li>
<li><a href="vA2-appendix.html">Appendix: Calculations</a></li>
<li><a href="vA3-appendix.html">Appendix: Class Overview</a></li>
</ol>
</div>
<div class="footnotes">
<hr>
<ol>
<li id="fn1"><p>Use the <code>addColumnDataGroups()</code> and <code>addRowDataGroups()</code> functions against the pivot table. Use the <code>addDataGroups()</code> function against data groups.<a href="#fnref1" class="footnote-back">↩</a></p></li>
<li id="fn2"><p>Every pivot table has a default calculation group named “default”.<a href="#fnref2" class="footnote-back">↩</a></p></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Christopher Bailiss.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    
    
    apiKey: '16a61fa9a8811ff537cd1a528040a9e1',
    indexName: 'pivottabler',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>
</body>
</html>
