<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>05. Outputs • pivottabler</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.3/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous">
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><meta property="og:title" content="05. Outputs">
<meta property="og:description" content="pivottabler">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-64707587-2"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-64707587-2');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">pivottabler</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.5.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/cbailiss/pivottabler/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
<form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
</div>
      </form>
      
    </div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="v05-outputs_files/htmlwidgets-1.5.1/htmlwidgets.js"></script><script src="v05-outputs_files/pivottabler-binding-1.5.0/pivottabler.js"></script><script src="v05-outputs_files/basictabler-binding-0.3.1/basictabler.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>05. Outputs</h1>
                        <h4 class="author">Chris Bailiss</h4>
            
            <h4 class="date">2020-06-16</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/cbailiss/pivottabler/blob/master/vignettes/v05-outputs.Rmd"><code>vignettes/v05-outputs.Rmd</code></a></small>
      <div class="hidden name"><code>v05-outputs.Rmd</code></div>

    </div>

    
    
<div id="in-this-vignette" class="section level2">
<h2 class="hasAnchor">
<a href="#in-this-vignette" class="anchor"></a>In This Vignette</h2>
<ul>
<li>Results of Pivot Calculations</li>
<li>Example Pivot Table</li>
<li>Results as Plain Text</li>
<li>Results as HTML</li>
<li>Results as Latex</li>
<li>Results in Excel</li>
<li>Results as an R Matrix</li>
<li>Results as an R Data Frame</li>
<li>Results as a basictabler Table</li>
<li>Further Reading</li>
</ul>
</div>
<div id="results-of-pivot-calculations" class="section level2">
<h2 class="hasAnchor">
<a href="#results-of-pivot-calculations" class="anchor"></a>Results of Pivot Calculations</h2>
<p>A <code>pivottabler</code> pivot table object has a fairly complex internal structure - containing two trees of data groups (the row groups and the column groups) plus a set of cells linked to the data groups.</p>
<p>The <code>pivottabler</code> package supports outputting a pivot table in a number of different forms:</p>
<ul>
<li>A htmlwidget for R-Studio - using <code>pt$renderPivot()</code> to render the pivot table into the “Viewer” tab in R-Studio,</li>
<li>A htmlwidget for Shiny applications - using <code><a href="../reference/pivottabler.html">pivottabler(pt)</a></code> to render the pivot table into the Shiny app,</li>
<li>As HTML - using either:
<ul>
<li>
<code>pt$getHtml()</code> to retrieve a character variable containing HTML, or</li>
<li>
<code>pt$saveHtml()</code> to save the HTML to a file.</li>
</ul>
</li>
<li>As Latex - using <code>pt$getLatex()</code> to retrieve a character variable containing Latex.</li>
<li>As plain text - using <code>pt</code> to output to the console or <code>pt$asCharacter</code> to retrieve as a character value.</li>
<li>Into an Excel Worksheet.</li>
</ul>
<p>Sometimes it is desirable to retrieve the pivot table results as a more standard data type that is easier to work with in R code. A pivot table can be converted to either a matrix or a data frame. Neither data type is a perfect representation of a pivot table - which option is better will depend upon your use case.</p>
</div>
<div id="example-pivot-table" class="section level2">
<h2 class="hasAnchor">
<a href="#example-pivot-table" class="anchor"></a>Example Pivot Table</h2>
<p>The following pivot table is used as the basis of the examples in the rest of this vignette:</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">pivottabler</span>)
<span class="no">pt</span> <span class="kw">&lt;-</span> <span class="no">PivotTable</span>$<span class="fu">new</span>()
<span class="no">pt</span>$<span class="fu">addData</span>(<span class="no">bhmtrains</span>)
<span class="no">pt</span>$<span class="fu">addColumnDataGroups</span>(<span class="st">"PowerType"</span>)
<span class="no">pt</span>$<span class="fu">addRowDataGroups</span>(<span class="st">"TOC"</span>)
<span class="no">pt</span>$<span class="fu">defineCalculation</span>(<span class="kw">calculationName</span><span class="kw">=</span><span class="st">"TotalTrains"</span>, <span class="kw">summariseExpression</span><span class="kw">=</span><span class="st">"n()"</span>)
<span class="no">pt</span>$<span class="fu">renderPivot</span>()</pre></body></html></div>
<div id="htmlwidget-ae6d021b575cff6b608d" style="width:auto;height:auto;" class="pivottabler html-widget"></div>
<script type="application/json" data-for="htmlwidget-ae6d021b575cff6b608d">{"x":{"tableCss":".Table {display: table; border-collapse: collapse; }\r\n.ColumnHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px; text-align: center; }\r\n.RowHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px 8px 2px 2px; text-align: left; }\r\n.Cell {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n.OutlineColumnHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px; text-align: center; }\r\n.OutlineRowHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px 8px 2px 2px; text-align: left; }\r\n.OutlineCell {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; background-color: #F8F8F8; font-weight: bold; }\r\n.Total {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n","tableHtml":"<table class=\"Table\">\n  <tr>\n    <th class=\"RowHeader\">&nbsp;<\/th>\n    <th class=\"ColumnHeader\">DMU<\/th>\n    <th class=\"ColumnHeader\">EMU<\/th>\n    <th class=\"ColumnHeader\">HST<\/th>\n    <th class=\"ColumnHeader\">Total<\/th>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Arriva Trains Wales<\/th>\n    <td class=\"Cell\">3909<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">3909<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">CrossCountry<\/th>\n    <td class=\"Cell\">22196<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\">732<\/td>\n    <td class=\"Total\">22928<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">London Midland<\/th>\n    <td class=\"Cell\">11229<\/td>\n    <td class=\"Cell\">37050<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">48279<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Virgin Trains<\/th>\n    <td class=\"Cell\">2137<\/td>\n    <td class=\"Cell\">6457<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">8594<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Total<\/th>\n    <td class=\"Total\">39471<\/td>\n    <td class=\"Total\">43507<\/td>\n    <td class=\"Total\">732<\/td>\n    <td class=\"Total\">83710<\/td>\n  <\/tr>\n<\/table>","settings":[]},"evals":[],"jsHooks":[]}</script>
</div>
<div id="results-as-plain-text" class="section level2">
<h2 class="hasAnchor">
<a href="#results-as-plain-text" class="anchor"></a>Results as Plain Text</h2>
<p>A pivot table is outputted to the console as plain text simply by using <code>pt</code>:</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">pivottabler</span>)
<span class="no">pt</span> <span class="kw">&lt;-</span> <span class="no">PivotTable</span>$<span class="fu">new</span>()
<span class="no">pt</span>$<span class="fu">addData</span>(<span class="no">bhmtrains</span>)
<span class="no">pt</span>$<span class="fu">addColumnDataGroups</span>(<span class="st">"PowerType"</span>)
<span class="no">pt</span>$<span class="fu">addRowDataGroups</span>(<span class="st">"TOC"</span>)
<span class="no">pt</span>$<span class="fu">defineCalculation</span>(<span class="kw">calculationName</span><span class="kw">=</span><span class="st">"TotalTrains"</span>, <span class="kw">summariseExpression</span><span class="kw">=</span><span class="st">"n()"</span>)
<span class="no">pt</span>$<span class="fu">evaluatePivot</span>()
<span class="no">pt</span></pre></body></html></div>
<pre><code>                     DMU    EMU    HST  Total  
Arriva Trains Wales   3909               3909  
CrossCountry         22196         732  22928  
London Midland       11229  37050       48279  
Virgin Trains         2137   6457        8594  
Total                39471  43507  732  83710  </code></pre>
<p>Alternatively, the plain text representation of the pivot table can be retrieved as a character value using <code>pt$asCharacter</code>.</p>
<p><code>pt</code> and <code>pt$asString</code> show the current state of the pivot table. If the pivot table has not been evaluated (either by using <code>pt$evaluatePivot()</code> or <code>pt$renderPivot()</code>) then <code>pt</code> and <code>pt$asCharacter</code> will return the headings only:</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">pivottabler</span>)
<span class="no">pt</span> <span class="kw">&lt;-</span> <span class="no">PivotTable</span>$<span class="fu">new</span>()
<span class="no">pt</span>$<span class="fu">addData</span>(<span class="no">bhmtrains</span>)
<span class="no">pt</span>$<span class="fu">addColumnDataGroups</span>(<span class="st">"PowerType"</span>)
<span class="no">pt</span>$<span class="fu">addRowDataGroups</span>(<span class="st">"TOC"</span>)
<span class="no">pt</span>$<span class="fu">defineCalculation</span>(<span class="kw">calculationName</span><span class="kw">=</span><span class="st">"TotalTrains"</span>, <span class="kw">summariseExpression</span><span class="kw">=</span><span class="st">"n()"</span>)
<span class="no">pt</span></pre></body></html></div>
<pre><code>                     DMU  EMU  HST  Total  
Arriva Trains Wales  
CrossCountry         
London Midland       
Virgin Trains        
Total                </code></pre>
</div>
<div id="results-as-html" class="section level2">
<h2 class="hasAnchor">
<a href="#results-as-html" class="anchor"></a>Results as HTML</h2>
<div id="rendering-a-htmlwidget" class="section level3">
<h3 class="hasAnchor">
<a href="#rendering-a-htmlwidget" class="anchor"></a>Rendering a htmlwidget</h3>
<p>A pivot table is outputted as a htmlwidget simply by calling <code>pt$renderPivot()</code>. There are numerous examples throughout these vignettes, including the example directly above.</p>
<p>For outputting as a htmlwidget in a Shiny application, use <code><a href="../reference/pivottabler.html">pivottabler(pt)</a></code>.</p>
</div>
<div id="retrieving-html" class="section level3">
<h3 class="hasAnchor">
<a href="#retrieving-html" class="anchor"></a>Retrieving HTML</h3>
<p>To retrieve the HTML of a pivot table, use <code>pt$getHtml()</code>. This returns a list of html tag objects built using the htmltools package. This object can be converted to a simple character variable using <code><a href="https://rdrr.io/r/base/character.html">as.character()</a></code> or as illustrated below. The CSS declarations for a pivot table can be retrieved using <code>pt$getCss()</code> - also illustrated below.</p>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">pivottabler</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">htmltools</span>)
<span class="no">pt</span> <span class="kw">&lt;-</span> <span class="no">PivotTable</span>$<span class="fu">new</span>()
<span class="no">pt</span>$<span class="fu">addData</span>(<span class="no">bhmtrains</span>)
<span class="no">pt</span>$<span class="fu">addColumnDataGroups</span>(<span class="st">"PowerType"</span>)
<span class="no">pt</span>$<span class="fu">addRowDataGroups</span>(<span class="st">"TOC"</span>)
<span class="no">pt</span>$<span class="fu">defineCalculation</span>(<span class="kw">calculationName</span><span class="kw">=</span><span class="st">"TotalTrains"</span>, <span class="kw">summariseExpression</span><span class="kw">=</span><span class="st">"n()"</span>)
<span class="no">pt</span>$<span class="fu">evaluatePivot</span>()
<span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="no">pt</span>$<span class="fu">getHtml</span>(), <span class="kw">sep</span><span class="kw">=</span><span class="st">""</span>, <span class="kw">collapse</span><span class="kw">=</span><span class="st">"\n"</span>))</pre></body></html></div>
<pre><code>&lt;table class="Table"&gt;
  &lt;tr&gt;
    &lt;th class="RowHeader"&gt;&amp;nbsp;&lt;/th&gt;
    &lt;th class="ColumnHeader"&gt;DMU&lt;/th&gt;
    &lt;th class="ColumnHeader"&gt;EMU&lt;/th&gt;
    &lt;th class="ColumnHeader"&gt;HST&lt;/th&gt;
    &lt;th class="ColumnHeader"&gt;Total&lt;/th&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;th class="RowHeader"&gt;Arriva Trains Wales&lt;/th&gt;
    &lt;td class="Cell"&gt;3909&lt;/td&gt;
    &lt;td class="Cell"&gt;&lt;/td&gt;
    &lt;td class="Cell"&gt;&lt;/td&gt;
    &lt;td class="Total"&gt;3909&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;th class="RowHeader"&gt;CrossCountry&lt;/th&gt;
    &lt;td class="Cell"&gt;22196&lt;/td&gt;
    &lt;td class="Cell"&gt;&lt;/td&gt;
    &lt;td class="Cell"&gt;732&lt;/td&gt;
    &lt;td class="Total"&gt;22928&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;th class="RowHeader"&gt;London Midland&lt;/th&gt;
    &lt;td class="Cell"&gt;11229&lt;/td&gt;
    &lt;td class="Cell"&gt;37050&lt;/td&gt;
    &lt;td class="Cell"&gt;&lt;/td&gt;
    &lt;td class="Total"&gt;48279&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;th class="RowHeader"&gt;Virgin Trains&lt;/th&gt;
    &lt;td class="Cell"&gt;2137&lt;/td&gt;
    &lt;td class="Cell"&gt;6457&lt;/td&gt;
    &lt;td class="Cell"&gt;&lt;/td&gt;
    &lt;td class="Total"&gt;8594&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;th class="RowHeader"&gt;Total&lt;/th&gt;
    &lt;td class="Total"&gt;39471&lt;/td&gt;
    &lt;td class="Total"&gt;43507&lt;/td&gt;
    &lt;td class="Total"&gt;732&lt;/td&gt;
    &lt;td class="Total"&gt;83710&lt;/td&gt;
  &lt;/tr&gt;
&lt;/table&gt;</code></pre>
<div class="sourceCode" id="cb8"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span>(<span class="no">pt</span>$<span class="fu">getCss</span>())</pre></body></html></div>
<pre><code>.Table {display: table; border-collapse: collapse; }
.ColumnHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px; text-align: center; }
.RowHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px 8px 2px 2px; text-align: left; }
.Cell {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }
.OutlineColumnHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px; text-align: center; }
.OutlineRowHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px 8px 2px 2px; text-align: left; }
.OutlineCell {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; background-color: #F8F8F8; font-weight: bold; }
.Total {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }</code></pre>
</div>
</div>
<div id="results-as-latex" class="section level2">
<h2 class="hasAnchor">
<a href="#results-as-latex" class="anchor"></a>Results as Latex</h2>
<p>Please see the <a href="v06-latexoutput.html">Latex Output</a> vignette.</p>
</div>
<div id="results-in-excel" class="section level2">
<h2 class="hasAnchor">
<a href="#results-in-excel" class="anchor"></a>Results in Excel</h2>
<p>Please see the <a href="v13-excelexport.html">Excel Export</a> vignette.</p>
</div>
<div id="results-as-an-r-matrix" class="section level2">
<h2 class="hasAnchor">
<a href="#results-as-an-r-matrix" class="anchor"></a>Results as an R Matrix</h2>
<div id="as-a-data-matrix" class="section level3">
<h3 class="hasAnchor">
<a href="#as-a-data-matrix" class="anchor"></a>As a Data Matrix</h3>
<p>Converting a pivot table to a matrix is possible. The row/column headers become the row/column names in the matrix:</p>
<div class="sourceCode" id="cb10"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">pivottabler</span>)
<span class="no">pt</span> <span class="kw">&lt;-</span> <span class="no">PivotTable</span>$<span class="fu">new</span>()
<span class="no">pt</span>$<span class="fu">addData</span>(<span class="no">bhmtrains</span>)
<span class="no">pt</span>$<span class="fu">addColumnDataGroups</span>(<span class="st">"PowerType"</span>)
<span class="no">pt</span>$<span class="fu">addRowDataGroups</span>(<span class="st">"TOC"</span>)
<span class="no">pt</span>$<span class="fu">defineCalculation</span>(<span class="kw">calculationName</span><span class="kw">=</span><span class="st">"TotalTrains"</span>, <span class="kw">summariseExpression</span><span class="kw">=</span><span class="st">"n()"</span>)
<span class="no">pt</span>$<span class="fu">evaluatePivot</span>()
<span class="no">pt</span>$<span class="fu">asDataMatrix</span>()</pre></body></html></div>
<pre><code>                      DMU   EMU HST Total
Arriva Trains Wales  3909    NA  NA  3909
CrossCountry        22196    NA 732 22928
London Midland      11229 37050  NA 48279
Virgin Trains        2137  6457  NA  8594
Total               39471 43507 732 83710</code></pre>
<p>If only the cell values are required, the headings can be removed from the matrix by setting the <code>includeHeaders</code> parameter to <code>FALSE</code>.</p>
<p>By default, <code>asDataMatrix()</code> populates the matrix with the raw cell values. Setting the <code>rawValue</code> parameter to <code>FALSE</code> specifies that the matrix should contain the formatted <code>character</code> values instead of the raw values.</p>
<div class="sourceCode" id="cb12"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">pivottabler</span>)
<span class="no">pt</span> <span class="kw">&lt;-</span> <span class="no">PivotTable</span>$<span class="fu">new</span>()
<span class="no">pt</span>$<span class="fu">addData</span>(<span class="no">bhmtrains</span>)
<span class="no">pt</span>$<span class="fu">addColumnDataGroups</span>(<span class="st">"PowerType"</span>)
<span class="no">pt</span>$<span class="fu">addRowDataGroups</span>(<span class="st">"TOC"</span>)
<span class="no">pt</span>$<span class="fu">defineCalculation</span>(<span class="kw">calculationName</span><span class="kw">=</span><span class="st">"TotalTrains"</span>, <span class="kw">summariseExpression</span><span class="kw">=</span><span class="st">"n()"</span>)
<span class="no">pt</span>$<span class="fu">evaluatePivot</span>()
<span class="no">pt</span>$<span class="fu">asDataMatrix</span>(<span class="kw">rawValue</span><span class="kw">=</span><span class="fl">FALSE</span>)</pre></body></html></div>
<pre><code>                    DMU     EMU     HST   Total  
Arriva Trains Wales "3909"  NA      NA    "3909" 
CrossCountry        "22196" NA      "732" "22928"
London Midland      "11229" "37050" NA    "48279"
Virgin Trains       "2137"  "6457"  NA    "8594" 
Total               "39471" "43507" "732" "83710"</code></pre>
<p>When there are multiple levels of headers, headers are concatenated. A separator can be specified:</p>
<div class="sourceCode" id="cb14"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">dplyr</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">pivottabler</span>)
<span class="no">data</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="no">bhmtrains</span>, (<span class="no">Status</span><span class="kw">==</span><span class="st">"A"</span>)<span class="kw">|</span>(<span class="no">Status</span><span class="kw">==</span><span class="st">"C"</span>))
<span class="no">pt</span> <span class="kw">&lt;-</span> <span class="no">PivotTable</span>$<span class="fu">new</span>()
<span class="no">pt</span>$<span class="fu">addData</span>(<span class="no">data</span>)
<span class="no">pt</span>$<span class="fu">addColumnDataGroups</span>(<span class="st">"PowerType"</span>, <span class="kw">addTotal</span><span class="kw">=</span><span class="fl">FALSE</span>)
<span class="no">pt</span>$<span class="fu">addColumnDataGroups</span>(<span class="st">"Status"</span>, <span class="kw">addTotal</span><span class="kw">=</span><span class="fl">FALSE</span>)
<span class="no">pt</span>$<span class="fu">addRowDataGroups</span>(<span class="st">"TOC"</span>)
<span class="no">pt</span>$<span class="fu">defineCalculation</span>(<span class="kw">calculationName</span><span class="kw">=</span><span class="st">"TotalTrains"</span>, <span class="kw">summariseExpression</span><span class="kw">=</span><span class="st">"n()"</span>)
<span class="no">pt</span>$<span class="fu">renderPivot</span>()</pre></body></html></div>
<div id="htmlwidget-2e77ce35474c7a52344e" style="width:auto;height:auto;" class="pivottabler html-widget"></div>
<script type="application/json" data-for="htmlwidget-2e77ce35474c7a52344e">{"x":{"tableCss":".Table {display: table; border-collapse: collapse; }\r\n.ColumnHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px; text-align: center; }\r\n.RowHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px 8px 2px 2px; text-align: left; }\r\n.Cell {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n.OutlineColumnHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px; text-align: center; }\r\n.OutlineRowHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px 8px 2px 2px; text-align: left; }\r\n.OutlineCell {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; background-color: #F8F8F8; font-weight: bold; }\r\n.Total {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n","tableHtml":"<table class=\"Table\">\n  <tr>\n    <th class=\"RowHeader\" rowspan=\"2\">&nbsp;<\/th>\n    <th class=\"ColumnHeader\" colspan=\"2\">DMU<\/th>\n    <th class=\"ColumnHeader\" colspan=\"2\">EMU<\/th>\n    <th class=\"ColumnHeader\" colspan=\"2\">HST<\/th>\n  <\/tr>\n  <tr>\n    <th class=\"ColumnHeader\">A<\/th>\n    <th class=\"ColumnHeader\">C<\/th>\n    <th class=\"ColumnHeader\">A<\/th>\n    <th class=\"ColumnHeader\">C<\/th>\n    <th class=\"ColumnHeader\">A<\/th>\n    <th class=\"ColumnHeader\">C<\/th>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Arriva Trains Wales<\/th>\n    <td class=\"Cell\">3833<\/td>\n    <td class=\"Cell\">74<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\"><\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">CrossCountry<\/th>\n    <td class=\"Cell\">21621<\/td>\n    <td class=\"Cell\">548<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\">709<\/td>\n    <td class=\"Cell\">23<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">London Midland<\/th>\n    <td class=\"Cell\">11054<\/td>\n    <td class=\"Cell\">168<\/td>\n    <td class=\"Cell\">35930<\/td>\n    <td class=\"Cell\">1082<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\"><\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Virgin Trains<\/th>\n    <td class=\"Cell\">2028<\/td>\n    <td class=\"Cell\">107<\/td>\n    <td class=\"Cell\">6331<\/td>\n    <td class=\"Cell\">119<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\"><\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Total<\/th>\n    <td class=\"Total\">38536<\/td>\n    <td class=\"Total\">897<\/td>\n    <td class=\"Total\">42261<\/td>\n    <td class=\"Total\">1201<\/td>\n    <td class=\"Total\">709<\/td>\n    <td class=\"Total\">23<\/td>\n  <\/tr>\n<\/table>","settings":[]},"evals":[],"jsHooks":[]}</script><div class="sourceCode" id="cb15"><html><body><pre class="r"><span class="no">pt</span>$<span class="fu">asDataMatrix</span>(<span class="kw">separator</span><span class="kw">=</span><span class="st">"|"</span>)</pre></body></html></div>
<pre><code>                    DMU|A DMU|C EMU|A EMU|C HST|A HST|C
Arriva Trains Wales  3833    74    NA    NA    NA    NA
CrossCountry        21621   548    NA    NA   709    23
London Midland      11054   168 35930  1082    NA    NA
Virgin Trains        2028   107  6331   119    NA    NA
Total               38536   897 42261  1201   709    23</code></pre>
</div>
<div id="as-a-character-matrix" class="section level3">
<h3 class="hasAnchor">
<a href="#as-a-character-matrix" class="anchor"></a>As a <code>character</code> matrix</h3>
<p>It is also possible to convert a pivot table to a <code>character</code> matrix, where the row/column names are within the body of the matrix:</p>
<div class="sourceCode" id="cb17"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">pivottabler</span>)
<span class="no">pt</span> <span class="kw">&lt;-</span> <span class="no">PivotTable</span>$<span class="fu">new</span>()
<span class="no">pt</span>$<span class="fu">addData</span>(<span class="no">bhmtrains</span>)
<span class="no">pt</span>$<span class="fu">addColumnDataGroups</span>(<span class="st">"PowerType"</span>)
<span class="no">pt</span>$<span class="fu">addRowDataGroups</span>(<span class="st">"TOC"</span>)
<span class="no">pt</span>$<span class="fu">defineCalculation</span>(<span class="kw">calculationName</span><span class="kw">=</span><span class="st">"TotalTrains"</span>, <span class="kw">summariseExpression</span><span class="kw">=</span><span class="st">"n()"</span>)
<span class="no">pt</span>$<span class="fu">evaluatePivot</span>()
<span class="no">pt</span>$<span class="fu">asMatrix</span>()</pre></body></html></div>
<pre><code>     [,1]                  [,2]    [,3]    [,4]  [,5]   
[1,] ""                    "DMU"   "EMU"   "HST" "Total"
[2,] "Arriva Trains Wales" "3909"  ""      ""    "3909" 
[3,] "CrossCountry"        "22196" ""      "732" "22928"
[4,] "London Midland"      "11229" "37050" ""    "48279"
[5,] "Virgin Trains"       "2137"  "6457"  ""    "8594" 
[6,] "Total"               "39471" "43507" "732" "83710"</code></pre>
<p>If only the cell values are required, the headings can be removed from the matrix by setting the <code>includeHeaders</code> parameter to <code>FALSE</code>.</p>
<p>When there are multiple levels of headers, by default the column headers are not repeated:</p>
<div class="sourceCode" id="cb19"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">dplyr</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">pivottabler</span>)
<span class="no">data</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="no">bhmtrains</span>, (<span class="no">Status</span><span class="kw">==</span><span class="st">"A"</span>)<span class="kw">|</span>(<span class="no">Status</span><span class="kw">==</span><span class="st">"C"</span>))
<span class="no">pt</span> <span class="kw">&lt;-</span> <span class="no">PivotTable</span>$<span class="fu">new</span>()
<span class="no">pt</span>$<span class="fu">addData</span>(<span class="no">data</span>)
<span class="no">pt</span>$<span class="fu">addColumnDataGroups</span>(<span class="st">"PowerType"</span>, <span class="kw">addTotal</span><span class="kw">=</span><span class="fl">FALSE</span>)
<span class="no">pt</span>$<span class="fu">addColumnDataGroups</span>(<span class="st">"Status"</span>, <span class="kw">addTotal</span><span class="kw">=</span><span class="fl">FALSE</span>)
<span class="no">pt</span>$<span class="fu">addRowDataGroups</span>(<span class="st">"TOC"</span>)
<span class="no">pt</span>$<span class="fu">defineCalculation</span>(<span class="kw">calculationName</span><span class="kw">=</span><span class="st">"TotalTrains"</span>, <span class="kw">summariseExpression</span><span class="kw">=</span><span class="st">"n()"</span>)
<span class="no">pt</span>$<span class="fu">renderPivot</span>()</pre></body></html></div>
<div id="htmlwidget-ce206d21a14f0da941b8" style="width:auto;height:auto;" class="pivottabler html-widget"></div>
<script type="application/json" data-for="htmlwidget-ce206d21a14f0da941b8">{"x":{"tableCss":".Table {display: table; border-collapse: collapse; }\r\n.ColumnHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px; text-align: center; }\r\n.RowHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px 8px 2px 2px; text-align: left; }\r\n.Cell {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n.OutlineColumnHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px; text-align: center; }\r\n.OutlineRowHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px 8px 2px 2px; text-align: left; }\r\n.OutlineCell {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; background-color: #F8F8F8; font-weight: bold; }\r\n.Total {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n","tableHtml":"<table class=\"Table\">\n  <tr>\n    <th class=\"RowHeader\" rowspan=\"2\">&nbsp;<\/th>\n    <th class=\"ColumnHeader\" colspan=\"2\">DMU<\/th>\n    <th class=\"ColumnHeader\" colspan=\"2\">EMU<\/th>\n    <th class=\"ColumnHeader\" colspan=\"2\">HST<\/th>\n  <\/tr>\n  <tr>\n    <th class=\"ColumnHeader\">A<\/th>\n    <th class=\"ColumnHeader\">C<\/th>\n    <th class=\"ColumnHeader\">A<\/th>\n    <th class=\"ColumnHeader\">C<\/th>\n    <th class=\"ColumnHeader\">A<\/th>\n    <th class=\"ColumnHeader\">C<\/th>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Arriva Trains Wales<\/th>\n    <td class=\"Cell\">3833<\/td>\n    <td class=\"Cell\">74<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\"><\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">CrossCountry<\/th>\n    <td class=\"Cell\">21621<\/td>\n    <td class=\"Cell\">548<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\">709<\/td>\n    <td class=\"Cell\">23<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">London Midland<\/th>\n    <td class=\"Cell\">11054<\/td>\n    <td class=\"Cell\">168<\/td>\n    <td class=\"Cell\">35930<\/td>\n    <td class=\"Cell\">1082<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\"><\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Virgin Trains<\/th>\n    <td class=\"Cell\">2028<\/td>\n    <td class=\"Cell\">107<\/td>\n    <td class=\"Cell\">6331<\/td>\n    <td class=\"Cell\">119<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\"><\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Total<\/th>\n    <td class=\"Total\">38536<\/td>\n    <td class=\"Total\">897<\/td>\n    <td class=\"Total\">42261<\/td>\n    <td class=\"Total\">1201<\/td>\n    <td class=\"Total\">709<\/td>\n    <td class=\"Total\">23<\/td>\n  <\/tr>\n<\/table>","settings":[]},"evals":[],"jsHooks":[]}</script><div class="sourceCode" id="cb20"><html><body><pre class="r"><span class="no">pt</span>$<span class="fu">asMatrix</span>()</pre></body></html></div>
<pre><code>     [,1]                  [,2]    [,3]  [,4]    [,5]   [,6]  [,7]
[1,] ""                    "DMU"   ""    "EMU"   ""     "HST" ""  
[2,] ""                    "A"     "C"   "A"     "C"    "A"   "C" 
[3,] "Arriva Trains Wales" "3833"  "74"  ""      ""     ""    ""  
[4,] "CrossCountry"        "21621" "548" ""      ""     "709" "23"
[5,] "London Midland"      "11054" "168" "35930" "1082" ""    ""  
[6,] "Virgin Trains"       "2028"  "107" "6331"  "119"  ""    ""  
[7,] "Total"               "38536" "897" "42261" "1201" "709" "23"</code></pre>
<p>However, the <code>repeatHeaders</code> parameter can be used to specify repeating headings:</p>
<div class="sourceCode" id="cb22"><html><body><pre class="r"><span class="no">pt</span>$<span class="fu">asMatrix</span>(<span class="kw">repeatHeaders</span><span class="kw">=</span><span class="fl">TRUE</span>)</pre></body></html></div>
<pre><code>     [,1]                  [,2]    [,3]  [,4]    [,5]   [,6]  [,7] 
[1,] ""                    "DMU"   "DMU" "EMU"   "EMU"  "HST" "HST"
[2,] ""                    "A"     "C"   "A"     "C"    "A"   "C"  
[3,] "Arriva Trains Wales" "3833"  "74"  ""      ""     ""    ""   
[4,] "CrossCountry"        "21621" "548" ""      ""     "709" "23" 
[5,] "London Midland"      "11054" "168" "35930" "1082" ""    ""   
[6,] "Virgin Trains"       "2028"  "107" "6331"  "119"  ""    ""   
[7,] "Total"               "38536" "897" "42261" "1201" "709" "23" </code></pre>
</div>
</div>
<div id="results-as-an-r-data-frame" class="section level2">
<h2 class="hasAnchor">
<a href="#results-as-an-r-data-frame" class="anchor"></a>Results as an R Data Frame</h2>
<p>Two different functions can be used to convert a pivot table to a data frame. The <code>asDataFrame()</code> function returns a data frame with a roughly similar layout to the pivot table, e.g. a pivot table with a body consisting of 10 rows and 2 columns will result in a data frame also containing 10 rows and 2 columns. The <code>asTidyDataFrame()</code> function returns a data frame consisting of one row for every cell in the body of the pivot table, e.g. a pivot table with a body consisting of 10 rows and 2 columns will result in a data frame containing 20 rows.</p>
<p>Examples of both functions are given below.</p>
<div id="the-asdataframe-function" class="section level3">
<h3 class="hasAnchor">
<a href="#the-asdataframe-function" class="anchor"></a>The <code>asDataFrame()</code> function</h3>
<p>The example pivot table converts as follows:</p>
<div class="sourceCode" id="cb24"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">pivottabler</span>)
<span class="no">pt</span> <span class="kw">&lt;-</span> <span class="no">PivotTable</span>$<span class="fu">new</span>()
<span class="no">pt</span>$<span class="fu">addData</span>(<span class="no">bhmtrains</span>)
<span class="no">pt</span>$<span class="fu">addColumnDataGroups</span>(<span class="st">"PowerType"</span>)
<span class="no">pt</span>$<span class="fu">addRowDataGroups</span>(<span class="st">"TOC"</span>)
<span class="no">pt</span>$<span class="fu">defineCalculation</span>(<span class="kw">calculationName</span><span class="kw">=</span><span class="st">"TotalTrains"</span>, <span class="kw">summariseExpression</span><span class="kw">=</span><span class="st">"n()"</span>)
<span class="no">pt</span>$<span class="fu">evaluatePivot</span>()
<span class="no">df</span> <span class="kw">&lt;-</span> <span class="no">pt</span>$<span class="fu">asDataFrame</span>()
<span class="no">df</span></pre></body></html></div>
<pre><code>                      DMU   EMU HST Total
Arriva Trains Wales  3909    NA  NA  3909
CrossCountry        22196    NA 732 22928
London Midland      11229 37050  NA 48279
Virgin Trains        2137  6457  NA  8594
Total               39471 43507 732 83710</code></pre>
<div class="sourceCode" id="cb26"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span>(<span class="no">df</span>)</pre></body></html></div>
<pre><code>'data.frame':   5 obs. of  4 variables:
 $ DMU  : int  3909 22196 11229 2137 39471
 $ EMU  : int  NA NA 37050 6457 43507
 $ HST  : int  NA 732 NA NA 732
 $ Total: int  3909 22928 48279 8594 83710</code></pre>
<p>Data frames can have at most one name for each row and column. Therefore, when there are multiple levels of headers in the pivot table, the captions are concatenated into a single value for each row and column:</p>
<div class="sourceCode" id="cb28"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">pivottabler</span>)
<span class="no">pt</span> <span class="kw">&lt;-</span> <span class="no">PivotTable</span>$<span class="fu">new</span>()
<span class="no">pt</span>$<span class="fu">addData</span>(<span class="no">bhmtrains</span>)
<span class="no">pt</span>$<span class="fu">addColumnDataGroups</span>(<span class="st">"TrainCategory"</span>)
<span class="no">pt</span>$<span class="fu">addColumnDataGroups</span>(<span class="st">"PowerType"</span>)
<span class="no">pt</span>$<span class="fu">addRowDataGroups</span>(<span class="st">"TOC"</span>)
<span class="no">pt</span>$<span class="fu">defineCalculation</span>(<span class="kw">calculationName</span><span class="kw">=</span><span class="st">"TotalTrains"</span>, <span class="kw">summariseExpression</span><span class="kw">=</span><span class="st">"n()"</span>)
<span class="no">pt</span>$<span class="fu">evaluatePivot</span>()
<span class="no">pt</span>$<span class="fu">asDataFrame</span>()</pre></body></html></div>
<pre><code>                    Express Passenger DMU Express Passenger EMU
Arriva Trains Wales                  3079                    NA
CrossCountry                        22133                    NA
London Midland                       5638                  8849
Virgin Trains                        2137                  6457
Total                               32987                 15306
                    Express Passenger HST Express Passenger Total
Arriva Trains Wales                    NA                    3079
CrossCountry                          732                   22865
London Midland                         NA                   14487
Virgin Trains                          NA                    8594
Total                                 732                   49025
                    Ordinary Passenger DMU Ordinary Passenger EMU
Arriva Trains Wales                    830                     NA
CrossCountry                            63                     NA
London Midland                        5591                  28201
Virgin Trains                           NA                     NA
Total                                 6484                  28201
                    Ordinary Passenger Total Total 
Arriva Trains Wales                      830   3909
CrossCountry                              63  22928
London Midland                         33792  48279
Virgin Trains                             NA   8594
Total                                  34685  83710</code></pre>
<p>The space character is the default character used to combine headers as seen above. This can easily be changed, e.g. to a pipe character:</p>
<div class="sourceCode" id="cb30"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">pivottabler</span>)
<span class="no">pt</span> <span class="kw">&lt;-</span> <span class="no">PivotTable</span>$<span class="fu">new</span>()
<span class="no">pt</span>$<span class="fu">addData</span>(<span class="no">bhmtrains</span>)
<span class="no">pt</span>$<span class="fu">addColumnDataGroups</span>(<span class="st">"TrainCategory"</span>)
<span class="no">pt</span>$<span class="fu">addColumnDataGroups</span>(<span class="st">"PowerType"</span>)
<span class="no">pt</span>$<span class="fu">addRowDataGroups</span>(<span class="st">"TOC"</span>)
<span class="no">pt</span>$<span class="fu">defineCalculation</span>(<span class="kw">calculationName</span><span class="kw">=</span><span class="st">"TotalTrains"</span>, <span class="kw">summariseExpression</span><span class="kw">=</span><span class="st">"n()"</span>)
<span class="no">pt</span>$<span class="fu">evaluatePivot</span>()
<span class="no">pt</span>$<span class="fu">asDataFrame</span>(<span class="kw">separator</span><span class="kw">=</span><span class="st">"|"</span>)</pre></body></html></div>
<pre><code>                    Express Passenger|DMU Express Passenger|EMU
Arriva Trains Wales                  3079                    NA
CrossCountry                        22133                    NA
London Midland                       5638                  8849
Virgin Trains                        2137                  6457
Total                               32987                 15306
                    Express Passenger|HST Express Passenger|Total
Arriva Trains Wales                    NA                    3079
CrossCountry                          732                   22865
London Midland                         NA                   14487
Virgin Trains                          NA                    8594
Total                                 732                   49025
                    Ordinary Passenger|DMU Ordinary Passenger|EMU
Arriva Trains Wales                    830                     NA
CrossCountry                            63                     NA
London Midland                        5591                  28201
Virgin Trains                           NA                     NA
Total                                 6484                  28201
                    Ordinary Passenger|Total Total|
Arriva Trains Wales                      830   3909
CrossCountry                              63  22928
London Midland                         33792  48279
Virgin Trains                             NA   8594
Total                                  34685  83710</code></pre>
<p>In addition, the row group headings can be exported as separate columns:</p>
<div class="sourceCode" id="cb32"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">pivottabler</span>)
<span class="no">pt</span> <span class="kw">&lt;-</span> <span class="no">PivotTable</span>$<span class="fu">new</span>()
<span class="no">pt</span>$<span class="fu">addData</span>(<span class="no">bhmtrains</span>)
<span class="no">pt</span>$<span class="fu">addColumnDataGroups</span>(<span class="st">"TrainCategory"</span>)
<span class="no">pt</span>$<span class="fu">addRowDataGroups</span>(<span class="st">"TOC"</span>)
<span class="no">pt</span>$<span class="fu">addRowDataGroups</span>(<span class="st">"PowerType"</span>)
<span class="no">pt</span>$<span class="fu">defineCalculation</span>(<span class="kw">calculationName</span><span class="kw">=</span><span class="st">"TotalTrains"</span>, <span class="kw">summariseExpression</span><span class="kw">=</span><span class="st">"n()"</span>)
<span class="no">pt</span>$<span class="fu">evaluatePivot</span>()
<span class="no">pt</span>$<span class="fu">asDataFrame</span>(<span class="kw">rowGroupsAsColumns</span><span class="kw">=</span><span class="fl">TRUE</span>)</pre></body></html></div>
<pre><code>                                          TOC PowerType Express Passenger
Arriva Trains Wales DMU   Arriva Trains Wales       DMU              3079
Arriva Trains Wales Total Arriva Trains Wales     Total              3079
CrossCountry DMU                 CrossCountry       DMU             22133
CrossCountry HST                 CrossCountry       HST               732
CrossCountry Total               CrossCountry     Total             22865
London Midland DMU             London Midland       DMU              5638
London Midland EMU             London Midland       EMU              8849
London Midland Total           London Midland     Total             14487
Virgin Trains DMU               Virgin Trains       DMU              2137
Virgin Trains EMU               Virgin Trains       EMU              6457
Virgin Trains Total             Virgin Trains     Total              8594
Total                                   Total                       49025
                          Ordinary Passenger Total
Arriva Trains Wales DMU                  830  3909
Arriva Trains Wales Total                830  3909
CrossCountry DMU                          63 22196
CrossCountry HST                          NA   732
CrossCountry Total                        63 22928
London Midland DMU                      5591 11229
London Midland EMU                     28201 37050
London Midland Total                   33792 48279
Virgin Trains DMU                         NA  2137
Virgin Trains EMU                         NA  6457
Virgin Trains Total                       NA  8594
Total                                  34685 83710</code></pre>
</div>
<div id="the-astidydataframe-function" class="section level3">
<h3 class="hasAnchor">
<a href="#the-astidydataframe-function" class="anchor"></a>The <code>asTidyDataFrame()</code> function</h3>
<p>The example pivot table converts as follows:</p>
<div class="sourceCode" id="cb34"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">pivottabler</span>)
<span class="no">pt</span> <span class="kw">&lt;-</span> <span class="no">PivotTable</span>$<span class="fu">new</span>()
<span class="no">pt</span>$<span class="fu">addData</span>(<span class="no">bhmtrains</span>)
<span class="no">pt</span>$<span class="fu">addColumnDataGroups</span>(<span class="st">"PowerType"</span>)
<span class="no">pt</span>$<span class="fu">addRowDataGroups</span>(<span class="st">"TOC"</span>)
<span class="no">pt</span>$<span class="fu">defineCalculation</span>(<span class="kw">calculationName</span><span class="kw">=</span><span class="st">"TotalTrains"</span>, <span class="kw">summariseExpression</span><span class="kw">=</span><span class="st">"n()"</span>)
<span class="no">pt</span>$<span class="fu">evaluatePivot</span>()
<span class="no">pt</span>$<span class="fu">asDataFrame</span>()</pre></body></html></div>
<pre><code>                      DMU   EMU HST Total
Arriva Trains Wales  3909    NA  NA  3909
CrossCountry        22196    NA 732 22928
London Midland      11229 37050  NA 48279
Virgin Trains        2137  6457  NA  8594
Total               39471 43507 732 83710</code></pre>
<div class="sourceCode" id="cb36"><html><body><pre class="r"><span class="no">df</span> <span class="kw">&lt;-</span> <span class="no">pt</span>$<span class="fu">asTidyDataFrame</span>()
<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span>(<span class="no">df</span>)</pre></body></html></div>
<pre><code>'data.frame':   20 obs. of  11 variables:
 $ rowNumber           : int  1 1 1 1 2 2 2 2 3 3 ...
 $ columnNumber        : int  1 2 3 4 1 2 3 4 1 2 ...
 $ isTotal             : logi  FALSE FALSE FALSE TRUE FALSE FALSE ...
 $ RowLevel01          : chr  "Arriva Trains Wales" "Arriva Trains Wales" "Arriva Trains Wales" "Arriva Trains Wales" ...
 $ ColumnLevel01       : chr  "DMU" "EMU" "HST" "Total" ...
 $ TOC                 : chr  "Arriva Trains Wales" "Arriva Trains Wales" "Arriva Trains Wales" "Arriva Trains Wales" ...
 $ PowerType           : chr  "DMU" "EMU" "HST" "NA" ...
 $ calculationName     : chr  "TotalTrains" "TotalTrains" "TotalTrains" "TotalTrains" ...
 $ calculationGroupName: chr  "default" "default" "default" "default" ...
 $ rawValue            : int  3909 NA NA 3909 22196 NA 732 22928 11229 37050 ...
 $ formattedValue      : chr  "3909" NA NA "3909" ...</code></pre>
<div class="sourceCode" id="cb38"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="no">df</span>)</pre></body></html></div>
<pre><code>  rowNumber columnNumber isTotal          RowLevel01 ColumnLevel01
1         1            1   FALSE Arriva Trains Wales           DMU
2         1            2   FALSE Arriva Trains Wales           EMU
3         1            3   FALSE Arriva Trains Wales           HST
4         1            4    TRUE Arriva Trains Wales         Total
5         2            1   FALSE        CrossCountry           DMU
6         2            2   FALSE        CrossCountry           EMU
                  TOC PowerType calculationName calculationGroupName rawValue
1 Arriva Trains Wales       DMU     TotalTrains              default     3909
2 Arriva Trains Wales       EMU     TotalTrains              default       NA
3 Arriva Trains Wales       HST     TotalTrains              default       NA
4 Arriva Trains Wales        NA     TotalTrains              default     3909
5        CrossCountry       DMU     TotalTrains              default    22196
6        CrossCountry       EMU     TotalTrains              default       NA
  formattedValue
1           3909
2           &lt;NA&gt;
3           &lt;NA&gt;
4           3909
5          22196
6           &lt;NA&gt;</code></pre>
<p>By default the generated pivot table contains columns for both the captions of the data groups and the variables/values that the data groups represent. Each of these sets of columns can be removed from the data frame by setting <code>includeGroupCaptions=FALSE</code> or <code>includeGroupValues=FALSE</code> respectively.</p>
<p>Where a data group represents multiple values, those values are concatenated and returned in a single column in the data frame. Again, the separator between the values can be changed, e.g. by specifying <code>separator="|"</code>.</p>
</div>
</div>
<div id="results-as-a-basictabler-table" class="section level2">
<h2 class="hasAnchor">
<a href="#results-as-a-basictabler-table" class="anchor"></a>Results as a basictabler Table</h2>
<p>The <code>asBasicTable()</code> function allows a pivot table to be converted to a basic table - from the <code>basictabler</code> package.</p>
<p>The <code>basictabler</code> package allows free-form tables to be constructed, in contrast to <code>pivottabler</code> which creates pivot tables with relatively fixed structures. <code>pivottabler</code> contains calculation logic - to calculate the values of cells within the pivot table. <code>basictabler</code> contains no calculation logic - cell values must be provided either from a data frame, row-by-row, column-by-column or cell-by-cell.</p>
<p>Converting a pivot table to a basic table allows the structure of pivot tables to be altered after they have been created, e.g.</p>
<div class="sourceCode" id="cb40"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">pivottabler</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">dplyr</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">lubridate</span>)
<span class="no">trains</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="no">bhmtrains</span>,
                 <span class="kw">GbttDate</span><span class="kw">=</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html">if_else</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span>(<span class="no">GbttArrival</span>), <span class="no">GbttDeparture</span>, <span class="no">GbttArrival</span>),
                 <span class="kw">GbttMonth</span><span class="kw">=</span><span class="fu"><a href="http://lubridate.tidyverse.org/reference/make_datetime.html">make_date</a></span>(<span class="kw">year</span><span class="kw">=</span><span class="fu"><a href="http://lubridate.tidyverse.org/reference/year.html">year</a></span>(<span class="no">GbttDate</span>), <span class="kw">month</span><span class="kw">=</span><span class="fu"><a href="http://lubridate.tidyverse.org/reference/month.html">month</a></span>(<span class="no">GbttDate</span>), <span class="kw">day</span><span class="kw">=</span><span class="fl">1</span>))

<span class="no">pt</span> <span class="kw">&lt;-</span> <span class="no">PivotTable</span>$<span class="fu">new</span>()
<span class="no">pt</span>$<span class="fu">addData</span>(<span class="no">trains</span>)
<span class="no">pt</span>$<span class="fu">addColumnDataGroups</span>(<span class="st">"GbttMonth"</span>, <span class="kw">dataFormat</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">format</span><span class="kw">=</span><span class="st">"%B %Y"</span>))
<span class="no">pt</span>$<span class="fu">addColumnDataGroups</span>(<span class="st">"PowerType"</span>)
<span class="no">pt</span>$<span class="fu">addRowDataGroups</span>(<span class="st">"TOC"</span>)
<span class="no">pt</span>$<span class="fu">defineCalculation</span>(<span class="kw">calculationName</span><span class="kw">=</span><span class="st">"TotalTrains"</span>, <span class="kw">summariseExpression</span><span class="kw">=</span><span class="st">"n()"</span>)
<span class="no">pt</span>$<span class="fu">evaluatePivot</span>()

<span class="co"># convert the pivot table to a basic table, insert a new row, merge cells and highlight</span>
<span class="no">bt</span> <span class="kw">&lt;-</span> <span class="no">pt</span>$<span class="fu">asBasicTable</span>()
<span class="no">bt</span>$<span class="no">cells</span>$<span class="fu">insertRow</span>(<span class="fl">5</span>)
<span class="no">bt</span>$<span class="no">cells</span>$<span class="fu">setCell</span>(<span class="fl">5</span>, <span class="fl">2</span>, <span class="kw">rawValue</span><span class="kw">=</span><span class="st">"The values below are significantly higher than expected."</span>,
                 <span class="kw">styleDeclarations</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">"text-align"</span><span class="kw">=</span><span class="st">"left"</span>, <span class="st">"background-color"</span><span class="kw">=</span><span class="st">"yellow"</span>,
                                        <span class="st">"font-weight"</span><span class="kw">=</span><span class="st">"bold"</span>, <span class="st">"font-style"</span><span class="kw">=</span><span class="st">"italic"</span>))
<span class="no">bt</span>$<span class="fu">mergeCells</span>(<span class="kw">rFrom</span><span class="kw">=</span><span class="fl">5</span>, <span class="kw">cFrom</span><span class="kw">=</span><span class="fl">2</span>, <span class="kw">rSpan</span><span class="kw">=</span><span class="fl">1</span>, <span class="kw">cSpan</span><span class="kw">=</span><span class="fl">13</span>)
<span class="no">bt</span>$<span class="fu">setStyling</span>(<span class="kw">rFrom</span><span class="kw">=</span><span class="fl">6</span>, <span class="kw">cFrom</span><span class="kw">=</span><span class="fl">2</span>, <span class="kw">rTo</span><span class="kw">=</span><span class="fl">6</span>, <span class="kw">cTo</span><span class="kw">=</span><span class="fl">14</span>,
              <span class="kw">declarations</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">"text-align"</span><span class="kw">=</span><span class="st">"left"</span>, <span class="st">"background-color"</span><span class="kw">=</span><span class="st">"yellow"</span>))
<span class="no">bt</span>$<span class="fu">renderTable</span>()</pre></body></html></div>
<div id="htmlwidget-e8262e5819b231bd4ceb" style="width:auto;height:auto;" class="basictabler html-widget"></div>
<script type="application/json" data-for="htmlwidget-e8262e5819b231bd4ceb">{"x":{"tableCss":".Table {display: table; border-collapse: collapse; }\r\n.ColumnHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px; text-align: center; }\r\n.RowHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px 8px 2px 2px; text-align: left; }\r\n.Cell {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n.OutlineColumnHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px; text-align: center; }\r\n.OutlineRowHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px 8px 2px 2px; text-align: left; }\r\n.OutlineCell {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; background-color: #F8F8F8; font-weight: bold; }\r\n.Total {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n","tableHtml":"<table class=\"Table\">\n  <tr>\n    <th rowspan=\"2\" class=\"RowHeader\">&nbsp;<\/th>\n    <th colspan=\"4\" class=\"ColumnHeader\">December 2016<\/th>\n    <th colspan=\"4\" class=\"ColumnHeader\">January 2017<\/th>\n    <th colspan=\"4\" class=\"ColumnHeader\">February 2017<\/th>\n    <th class=\"ColumnHeader\">Total<\/th>\n  <\/tr>\n  <tr>\n    <th class=\"ColumnHeader\">DMU<\/th>\n    <th class=\"ColumnHeader\">EMU<\/th>\n    <th class=\"ColumnHeader\">HST<\/th>\n    <th class=\"ColumnHeader\">Total<\/th>\n    <th class=\"ColumnHeader\">DMU<\/th>\n    <th class=\"ColumnHeader\">EMU<\/th>\n    <th class=\"ColumnHeader\">HST<\/th>\n    <th class=\"ColumnHeader\">Total<\/th>\n    <th class=\"ColumnHeader\">DMU<\/th>\n    <th class=\"ColumnHeader\">EMU<\/th>\n    <th class=\"ColumnHeader\">HST<\/th>\n    <th class=\"ColumnHeader\">Total<\/th>\n    <th class=\"ColumnHeader\"><\/th>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Arriva Trains Wales<\/th>\n    <td class=\"Cell\">1291<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">1291<\/td>\n    <td class=\"Cell\">1402<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">1402<\/td>\n    <td class=\"Cell\">1216<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">1216<\/td>\n    <td class=\"Total\">3909<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">CrossCountry<\/th>\n    <td class=\"Cell\">7314<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\">236<\/td>\n    <td class=\"Total\">7550<\/td>\n    <td class=\"Cell\">7777<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\">256<\/td>\n    <td class=\"Total\">8033<\/td>\n    <td class=\"Cell\">7105<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\">240<\/td>\n    <td class=\"Total\">7345<\/td>\n    <td class=\"Total\">22928<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\"><\/th>\n    <td colspan=\"13\" class=\"Cell\" style=\"text-align: left; background-color: yellow; font-weight: bold; font-style: italic; \">The values below are significantly higher than expected.<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">London Midland<\/th>\n    <td class=\"Cell\" style=\"text-align: left; background-color: yellow; \">3635<\/td>\n    <td class=\"Cell\" style=\"text-align: left; background-color: yellow; \">11967<\/td>\n    <td class=\"Cell\" style=\"text-align: left; background-color: yellow; \"><\/td>\n    <td class=\"Total\" style=\"text-align: left; background-color: yellow; \">15602<\/td>\n    <td class=\"Cell\" style=\"text-align: left; background-color: yellow; \">3967<\/td>\n    <td class=\"Cell\" style=\"text-align: left; background-color: yellow; \">13062<\/td>\n    <td class=\"Cell\" style=\"text-align: left; background-color: yellow; \"><\/td>\n    <td class=\"Total\" style=\"text-align: left; background-color: yellow; \">17029<\/td>\n    <td class=\"Cell\" style=\"text-align: left; background-color: yellow; \">3627<\/td>\n    <td class=\"Cell\" style=\"text-align: left; background-color: yellow; \">12021<\/td>\n    <td class=\"Cell\" style=\"text-align: left; background-color: yellow; \"><\/td>\n    <td class=\"Total\" style=\"text-align: left; background-color: yellow; \">15648<\/td>\n    <td class=\"Total\" style=\"text-align: left; background-color: yellow; \">48279<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Virgin Trains<\/th>\n    <td class=\"Cell\">740<\/td>\n    <td class=\"Cell\">2137<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">2877<\/td>\n    <td class=\"Cell\">728<\/td>\n    <td class=\"Cell\">2276<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">3004<\/td>\n    <td class=\"Cell\">669<\/td>\n    <td class=\"Cell\">2044<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">2713<\/td>\n    <td class=\"Total\">8594<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Total<\/th>\n    <td class=\"Total\">12980<\/td>\n    <td class=\"Total\">14104<\/td>\n    <td class=\"Total\">236<\/td>\n    <td class=\"Total\">27320<\/td>\n    <td class=\"Total\">13874<\/td>\n    <td class=\"Total\">15338<\/td>\n    <td class=\"Total\">256<\/td>\n    <td class=\"Total\">29468<\/td>\n    <td class=\"Total\">12617<\/td>\n    <td class=\"Total\">14065<\/td>\n    <td class=\"Total\">240<\/td>\n    <td class=\"Total\">26922<\/td>\n    <td class=\"Total\">83710<\/td>\n  <\/tr>\n<\/table>","settings":[]},"evals":[],"jsHooks":[]}</script>
</div>
<div id="further-reading" class="section level2">
<h2 class="hasAnchor">
<a href="#further-reading" class="anchor"></a>Further Reading</h2>
<p>The full set of vignettes is:</p>
<ol style="list-style-type: decimal">
<li><a href="v01-introduction.html">Introduction</a></li>
<li><a href="v02-datagroups.html">Data Groups</a></li>
<li><a href="v03-calculations.html">Calculations</a></li>
<li><a href="v04-regularlayout.html">Regular Layout</a></li>
<li><a href="v05-outputs.html">Outputs</a></li>
<li><a href="v06-latexoutput.html">Latex Output</a></li>
<li><a href="v07-styling.html">Styling</a></li>
<li><a href="v08-findingandformatting.html">Finding and Formatting</a></li>
<li><a href="v09-cellcontext.html">Cell Context</a></li>
<li><a href="v10-navigatingapivottable.html">Navigating a Pivot Table</a></li>
<li><a href="v11-irregularlayout.html">Irregular Layout</a></li>
<li><a href="v12-performance.html">Performance</a></li>
<li><a href="v13-excelexport.html">Excel Export</a></li>
<li><a href="v14-shiny.html">Shiny</a></li>
<li><a href="vA1-appendix.html">Appendix: Details</a></li>
<li><a href="vA2-appendix.html">Appendix: Calculations</a></li>
<li><a href="vA3-appendix.html">Appendix: Class Overview</a></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Christopher Bailiss.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    
    
    apiKey: '16a61fa9a8811ff537cd1a528040a9e1',
    indexName: 'pivottabler',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>
</body>
</html>
