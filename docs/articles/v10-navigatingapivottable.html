<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>10. Navigating a Pivot Table • pivottabler</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.3/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous">
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><meta property="og:title" content="10. Navigating a Pivot Table">
<meta property="og:description" content="pivottabler">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-64707587-2"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-64707587-2');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">pivottabler</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.4.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/cbailiss/pivottabler/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
<form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
</div>
      </form>
      
    </div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="v10-navigatingapivottable_files/htmlwidgets-1.5.1/htmlwidgets.js"></script><script src="v10-navigatingapivottable_files/pivottabler-binding-1.4.0/pivottabler.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>10. Navigating a Pivot Table</h1>
                        <h4 class="author">Chris Bailiss</h4>
            
            <h4 class="date">2020-05-12</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/cbailiss/pivottabler/blob/master/vignettes/v10-navigatingapivottable.Rmd"><code>vignettes/v10-navigatingapivottable.Rmd</code></a></small>
      <div class="hidden name"><code>v10-navigatingapivottable.Rmd</code></div>

    </div>

    
    
<div id="in-this-vignette" class="section level2">
<h2 class="hasAnchor">
<a href="#in-this-vignette" class="anchor"></a>In This Vignette</h2>
<ul>
<li>High Level Methods vs. Low Level Methods</li>
<li>Navigating Data Groups</li>
<li>Navigating Cells</li>
<li>Navigating between data groups and rows / columns / cells</li>
</ul>
</div>
<div id="high-level-methods-vs--low-level-methods" class="section level2">
<h2 class="hasAnchor">
<a href="#high-level-methods-vs--low-level-methods" class="anchor"></a>High Level Methods vs. Low Level Methods</h2>
<p>Most of the previous vignettes have utilised “high-level” methods to relatively quickly build a pivot table with a minimum of code and without having to worry about low-level structures and layout. Such high-level methods include:</p>
<ul>
<li>
<code><a href="../reference/qpvt.html">qpvt()</a></code>, <code><a href="../reference/qhpvt.html">qhpvt()</a></code> and <code><a href="../reference/qlpvt.html">qlpvt()</a></code> to build and output an entire pivot table in a single function call.</li>
<li>
<code>pt$addColumnDataGroups()</code> and <code>pt$addRowDataGroups()</code> - to add multiple column/row data groups in a single method call.</li>
<li>
<code>pt$evaluatePivot()</code> - to execute all of the following if they have not yet been executed:
<ul>
<li>
<code>pt$normaliseColumnGroups()</code> - to ensure all of the column data groups have the same depth.</li>
<li>
<code>pt$normaliseRowGroups()</code> - to ensure all of the row data groups have the same depth.</li>
<li>
<code>pt$generateCellStructure()</code> - to generate the (uncalculated) cells.</li>
<li>
<code>pt$evaluateCells()</code> - to calculate the cells.</li>
</ul>
</li>
<li>
<code>pt$renderPivot()</code>- to execute <code>pt$evaluatePivot()</code> if not already executed and then output the pivot table as an htmlwidget.</li>
<li>
<code>pt$findColumnDataGroups()</code> and <code>pt$findRowDataGroups()</code> to select data groups matching specific criteria in a single method call.</li>
<li>
<code>pt$getCells()</code> and <code>pt$findCells()</code> to select cells matching specific criteria in a single method call.</li>
</ul>
<p>All of the above methods serve to make creating or navigating a pivot table quicker and easier in most circumstances.</p>
<p>Sometimes however, a more unusual or complex pivot table needs creating or more granular navigation of the pivot table structures is needed. The <code>pivottabler</code> package includes a set of lower-level methods to create and navigate a pivot table. Using these methods provides more flexibility but also requires more effort and more lines of code than using the high-level methods above.</p>
<p>This vignette describes the set of low-level methods for navigating a pivot table.</p>
<p>The <a href="v11-irregularlayout.html">Irregular Layout</a> vignette describes the low-level methods for creating a pivot table.</p>
</div>
<div id="navigating-data-groups" class="section level2">
<h2 class="hasAnchor">
<a href="#navigating-data-groups" class="anchor"></a>Navigating Data Groups</h2>
<div id="example-pivot-table" class="section level3">
<h3 class="hasAnchor">
<a href="#example-pivot-table" class="anchor"></a>Example Pivot Table</h3>
<p>The following pivot table will be used as the basis of the examples in this section:</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">pivottabler</span>)
<span class="no">createPivot1</span> <span class="kw">&lt;-</span> <span class="kw">function</span>() {
  <span class="no">pt</span> <span class="kw">&lt;-</span> <span class="no">PivotTable</span>$<span class="fu">new</span>()
  <span class="no">pt</span>$<span class="fu">addData</span>(<span class="no">bhmtrains</span>)
  <span class="no">pt</span>$<span class="fu">addColumnDataGroups</span>(<span class="st">"TrainCategory"</span>)
  <span class="no">pt</span>$<span class="fu">addColumnDataGroups</span>(<span class="st">"PowerType"</span>)
  <span class="no">pt</span>$<span class="fu">addRowDataGroups</span>(<span class="st">"TOC"</span>)
  <span class="no">pt</span>$<span class="fu">defineCalculation</span>(<span class="kw">calculationName</span><span class="kw">=</span><span class="st">"TotalTrains"</span>, <span class="kw">summariseExpression</span><span class="kw">=</span><span class="st">"n()"</span>)
  <span class="fu"><a href="https://rdrr.io/r/base/function.html">return</a></span>(<span class="no">pt</span>)
}
<span class="no">pt</span> <span class="kw">&lt;-</span> <span class="fu">createPivot1</span>()
<span class="no">pt</span>$<span class="fu">renderPivot</span>()</pre></body></html></div>
<div id="htmlwidget-f20f2e3feb6ebc568df6" style="width:auto;height:auto;" class="pivottabler html-widget"></div>
<script type="application/json" data-for="htmlwidget-f20f2e3feb6ebc568df6">{"x":{"tableCss":".Table {display: table; border-collapse: collapse; }\r\n.ColumnHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px; text-align: center; }\r\n.RowHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px 8px 2px 2px; text-align: left; }\r\n.Cell {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n.OutlineColumnHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px; text-align: center; }\r\n.OutlineRowHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px 8px 2px 2px; text-align: left; }\r\n.OutlineCell {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; background-color: #F8F8F8; font-weight: bold; }\r\n.Total {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n","tableHtml":"<table class=\"Table\">\n  <tr>\n    <th class=\"RowHeader\" rowspan=\"2\">&nbsp;<\/th>\n    <th class=\"ColumnHeader\" colspan=\"4\">Express Passenger<\/th>\n    <th class=\"ColumnHeader\" colspan=\"3\">Ordinary Passenger<\/th>\n    <th class=\"ColumnHeader\">Total<\/th>\n  <\/tr>\n  <tr>\n    <th class=\"ColumnHeader\">DMU<\/th>\n    <th class=\"ColumnHeader\">EMU<\/th>\n    <th class=\"ColumnHeader\">HST<\/th>\n    <th class=\"ColumnHeader\">Total<\/th>\n    <th class=\"ColumnHeader\">DMU<\/th>\n    <th class=\"ColumnHeader\">EMU<\/th>\n    <th class=\"ColumnHeader\">Total<\/th>\n    <th class=\"ColumnHeader\">&nbsp;<\/th>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Arriva Trains Wales<\/th>\n    <td class=\"Cell\">3079<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">3079<\/td>\n    <td class=\"Cell\">830<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">830<\/td>\n    <td class=\"Total\">3909<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">CrossCountry<\/th>\n    <td class=\"Cell\">22133<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\">732<\/td>\n    <td class=\"Total\">22865<\/td>\n    <td class=\"Cell\">63<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">63<\/td>\n    <td class=\"Total\">22928<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">London Midland<\/th>\n    <td class=\"Cell\">5638<\/td>\n    <td class=\"Cell\">8849<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">14487<\/td>\n    <td class=\"Cell\">5591<\/td>\n    <td class=\"Cell\">28201<\/td>\n    <td class=\"Total\">33792<\/td>\n    <td class=\"Total\">48279<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Virgin Trains<\/th>\n    <td class=\"Cell\">2137<\/td>\n    <td class=\"Cell\">6457<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">8594<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\"><\/td>\n    <td class=\"Total\">8594<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Total<\/th>\n    <td class=\"Total\">32987<\/td>\n    <td class=\"Total\">15306<\/td>\n    <td class=\"Total\">732<\/td>\n    <td class=\"Total\">49025<\/td>\n    <td class=\"Total\">6484<\/td>\n    <td class=\"Total\">28201<\/td>\n    <td class=\"Total\">34685<\/td>\n    <td class=\"Total\">83710<\/td>\n  <\/tr>\n<\/table>","settings":[]},"evals":[],"jsHooks":[]}</script>
</div>
<div id="data-group-class" class="section level3">
<h3 class="hasAnchor">
<a href="#data-group-class" class="anchor"></a>Data Group Class</h3>
<p>Each data group is an instance of the <code>PivotDataGroup</code> class. See the <a href="vA3-appendix.html">Class Overview</a> appendix for details.</p>
</div>
<div id="data-group-hierarchy" class="section level3">
<h3 class="hasAnchor">
<a href="#data-group-hierarchy" class="anchor"></a>Data Group Hierarchy</h3>
<p>Two sets of data groups exist in a pivot table - one on each axis, i.e. on rows and on columns. Each set of data groups exists in a hierarchy. Each hierarchy starts with a single hidden root data group on each axis.</p>
<p>For example, considering the hierarchy of data groups on the rows axis and columns axis:</p>
<div class="figure">
<img src="data-group-hierarchy1.png" alt="Rows Data Group Hierarchy"><p class="caption">Rows Data Group Hierarchy</p>
</div>
<div class="figure">
<img src="data-group-hierarchy2.png" alt="Columns Data Group Hierarchy"><p class="caption">Columns Data Group Hierarchy</p>
</div>
<p>The hidden root data groups are normally rarely explicitly used, though we will use them in some examples in this vignette. They can be accessed using <code>pt$columnGroup</code> and <code>pt$rowGroup</code>.</p>
</div>
<div id="data-group-parents-and-children" class="section level3">
<h3 class="hasAnchor">
<a href="#data-group-parents-and-children" class="anchor"></a>Data Group Parents and Children</h3>
<p>Every data group can have a set of child data groups. Use <code>childGroupCount</code> to count the child groups:</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="no">pt</span>$<span class="no">rowGroup</span>$<span class="no">childGroupCount</span></pre></body></html></div>
<pre><code>## [1] 5</code></pre>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="no">pt</span>$<span class="no">columnGroup</span>$<span class="no">childGroupCount</span></pre></body></html></div>
<pre><code>## [1] 3</code></pre>
<p>The child groups are accessed via the <code>childGroups</code> property, which returns an R list containing the data groups directly below this group in the hierarchy.</p>
<p>Every data group, except the hidden root data group on each axis, will have a parent data group, accessed via the <code>parentGroup</code> property.</p>
<p>Retrieving the caption of the first visible row group:</p>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="no">pt</span>$<span class="no">rowGroup</span>$<span class="no">childGroups</span><span class="kw">[[</span><span class="fl">1</span>]]$<span class="no">caption</span></pre></body></html></div>
<pre><code>## [1] "Arriva Trains Wales"</code></pre>
<p>Retrieving the caption and child count of the second visible column group:</p>
<div class="sourceCode" id="cb8"><html><body><pre class="r"><span class="no">pt</span>$<span class="no">columnGroup</span>$<span class="no">childGroups</span><span class="kw">[[</span><span class="fl">2</span>]]$<span class="no">caption</span></pre></body></html></div>
<pre><code>## [1] "Ordinary Passenger"</code></pre>
<div class="sourceCode" id="cb10"><html><body><pre class="r"><span class="no">pt</span>$<span class="no">columnGroup</span>$<span class="no">childGroups</span><span class="kw">[[</span><span class="fl">2</span>]]$<span class="no">childGroupCount</span></pre></body></html></div>
<pre><code>## [1] 3</code></pre>
<p>Retrieving the first child of this group:</p>
<div class="sourceCode" id="cb12"><html><body><pre class="r"><span class="no">pt</span>$<span class="no">columnGroup</span>$<span class="no">childGroups</span><span class="kw">[[</span><span class="fl">2</span>]]$<span class="no">childGroups</span><span class="kw">[[</span><span class="fl">1</span>]]$<span class="no">caption</span></pre></body></html></div>
<pre><code>## [1] "DMU"</code></pre>
<p>Highlighting these three data groups:</p>
<div class="sourceCode" id="cb14"><html><body><pre class="r"><span class="no">pt</span> <span class="kw">&lt;-</span> <span class="fu">createPivot1</span>()
<span class="no">pt</span>$<span class="fu">setStyling</span>(<span class="kw">groups</span><span class="kw">=</span><span class="no">pt</span>$<span class="no">rowGroup</span>$<span class="no">childGroups</span><span class="kw">[[</span><span class="fl">1</span>]], <span class="kw">declarations</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">"background-color"</span><span class="kw">=</span><span class="st">"yellow"</span>))
<span class="no">pt</span>$<span class="fu">setStyling</span>(<span class="kw">groups</span><span class="kw">=</span><span class="no">pt</span>$<span class="no">columnGroup</span>$<span class="no">childGroups</span><span class="kw">[[</span><span class="fl">2</span>]], <span class="kw">declarations</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">"background-color"</span><span class="kw">=</span><span class="st">"cyan"</span>))
<span class="no">pt</span>$<span class="fu">setStyling</span>(<span class="kw">groups</span><span class="kw">=</span><span class="no">pt</span>$<span class="no">columnGroup</span>$<span class="no">childGroups</span><span class="kw">[[</span><span class="fl">2</span>]]$<span class="no">childGroups</span><span class="kw">[[</span><span class="fl">1</span>]],
              <span class="kw">declarations</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">"background-color"</span><span class="kw">=</span><span class="st">"lawngreen"</span>))
<span class="no">pt</span>$<span class="fu">renderPivot</span>()</pre></body></html></div>
<div id="htmlwidget-dfd205c2949dddfc2cc1" style="width:auto;height:auto;" class="pivottabler html-widget"></div>
<script type="application/json" data-for="htmlwidget-dfd205c2949dddfc2cc1">{"x":{"tableCss":".Table {display: table; border-collapse: collapse; }\r\n.ColumnHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px; text-align: center; }\r\n.RowHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px 8px 2px 2px; text-align: left; }\r\n.Cell {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n.OutlineColumnHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px; text-align: center; }\r\n.OutlineRowHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px 8px 2px 2px; text-align: left; }\r\n.OutlineCell {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; background-color: #F8F8F8; font-weight: bold; }\r\n.Total {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n","tableHtml":"<table class=\"Table\">\n  <tr>\n    <th class=\"RowHeader\" rowspan=\"2\">&nbsp;<\/th>\n    <th class=\"ColumnHeader\" colspan=\"4\">Express Passenger<\/th>\n    <th class=\"ColumnHeader\" style=\"background-color: cyan; \" colspan=\"3\">Ordinary Passenger<\/th>\n    <th class=\"ColumnHeader\">Total<\/th>\n  <\/tr>\n  <tr>\n    <th class=\"ColumnHeader\">DMU<\/th>\n    <th class=\"ColumnHeader\">EMU<\/th>\n    <th class=\"ColumnHeader\">HST<\/th>\n    <th class=\"ColumnHeader\">Total<\/th>\n    <th class=\"ColumnHeader\" style=\"background-color: lawngreen; \">DMU<\/th>\n    <th class=\"ColumnHeader\">EMU<\/th>\n    <th class=\"ColumnHeader\">Total<\/th>\n    <th class=\"ColumnHeader\">&nbsp;<\/th>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\" style=\"background-color: yellow; \">Arriva Trains Wales<\/th>\n    <td class=\"Cell\">3079<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">3079<\/td>\n    <td class=\"Cell\">830<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">830<\/td>\n    <td class=\"Total\">3909<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">CrossCountry<\/th>\n    <td class=\"Cell\">22133<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\">732<\/td>\n    <td class=\"Total\">22865<\/td>\n    <td class=\"Cell\">63<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">63<\/td>\n    <td class=\"Total\">22928<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">London Midland<\/th>\n    <td class=\"Cell\">5638<\/td>\n    <td class=\"Cell\">8849<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">14487<\/td>\n    <td class=\"Cell\">5591<\/td>\n    <td class=\"Cell\">28201<\/td>\n    <td class=\"Total\">33792<\/td>\n    <td class=\"Total\">48279<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Virgin Trains<\/th>\n    <td class=\"Cell\">2137<\/td>\n    <td class=\"Cell\">6457<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">8594<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\"><\/td>\n    <td class=\"Total\">8594<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Total<\/th>\n    <td class=\"Total\">32987<\/td>\n    <td class=\"Total\">15306<\/td>\n    <td class=\"Total\">732<\/td>\n    <td class=\"Total\">49025<\/td>\n    <td class=\"Total\">6484<\/td>\n    <td class=\"Total\">28201<\/td>\n    <td class=\"Total\">34685<\/td>\n    <td class=\"Total\">83710<\/td>\n  <\/tr>\n<\/table>","settings":[]},"evals":[],"jsHooks":[]}</script><p>We can even navigate down and back up the hierarchy:</p>
<div class="sourceCode" id="cb15"><html><body><pre class="r"><span class="no">pt</span>$<span class="no">columnGroup</span>$<span class="no">childGroups</span><span class="kw">[[</span><span class="fl">2</span>]]$<span class="no">childGroups</span><span class="kw">[[</span><span class="fl">1</span>]]$<span class="no">parentGroup</span>$<span class="no">caption</span></pre></body></html></div>
<pre><code>## [1] "Ordinary Passenger"</code></pre>
</div>
<div id="data-group-levels" class="section level3">
<h3 class="hasAnchor">
<a href="#data-group-levels" class="anchor"></a>Data Group Levels</h3>
<p>The first level of visible data groups is referred to as level 1, the second level as level 2, etc. Another way of referring to the levels is “top-level”, which refers to level 1 and “leaf-level” which refers to the bottom level, which has the highest level number.</p>
<p>The level number of an individual data group can be retrieved using the levelNumber <code>property</code>.</p>
<div class="sourceCode" id="cb17"><html><body><pre class="r"><span class="no">pt</span>$<span class="no">rowGroup</span>$<span class="no">childGroups</span><span class="kw">[[</span><span class="fl">1</span>]]$<span class="no">levelNumber</span></pre></body></html></div>
<pre><code>## [1] 1</code></pre>
<div class="sourceCode" id="cb19"><html><body><pre class="r"><span class="no">pt</span>$<span class="no">columnGroup</span>$<span class="no">childGroups</span><span class="kw">[[</span><span class="fl">2</span>]]$<span class="no">childGroups</span><span class="kw">[[</span><span class="fl">1</span>]]$<span class="no">levelNumber</span></pre></body></html></div>
<pre><code>## [1] 2</code></pre>
<p>To count the number of levels of groups use <code>pt$rowGroupLevelCount</code> or <code>pt$columnGroupLevelCount</code>:</p>
<div class="sourceCode" id="cb21"><html><body><pre class="r"><span class="no">pt</span>$<span class="no">rowGroupLevelCount</span></pre></body></html></div>
<pre><code>## [1] 1</code></pre>
<div class="sourceCode" id="cb23"><html><body><pre class="r"><span class="no">pt</span>$<span class="no">columnGroupLevelCount</span></pre></body></html></div>
<pre><code>## [1] 2</code></pre>
<p>To get the row groups at a particular level use <code>pt$getRowGroupsByLevel()</code>:</p>
<div class="sourceCode" id="cb25"><html><body><pre class="r"><span class="no">grps</span> <span class="kw">&lt;-</span> <span class="no">pt</span>$<span class="fu">getRowGroupsByLevel</span>(<span class="fl">1</span>)
<span class="no">fx</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">x</span>) { <span class="no">x</span>$<span class="no">caption</span> }
<span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span>(<span class="no">grps</span>, <span class="no">fx</span>)</pre></body></html></div>
<pre><code>## [1] "Arriva Trains Wales" "CrossCountry"        "London Midland"     
## [4] "Virgin Trains"       "Total"</code></pre>
<p>Similarly, to get the column groups at a particular level use <code>pt$getColumnGroupsByLevel()</code>:</p>
<div class="sourceCode" id="cb27"><html><body><pre class="r"><span class="no">grps</span> <span class="kw">&lt;-</span> <span class="no">pt</span>$<span class="fu">getColumnGroupsByLevel</span>(<span class="fl">2</span>)
<span class="no">fx</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">x</span>) { <span class="no">x</span>$<span class="no">caption</span> }
<span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span>(<span class="no">grps</span>, <span class="no">fx</span>)</pre></body></html></div>
<pre><code>## [1] "DMU"   "EMU"   "HST"   "Total" "DMU"   "EMU"   "Total" ""</code></pre>
</div>
<div id="top-level-groups" class="section level3">
<h3 class="hasAnchor">
<a href="#top-level-groups" class="anchor"></a>Top Level Groups</h3>
<p>In the examples above, <code>pt$rowGroup$childGroups</code> was used to retrieve the top-level row groups, and <code>pt$columnGroup$childGroups</code> was used to retrieve the top-level column groups. An easier way to retrieve these groups is <code>pt$topRowGroups</code> and <code>pt$topColumnGroups</code>:</p>
<div class="sourceCode" id="cb29"><html><body><pre class="r"><span class="no">fx</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">x</span>) { <span class="no">x</span>$<span class="no">caption</span> }
<span class="no">grps</span> <span class="kw">&lt;-</span> <span class="no">pt</span>$<span class="no">topRowGroups</span>
<span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span>(<span class="no">grps</span>, <span class="no">fx</span>)</pre></body></html></div>
<pre><code>## [1] "Arriva Trains Wales" "CrossCountry"        "London Midland"     
## [4] "Virgin Trains"       "Total"</code></pre>
<div class="sourceCode" id="cb31"><html><body><pre class="r"><span class="no">grps</span> <span class="kw">&lt;-</span> <span class="no">pt</span>$<span class="no">topColumnGroups</span>
<span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span>(<span class="no">grps</span>, <span class="no">fx</span>)</pre></body></html></div>
<pre><code>## [1] "Express Passenger"  "Ordinary Passenger" "Total"</code></pre>
</div>
<div id="ancestors-descendants-and-leaves" class="section level3">
<h3 class="hasAnchor">
<a href="#ancestors-descendants-and-leaves" class="anchor"></a>Ancestors, Descendants and Leaves</h3>
<div id="example-pivot-table-1" class="section level4">
<h4 class="hasAnchor">
<a href="#example-pivot-table-1" class="anchor"></a>Example Pivot Table</h4>
<p>The following pivot table will be used in the next few examples:</p>
<div class="sourceCode" id="cb33"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">dplyr</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">pivottabler</span>)
<span class="no">createPivot2</span> <span class="kw">&lt;-</span> <span class="kw">function</span>() {
  <span class="no">trains</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="no">bhmtrains</span>, (<span class="no">TOC</span><span class="kw">==</span><span class="st">"CrossCountry"</span>)<span class="kw">|</span>(<span class="no">TOC</span><span class="kw">==</span><span class="st">"Virgin Trains"</span>))
  <span class="no">pt</span> <span class="kw">&lt;-</span> <span class="no">PivotTable</span>$<span class="fu">new</span>()
  <span class="no">pt</span>$<span class="fu">addData</span>(<span class="no">trains</span>)
  <span class="no">pt</span>$<span class="fu">addRowDataGroups</span>(<span class="st">"TOC"</span>)
  <span class="no">pt</span>$<span class="fu">addRowDataGroups</span>(<span class="st">"TrainCategory"</span>, <span class="kw">addTotal</span><span class="kw">=</span><span class="fl">FALSE</span>)
  <span class="no">pt</span>$<span class="fu">addRowDataGroups</span>(<span class="st">"PowerType"</span>, <span class="kw">addTotal</span><span class="kw">=</span><span class="fl">FALSE</span>)
  <span class="no">pt</span>$<span class="fu">defineCalculation</span>(<span class="kw">calculationName</span><span class="kw">=</span><span class="st">"Train Count"</span>, <span class="kw">summariseExpression</span><span class="kw">=</span><span class="st">"n()"</span>)
  <span class="fu"><a href="https://rdrr.io/r/base/function.html">return</a></span>(<span class="no">pt</span>)
}
<span class="no">pt</span> <span class="kw">&lt;-</span> <span class="fu">createPivot2</span>()
<span class="no">pt</span>$<span class="fu">renderPivot</span>()</pre></body></html></div>
<div id="htmlwidget-10f10b82784572850717" style="width:auto;height:auto;" class="pivottabler html-widget"></div>
<script type="application/json" data-for="htmlwidget-10f10b82784572850717">{"x":{"tableCss":".Table {display: table; border-collapse: collapse; }\r\n.ColumnHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px; text-align: center; }\r\n.RowHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px 8px 2px 2px; text-align: left; }\r\n.Cell {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n.OutlineColumnHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px; text-align: center; }\r\n.OutlineRowHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px 8px 2px 2px; text-align: left; }\r\n.OutlineCell {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; background-color: #F8F8F8; font-weight: bold; }\r\n.Total {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n","tableHtml":"<table class=\"Table\">\n  <tr>\n    <th class=\"RowHeader\" colspan=\"3\">&nbsp;<\/th>\n    <th class=\"ColumnHeader\">Train Count<\/th>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\" rowspan=\"3\">CrossCountry<\/th>\n    <th class=\"RowHeader\" rowspan=\"2\">Express Passenger<\/th>\n    <th class=\"RowHeader\">DMU<\/th>\n    <td class=\"Cell\">22133<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">HST<\/th>\n    <td class=\"Cell\">732<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Ordinary Passenger<\/th>\n    <th class=\"RowHeader\">DMU<\/th>\n    <td class=\"Cell\">63<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\" rowspan=\"2\">Virgin Trains<\/th>\n    <th class=\"RowHeader\" rowspan=\"2\">Express Passenger<\/th>\n    <th class=\"RowHeader\">DMU<\/th>\n    <td class=\"Cell\">2137<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">EMU<\/th>\n    <td class=\"Cell\">6457<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Total<\/th>\n    <th class=\"RowHeader\">&nbsp;<\/th>\n    <th class=\"RowHeader\">&nbsp;<\/th>\n    <td class=\"Total\">31522<\/td>\n  <\/tr>\n<\/table>","settings":[]},"evals":[],"jsHooks":[]}</script>
</div>
<div id="ancestors" class="section level4">
<h4 class="hasAnchor">
<a href="#ancestors" class="anchor"></a>Ancestors</h4>
<p>Consider the “HST” data group:</p>
<div class="sourceCode" id="cb34"><html><body><pre class="r"><span class="no">pt</span> <span class="kw">&lt;-</span> <span class="fu">createPivot2</span>()
<span class="no">grp</span> <span class="kw">&lt;-</span> <span class="no">pt</span>$<span class="no">topRowGroups</span><span class="kw">[[</span><span class="fl">1</span>]]$<span class="no">childGroups</span><span class="kw">[[</span><span class="fl">1</span>]]$<span class="no">childGroups</span><span class="kw">[[</span><span class="fl">2</span>]]
<span class="no">pt</span>$<span class="fu">setStyling</span>(<span class="kw">groups</span><span class="kw">=</span><span class="no">grp</span>, <span class="kw">declarations</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">"background-color"</span><span class="kw">=</span><span class="st">"yellow"</span>))
<span class="no">pt</span>$<span class="fu">renderPivot</span>()</pre></body></html></div>
<div id="htmlwidget-fd96dddf98bbbf9a99c9" style="width:auto;height:auto;" class="pivottabler html-widget"></div>
<script type="application/json" data-for="htmlwidget-fd96dddf98bbbf9a99c9">{"x":{"tableCss":".Table {display: table; border-collapse: collapse; }\r\n.ColumnHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px; text-align: center; }\r\n.RowHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px 8px 2px 2px; text-align: left; }\r\n.Cell {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n.OutlineColumnHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px; text-align: center; }\r\n.OutlineRowHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px 8px 2px 2px; text-align: left; }\r\n.OutlineCell {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; background-color: #F8F8F8; font-weight: bold; }\r\n.Total {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n","tableHtml":"<table class=\"Table\">\n  <tr>\n    <th class=\"RowHeader\" colspan=\"3\">&nbsp;<\/th>\n    <th class=\"ColumnHeader\">Train Count<\/th>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\" rowspan=\"3\">CrossCountry<\/th>\n    <th class=\"RowHeader\" rowspan=\"2\">Express Passenger<\/th>\n    <th class=\"RowHeader\">DMU<\/th>\n    <td class=\"Cell\">22133<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\" style=\"background-color: yellow; \">HST<\/th>\n    <td class=\"Cell\">732<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Ordinary Passenger<\/th>\n    <th class=\"RowHeader\">DMU<\/th>\n    <td class=\"Cell\">63<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\" rowspan=\"2\">Virgin Trains<\/th>\n    <th class=\"RowHeader\" rowspan=\"2\">Express Passenger<\/th>\n    <th class=\"RowHeader\">DMU<\/th>\n    <td class=\"Cell\">2137<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">EMU<\/th>\n    <td class=\"Cell\">6457<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Total<\/th>\n    <th class=\"RowHeader\">&nbsp;<\/th>\n    <th class=\"RowHeader\">&nbsp;<\/th>\n    <td class=\"Total\">31522<\/td>\n  <\/tr>\n<\/table>","settings":[]},"evals":[],"jsHooks":[]}</script><p>The ancestors of this group are the groups above it in the hierarchy, i.e. parent group, grandparent group, etc. The ancestors can be retrieved using <code>getAncestorGroups()</code> which returns a list of data groups:</p>
<div class="sourceCode" id="cb35"><html><body><pre class="r"><span class="no">pt</span> <span class="kw">&lt;-</span> <span class="fu">createPivot2</span>()
<span class="no">grp</span> <span class="kw">&lt;-</span> <span class="no">pt</span>$<span class="no">topRowGroups</span><span class="kw">[[</span><span class="fl">1</span>]]$<span class="no">childGroups</span><span class="kw">[[</span><span class="fl">1</span>]]$<span class="no">childGroups</span><span class="kw">[[</span><span class="fl">2</span>]]
<span class="no">pt</span>$<span class="fu">setStyling</span>(<span class="kw">groups</span><span class="kw">=</span><span class="no">grp</span>, <span class="kw">declarations</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">"background-color"</span><span class="kw">=</span><span class="st">"yellow"</span>))
<span class="no">ancestors</span> <span class="kw">&lt;-</span> <span class="no">grp</span>$<span class="fu">getAncestorGroups</span>()
<span class="no">pt</span>$<span class="fu">setStyling</span>(<span class="kw">groups</span><span class="kw">=</span><span class="no">ancestors</span><span class="kw">[[</span><span class="fl">1</span>]], <span class="kw">declarations</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">"background-color"</span><span class="kw">=</span><span class="st">"cyan"</span>))
<span class="no">pt</span>$<span class="fu">setStyling</span>(<span class="kw">groups</span><span class="kw">=</span><span class="no">ancestors</span><span class="kw">[[</span><span class="fl">2</span>]], <span class="kw">declarations</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">"background-color"</span><span class="kw">=</span><span class="st">"lawngreen"</span>))
<span class="no">pt</span>$<span class="fu">renderPivot</span>()</pre></body></html></div>
<div id="htmlwidget-b5e9fbca53fc1f780583" style="width:auto;height:auto;" class="pivottabler html-widget"></div>
<script type="application/json" data-for="htmlwidget-b5e9fbca53fc1f780583">{"x":{"tableCss":".Table {display: table; border-collapse: collapse; }\r\n.ColumnHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px; text-align: center; }\r\n.RowHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px 8px 2px 2px; text-align: left; }\r\n.Cell {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n.OutlineColumnHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px; text-align: center; }\r\n.OutlineRowHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px 8px 2px 2px; text-align: left; }\r\n.OutlineCell {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; background-color: #F8F8F8; font-weight: bold; }\r\n.Total {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n","tableHtml":"<table class=\"Table\">\n  <tr>\n    <th class=\"RowHeader\" colspan=\"3\">&nbsp;<\/th>\n    <th class=\"ColumnHeader\">Train Count<\/th>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\" style=\"background-color: lawngreen; \" rowspan=\"3\">CrossCountry<\/th>\n    <th class=\"RowHeader\" style=\"background-color: cyan; \" rowspan=\"2\">Express Passenger<\/th>\n    <th class=\"RowHeader\">DMU<\/th>\n    <td class=\"Cell\">22133<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\" style=\"background-color: yellow; \">HST<\/th>\n    <td class=\"Cell\">732<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Ordinary Passenger<\/th>\n    <th class=\"RowHeader\">DMU<\/th>\n    <td class=\"Cell\">63<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\" rowspan=\"2\">Virgin Trains<\/th>\n    <th class=\"RowHeader\" rowspan=\"2\">Express Passenger<\/th>\n    <th class=\"RowHeader\">DMU<\/th>\n    <td class=\"Cell\">2137<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">EMU<\/th>\n    <td class=\"Cell\">6457<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Total<\/th>\n    <th class=\"RowHeader\">&nbsp;<\/th>\n    <th class=\"RowHeader\">&nbsp;<\/th>\n    <td class=\"Total\">31522<\/td>\n  <\/tr>\n<\/table>","settings":[]},"evals":[],"jsHooks":[]}</script>
</div>
<div id="descendants" class="section level4">
<h4 class="hasAnchor">
<a href="#descendants" class="anchor"></a>Descendants</h4>
<p>Consider the “CrossCountry” data group:</p>
<div class="sourceCode" id="cb36"><html><body><pre class="r"><span class="no">pt</span> <span class="kw">&lt;-</span> <span class="fu">createPivot2</span>()
<span class="no">grp</span> <span class="kw">&lt;-</span> <span class="no">pt</span>$<span class="no">topRowGroups</span><span class="kw">[[</span><span class="fl">1</span>]]
<span class="no">pt</span>$<span class="fu">setStyling</span>(<span class="kw">groups</span><span class="kw">=</span><span class="no">grp</span>, <span class="kw">declarations</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">"background-color"</span><span class="kw">=</span><span class="st">"yellow"</span>))
<span class="no">pt</span>$<span class="fu">renderPivot</span>()</pre></body></html></div>
<div id="htmlwidget-2955f93d30068f063d3a" style="width:auto;height:auto;" class="pivottabler html-widget"></div>
<script type="application/json" data-for="htmlwidget-2955f93d30068f063d3a">{"x":{"tableCss":".Table {display: table; border-collapse: collapse; }\r\n.ColumnHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px; text-align: center; }\r\n.RowHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px 8px 2px 2px; text-align: left; }\r\n.Cell {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n.OutlineColumnHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px; text-align: center; }\r\n.OutlineRowHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px 8px 2px 2px; text-align: left; }\r\n.OutlineCell {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; background-color: #F8F8F8; font-weight: bold; }\r\n.Total {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n","tableHtml":"<table class=\"Table\">\n  <tr>\n    <th class=\"RowHeader\" colspan=\"3\">&nbsp;<\/th>\n    <th class=\"ColumnHeader\">Train Count<\/th>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\" style=\"background-color: yellow; \" rowspan=\"3\">CrossCountry<\/th>\n    <th class=\"RowHeader\" rowspan=\"2\">Express Passenger<\/th>\n    <th class=\"RowHeader\">DMU<\/th>\n    <td class=\"Cell\">22133<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">HST<\/th>\n    <td class=\"Cell\">732<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Ordinary Passenger<\/th>\n    <th class=\"RowHeader\">DMU<\/th>\n    <td class=\"Cell\">63<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\" rowspan=\"2\">Virgin Trains<\/th>\n    <th class=\"RowHeader\" rowspan=\"2\">Express Passenger<\/th>\n    <th class=\"RowHeader\">DMU<\/th>\n    <td class=\"Cell\">2137<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">EMU<\/th>\n    <td class=\"Cell\">6457<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Total<\/th>\n    <th class=\"RowHeader\">&nbsp;<\/th>\n    <th class=\"RowHeader\">&nbsp;<\/th>\n    <td class=\"Total\">31522<\/td>\n  <\/tr>\n<\/table>","settings":[]},"evals":[],"jsHooks":[]}</script><p>The descendants of this group are all of the groups below it in the hierarchy, i.e. children, grandchildren, etc. The descendants can be retrieved using <code>getDescendantGroups()</code> which also returns a list of data groups:</p>
<div class="sourceCode" id="cb37"><html><body><pre class="r"><span class="no">pt</span> <span class="kw">&lt;-</span> <span class="fu">createPivot2</span>()
<span class="no">grp</span> <span class="kw">&lt;-</span> <span class="no">pt</span>$<span class="no">topRowGroups</span><span class="kw">[[</span><span class="fl">1</span>]]
<span class="no">pt</span>$<span class="fu">setStyling</span>(<span class="kw">groups</span><span class="kw">=</span><span class="no">grp</span>, <span class="kw">declarations</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">"background-color"</span><span class="kw">=</span><span class="st">"yellow"</span>))
<span class="no">descendants</span> <span class="kw">&lt;-</span> <span class="no">grp</span>$<span class="fu">getDescendantGroups</span>()
<span class="no">pt</span>$<span class="fu">setStyling</span>(<span class="kw">groups</span><span class="kw">=</span><span class="no">descendants</span>, <span class="kw">declarations</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">"background-color"</span><span class="kw">=</span><span class="st">"cyan"</span>))
<span class="no">pt</span>$<span class="fu">renderPivot</span>()</pre></body></html></div>
<div id="htmlwidget-1754eda6a6cb2442e71d" style="width:auto;height:auto;" class="pivottabler html-widget"></div>
<script type="application/json" data-for="htmlwidget-1754eda6a6cb2442e71d">{"x":{"tableCss":".Table {display: table; border-collapse: collapse; }\r\n.ColumnHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px; text-align: center; }\r\n.RowHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px 8px 2px 2px; text-align: left; }\r\n.Cell {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n.OutlineColumnHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px; text-align: center; }\r\n.OutlineRowHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px 8px 2px 2px; text-align: left; }\r\n.OutlineCell {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; background-color: #F8F8F8; font-weight: bold; }\r\n.Total {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n","tableHtml":"<table class=\"Table\">\n  <tr>\n    <th class=\"RowHeader\" colspan=\"3\">&nbsp;<\/th>\n    <th class=\"ColumnHeader\">Train Count<\/th>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\" style=\"background-color: yellow; \" rowspan=\"3\">CrossCountry<\/th>\n    <th class=\"RowHeader\" style=\"background-color: cyan; \" rowspan=\"2\">Express Passenger<\/th>\n    <th class=\"RowHeader\" style=\"background-color: cyan; \">DMU<\/th>\n    <td class=\"Cell\">22133<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\" style=\"background-color: cyan; \">HST<\/th>\n    <td class=\"Cell\">732<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\" style=\"background-color: cyan; \">Ordinary Passenger<\/th>\n    <th class=\"RowHeader\" style=\"background-color: cyan; \">DMU<\/th>\n    <td class=\"Cell\">63<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\" rowspan=\"2\">Virgin Trains<\/th>\n    <th class=\"RowHeader\" rowspan=\"2\">Express Passenger<\/th>\n    <th class=\"RowHeader\">DMU<\/th>\n    <td class=\"Cell\">2137<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">EMU<\/th>\n    <td class=\"Cell\">6457<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Total<\/th>\n    <th class=\"RowHeader\">&nbsp;<\/th>\n    <th class=\"RowHeader\">&nbsp;<\/th>\n    <td class=\"Total\">31522<\/td>\n  <\/tr>\n<\/table>","settings":[]},"evals":[],"jsHooks":[]}</script>
</div>
<div id="leaves" class="section level4">
<h4 class="hasAnchor">
<a href="#leaves" class="anchor"></a>Leaves</h4>
<p>The “leaves” of the “CrossCountry” group are all of the groups below it at the lowest level in the hierarchy. The “leaves” can be retrieved using <code>getLeafGroups()</code> which also returns a list of data groups:</p>
<div class="sourceCode" id="cb38"><html><body><pre class="r"><span class="no">pt</span> <span class="kw">&lt;-</span> <span class="fu">createPivot2</span>()
<span class="no">grp</span> <span class="kw">&lt;-</span> <span class="no">pt</span>$<span class="no">topRowGroups</span><span class="kw">[[</span><span class="fl">1</span>]]
<span class="no">pt</span>$<span class="fu">setStyling</span>(<span class="kw">groups</span><span class="kw">=</span><span class="no">grp</span>, <span class="kw">declarations</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">"background-color"</span><span class="kw">=</span><span class="st">"yellow"</span>))
<span class="no">descendants</span> <span class="kw">&lt;-</span> <span class="no">grp</span>$<span class="fu">getLeafGroups</span>()
<span class="no">pt</span>$<span class="fu">setStyling</span>(<span class="kw">groups</span><span class="kw">=</span><span class="no">descendants</span>, <span class="kw">declarations</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">"background-color"</span><span class="kw">=</span><span class="st">"cyan"</span>))
<span class="no">pt</span>$<span class="fu">renderPivot</span>()</pre></body></html></div>
<div id="htmlwidget-7c51fe22f16ab2e82176" style="width:auto;height:auto;" class="pivottabler html-widget"></div>
<script type="application/json" data-for="htmlwidget-7c51fe22f16ab2e82176">{"x":{"tableCss":".Table {display: table; border-collapse: collapse; }\r\n.ColumnHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px; text-align: center; }\r\n.RowHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px 8px 2px 2px; text-align: left; }\r\n.Cell {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n.OutlineColumnHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px; text-align: center; }\r\n.OutlineRowHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px 8px 2px 2px; text-align: left; }\r\n.OutlineCell {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; background-color: #F8F8F8; font-weight: bold; }\r\n.Total {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n","tableHtml":"<table class=\"Table\">\n  <tr>\n    <th class=\"RowHeader\" colspan=\"3\">&nbsp;<\/th>\n    <th class=\"ColumnHeader\">Train Count<\/th>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\" style=\"background-color: yellow; \" rowspan=\"3\">CrossCountry<\/th>\n    <th class=\"RowHeader\" rowspan=\"2\">Express Passenger<\/th>\n    <th class=\"RowHeader\" style=\"background-color: cyan; \">DMU<\/th>\n    <td class=\"Cell\">22133<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\" style=\"background-color: cyan; \">HST<\/th>\n    <td class=\"Cell\">732<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Ordinary Passenger<\/th>\n    <th class=\"RowHeader\" style=\"background-color: cyan; \">DMU<\/th>\n    <td class=\"Cell\">63<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\" rowspan=\"2\">Virgin Trains<\/th>\n    <th class=\"RowHeader\" rowspan=\"2\">Express Passenger<\/th>\n    <th class=\"RowHeader\">DMU<\/th>\n    <td class=\"Cell\">2137<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">EMU<\/th>\n    <td class=\"Cell\">6457<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Total<\/th>\n    <th class=\"RowHeader\">&nbsp;<\/th>\n    <th class=\"RowHeader\">&nbsp;<\/th>\n    <td class=\"Total\">31522<\/td>\n  <\/tr>\n<\/table>","settings":[]},"evals":[],"jsHooks":[]}</script><p>It is also possible to retrieve all of the the leaf groups on either the rows or columns axes using <code>pt$leafRowGroups</code> or <code>pt$leafColumnGroups</code>:</p>
<div class="sourceCode" id="cb39"><html><body><pre class="r"><span class="no">pt</span> <span class="kw">&lt;-</span> <span class="fu">createPivot1</span>()
<span class="no">grps</span> <span class="kw">&lt;-</span> <span class="no">pt</span>$<span class="no">leafRowGroups</span>
<span class="no">pt</span>$<span class="fu">setStyling</span>(<span class="kw">groups</span><span class="kw">=</span><span class="no">grps</span>, <span class="kw">declarations</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">"background-color"</span><span class="kw">=</span><span class="st">"yellow"</span>))
<span class="no">grps</span> <span class="kw">&lt;-</span> <span class="no">pt</span>$<span class="no">leafColumnGroups</span>
<span class="no">pt</span>$<span class="fu">setStyling</span>(<span class="kw">groups</span><span class="kw">=</span><span class="no">grps</span>, <span class="kw">declarations</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">"background-color"</span><span class="kw">=</span><span class="st">"cyan"</span>))
<span class="no">pt</span>$<span class="fu">renderPivot</span>()</pre></body></html></div>
<div id="htmlwidget-c6eba1f1ceb4cb4fbe2b" style="width:auto;height:auto;" class="pivottabler html-widget"></div>
<script type="application/json" data-for="htmlwidget-c6eba1f1ceb4cb4fbe2b">{"x":{"tableCss":".Table {display: table; border-collapse: collapse; }\r\n.ColumnHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px; text-align: center; }\r\n.RowHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px 8px 2px 2px; text-align: left; }\r\n.Cell {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n.OutlineColumnHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px; text-align: center; }\r\n.OutlineRowHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px 8px 2px 2px; text-align: left; }\r\n.OutlineCell {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; background-color: #F8F8F8; font-weight: bold; }\r\n.Total {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n","tableHtml":"<table class=\"Table\">\n  <tr>\n    <th class=\"RowHeader\" rowspan=\"2\">&nbsp;<\/th>\n    <th class=\"ColumnHeader\" colspan=\"4\">Express Passenger<\/th>\n    <th class=\"ColumnHeader\" colspan=\"3\">Ordinary Passenger<\/th>\n    <th class=\"ColumnHeader\">Total<\/th>\n  <\/tr>\n  <tr>\n    <th class=\"ColumnHeader\" style=\"background-color: cyan; \">DMU<\/th>\n    <th class=\"ColumnHeader\" style=\"background-color: cyan; \">EMU<\/th>\n    <th class=\"ColumnHeader\" style=\"background-color: cyan; \">HST<\/th>\n    <th class=\"ColumnHeader\" style=\"background-color: cyan; \">Total<\/th>\n    <th class=\"ColumnHeader\" style=\"background-color: cyan; \">DMU<\/th>\n    <th class=\"ColumnHeader\" style=\"background-color: cyan; \">EMU<\/th>\n    <th class=\"ColumnHeader\" style=\"background-color: cyan; \">Total<\/th>\n    <th class=\"ColumnHeader\" style=\"background-color: cyan; \">&nbsp;<\/th>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\" style=\"background-color: yellow; \">Arriva Trains Wales<\/th>\n    <td class=\"Cell\">3079<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">3079<\/td>\n    <td class=\"Cell\">830<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">830<\/td>\n    <td class=\"Total\">3909<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\" style=\"background-color: yellow; \">CrossCountry<\/th>\n    <td class=\"Cell\">22133<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\">732<\/td>\n    <td class=\"Total\">22865<\/td>\n    <td class=\"Cell\">63<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">63<\/td>\n    <td class=\"Total\">22928<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\" style=\"background-color: yellow; \">London Midland<\/th>\n    <td class=\"Cell\">5638<\/td>\n    <td class=\"Cell\">8849<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">14487<\/td>\n    <td class=\"Cell\">5591<\/td>\n    <td class=\"Cell\">28201<\/td>\n    <td class=\"Total\">33792<\/td>\n    <td class=\"Total\">48279<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\" style=\"background-color: yellow; \">Virgin Trains<\/th>\n    <td class=\"Cell\">2137<\/td>\n    <td class=\"Cell\">6457<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">8594<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\"><\/td>\n    <td class=\"Total\">8594<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\" style=\"background-color: yellow; \">Total<\/th>\n    <td class=\"Total\">32987<\/td>\n    <td class=\"Total\">15306<\/td>\n    <td class=\"Total\">732<\/td>\n    <td class=\"Total\">49025<\/td>\n    <td class=\"Total\">6484<\/td>\n    <td class=\"Total\">28201<\/td>\n    <td class=\"Total\">34685<\/td>\n    <td class=\"Total\">83710<\/td>\n  <\/tr>\n<\/table>","settings":[]},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div id="all-groups-on-an-axis" class="section level3">
<h3 class="hasAnchor">
<a href="#all-groups-on-an-axis" class="anchor"></a>All groups on an axis</h3>
<p>All of the groups on either axis can be retrieved using <code>pt$allRowGroups</code> or <code>pt$allColumnGroups</code>:</p>
<div class="sourceCode" id="cb40"><html><body><pre class="r"><span class="no">pt</span> <span class="kw">&lt;-</span> <span class="fu">createPivot1</span>()
<span class="no">grps</span> <span class="kw">&lt;-</span> <span class="no">pt</span>$<span class="no">allRowGroups</span>
<span class="no">pt</span>$<span class="fu">setStyling</span>(<span class="kw">groups</span><span class="kw">=</span><span class="no">grps</span>, <span class="kw">declarations</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">"background-color"</span><span class="kw">=</span><span class="st">"yellow"</span>))
<span class="no">grps</span> <span class="kw">&lt;-</span> <span class="no">pt</span>$<span class="no">allColumnGroups</span>
<span class="no">pt</span>$<span class="fu">setStyling</span>(<span class="kw">groups</span><span class="kw">=</span><span class="no">grps</span>, <span class="kw">declarations</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">"background-color"</span><span class="kw">=</span><span class="st">"cyan"</span>))
<span class="no">pt</span>$<span class="fu">renderPivot</span>()</pre></body></html></div>
<div id="htmlwidget-064910741c179c7fde29" style="width:auto;height:auto;" class="pivottabler html-widget"></div>
<script type="application/json" data-for="htmlwidget-064910741c179c7fde29">{"x":{"tableCss":".Table {display: table; border-collapse: collapse; }\r\n.ColumnHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px; text-align: center; }\r\n.RowHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px 8px 2px 2px; text-align: left; }\r\n.Cell {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n.OutlineColumnHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px; text-align: center; }\r\n.OutlineRowHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px 8px 2px 2px; text-align: left; }\r\n.OutlineCell {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; background-color: #F8F8F8; font-weight: bold; }\r\n.Total {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n","tableHtml":"<table class=\"Table\">\n  <tr>\n    <th class=\"RowHeader\" rowspan=\"2\">&nbsp;<\/th>\n    <th class=\"ColumnHeader\" style=\"background-color: cyan; \" colspan=\"4\">Express Passenger<\/th>\n    <th class=\"ColumnHeader\" style=\"background-color: cyan; \" colspan=\"3\">Ordinary Passenger<\/th>\n    <th class=\"ColumnHeader\" style=\"background-color: cyan; \">Total<\/th>\n  <\/tr>\n  <tr>\n    <th class=\"ColumnHeader\" style=\"background-color: cyan; \">DMU<\/th>\n    <th class=\"ColumnHeader\" style=\"background-color: cyan; \">EMU<\/th>\n    <th class=\"ColumnHeader\" style=\"background-color: cyan; \">HST<\/th>\n    <th class=\"ColumnHeader\" style=\"background-color: cyan; \">Total<\/th>\n    <th class=\"ColumnHeader\" style=\"background-color: cyan; \">DMU<\/th>\n    <th class=\"ColumnHeader\" style=\"background-color: cyan; \">EMU<\/th>\n    <th class=\"ColumnHeader\" style=\"background-color: cyan; \">Total<\/th>\n    <th class=\"ColumnHeader\" style=\"background-color: cyan; \">&nbsp;<\/th>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\" style=\"background-color: yellow; \">Arriva Trains Wales<\/th>\n    <td class=\"Cell\">3079<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">3079<\/td>\n    <td class=\"Cell\">830<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">830<\/td>\n    <td class=\"Total\">3909<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\" style=\"background-color: yellow; \">CrossCountry<\/th>\n    <td class=\"Cell\">22133<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\">732<\/td>\n    <td class=\"Total\">22865<\/td>\n    <td class=\"Cell\">63<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">63<\/td>\n    <td class=\"Total\">22928<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\" style=\"background-color: yellow; \">London Midland<\/th>\n    <td class=\"Cell\">5638<\/td>\n    <td class=\"Cell\">8849<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">14487<\/td>\n    <td class=\"Cell\">5591<\/td>\n    <td class=\"Cell\">28201<\/td>\n    <td class=\"Total\">33792<\/td>\n    <td class=\"Total\">48279<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\" style=\"background-color: yellow; \">Virgin Trains<\/th>\n    <td class=\"Cell\">2137<\/td>\n    <td class=\"Cell\">6457<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">8594<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\"><\/td>\n    <td class=\"Total\">8594<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\" style=\"background-color: yellow; \">Total<\/th>\n    <td class=\"Total\">32987<\/td>\n    <td class=\"Total\">15306<\/td>\n    <td class=\"Total\">732<\/td>\n    <td class=\"Total\">49025<\/td>\n    <td class=\"Total\">6484<\/td>\n    <td class=\"Total\">28201<\/td>\n    <td class=\"Total\">34685<\/td>\n    <td class=\"Total\">83710<\/td>\n  <\/tr>\n<\/table>","settings":[]},"evals":[],"jsHooks":[]}</script><p>In the above pivot table there is only one level of row data groups so <code>pt$topRowGroups</code>, <code>pt$leafRowGroups</code> and <code>pt$allRowGroups</code> all return the same set of groups.</p>
</div>
<div id="outline-group-relationships" class="section level3">
<h3 class="hasAnchor">
<a href="#outline-group-relationships" class="anchor"></a>Outline group relationships</h3>
<p>Outline groups (see the <a href="v04-regularlayout.html">Regular Layout</a> vignette) are usually created in sets of two or three groups. For example, consider the following pivot table, where three rows are created for each train operating company (TOC):</p>
<div class="sourceCode" id="cb41"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">dplyr</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">pivottabler</span>)
<span class="no">createPivot3</span> <span class="kw">&lt;-</span> <span class="kw">function</span>() {
  <span class="no">trains</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="no">bhmtrains</span>, (<span class="no">TOC</span><span class="kw">==</span><span class="st">"CrossCountry"</span>)<span class="kw">|</span>(<span class="no">TOC</span><span class="kw">==</span><span class="st">"Virgin Trains"</span>))
  <span class="no">pt</span> <span class="kw">&lt;-</span> <span class="no">PivotTable</span>$<span class="fu">new</span>()
  <span class="no">pt</span>$<span class="fu">addData</span>(<span class="no">trains</span>)
  <span class="no">pt</span>$<span class="fu">addRowDataGroups</span>(<span class="st">"TOC"</span>, <span class="kw">outlineBefore</span><span class="kw">=</span><span class="fl">TRUE</span>,
          <span class="kw">outlineAfter</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">isEmpty</span><span class="kw">=</span><span class="fl">FALSE</span>, <span class="kw">caption</span><span class="kw">=</span><span class="st">"{value} Total"</span>,
                            <span class="kw">groupStyleDeclarations</span> <span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">"font-style"</span><span class="kw">=</span><span class="st">"italic"</span>)),
          <span class="kw">outlineTotal</span><span class="kw">=</span><span class="fl">TRUE</span>)
  <span class="no">pt</span>$<span class="fu">addRowDataGroups</span>(<span class="st">"TrainCategory"</span>, <span class="kw">addTotal</span><span class="kw">=</span><span class="fl">FALSE</span>)
  <span class="no">pt</span>$<span class="fu">addRowDataGroups</span>(<span class="st">"PowerType"</span>, <span class="kw">addTotal</span><span class="kw">=</span><span class="fl">FALSE</span>)
  <span class="no">pt</span>$<span class="fu">defineCalculation</span>(<span class="kw">calculationName</span><span class="kw">=</span><span class="st">"Train Count"</span>, <span class="kw">summariseExpression</span><span class="kw">=</span><span class="st">"n()"</span>)
  <span class="fu"><a href="https://rdrr.io/r/base/function.html">return</a></span>(<span class="no">pt</span>)
}
<span class="no">pt</span> <span class="kw">&lt;-</span> <span class="fu">createPivot3</span>()
<span class="no">pt</span>$<span class="fu">renderPivot</span>()</pre></body></html></div>
<div id="htmlwidget-f01dfc7e922a23b66243" style="width:auto;height:auto;" class="pivottabler html-widget"></div>
<script type="application/json" data-for="htmlwidget-f01dfc7e922a23b66243">{"x":{"tableCss":".Table {display: table; border-collapse: collapse; }\r\n.ColumnHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px; text-align: center; }\r\n.RowHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px 8px 2px 2px; text-align: left; }\r\n.Cell {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n.OutlineColumnHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px; text-align: center; }\r\n.OutlineRowHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px 8px 2px 2px; text-align: left; }\r\n.OutlineCell {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; background-color: #F8F8F8; font-weight: bold; }\r\n.Total {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n","tableHtml":"<table class=\"Table\">\n  <tr>\n    <th class=\"RowHeader\" colspan=\"3\">&nbsp;<\/th>\n    <th class=\"ColumnHeader\">Train Count<\/th>\n  <\/tr>\n  <tr>\n    <th class=\"OutlineRowHeader\" colspan=\"3\">CrossCountry<\/th>\n    <td class=\"OutlineCell\"><\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\" rowspan=\"3\">&nbsp;<\/th>\n    <th class=\"RowHeader\" rowspan=\"2\">Express Passenger<\/th>\n    <th class=\"RowHeader\">DMU<\/th>\n    <td class=\"Cell\">22133<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">HST<\/th>\n    <td class=\"Cell\">732<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Ordinary Passenger<\/th>\n    <th class=\"RowHeader\">DMU<\/th>\n    <td class=\"Cell\">63<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"OutlineRowHeader\" style=\"font-style: italic; \" colspan=\"3\">CrossCountry Total<\/th>\n    <td class=\"OutlineCell\">22928<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"OutlineRowHeader\" colspan=\"3\">Virgin Trains<\/th>\n    <td class=\"OutlineCell\"><\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\" rowspan=\"2\">&nbsp;<\/th>\n    <th class=\"RowHeader\" rowspan=\"2\">Express Passenger<\/th>\n    <th class=\"RowHeader\">DMU<\/th>\n    <td class=\"Cell\">2137<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">EMU<\/th>\n    <td class=\"Cell\">6457<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"OutlineRowHeader\" style=\"font-style: italic; \" colspan=\"3\">Virgin Trains Total<\/th>\n    <td class=\"OutlineCell\">8594<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"OutlineRowHeader\" colspan=\"3\">Total<\/th>\n    <td class=\"OutlineCell\">31522<\/td>\n  <\/tr>\n<\/table>","settings":[]},"evals":[],"jsHooks":[]}</script><p>Consider the “CrossCountry” TOC group:</p>
<div class="sourceCode" id="cb42"><html><body><pre class="r"><span class="no">pt</span> <span class="kw">&lt;-</span> <span class="fu">createPivot3</span>()
<span class="no">grp</span> <span class="kw">&lt;-</span> <span class="no">pt</span>$<span class="no">topRowGroups</span><span class="kw">[[</span><span class="fl">1</span>]]
<span class="no">pt</span>$<span class="fu">setStyling</span>(<span class="kw">groups</span><span class="kw">=</span><span class="no">grp</span>, <span class="kw">declarations</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">"background-color"</span><span class="kw">=</span><span class="st">"yellow"</span>))
<span class="no">pt</span>$<span class="fu">renderPivot</span>()</pre></body></html></div>
<div id="htmlwidget-8613f3b077682952fd9d" style="width:auto;height:auto;" class="pivottabler html-widget"></div>
<script type="application/json" data-for="htmlwidget-8613f3b077682952fd9d">{"x":{"tableCss":".Table {display: table; border-collapse: collapse; }\r\n.ColumnHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px; text-align: center; }\r\n.RowHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px 8px 2px 2px; text-align: left; }\r\n.Cell {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n.OutlineColumnHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px; text-align: center; }\r\n.OutlineRowHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px 8px 2px 2px; text-align: left; }\r\n.OutlineCell {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; background-color: #F8F8F8; font-weight: bold; }\r\n.Total {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n","tableHtml":"<table class=\"Table\">\n  <tr>\n    <th class=\"RowHeader\" colspan=\"3\">&nbsp;<\/th>\n    <th class=\"ColumnHeader\">Train Count<\/th>\n  <\/tr>\n  <tr>\n    <th class=\"OutlineRowHeader\" style=\"background-color: yellow; \" colspan=\"3\">CrossCountry<\/th>\n    <td class=\"OutlineCell\"><\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\" rowspan=\"3\">&nbsp;<\/th>\n    <th class=\"RowHeader\" rowspan=\"2\">Express Passenger<\/th>\n    <th class=\"RowHeader\">DMU<\/th>\n    <td class=\"Cell\">22133<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">HST<\/th>\n    <td class=\"Cell\">732<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Ordinary Passenger<\/th>\n    <th class=\"RowHeader\">DMU<\/th>\n    <td class=\"Cell\">63<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"OutlineRowHeader\" style=\"font-style: italic; \" colspan=\"3\">CrossCountry Total<\/th>\n    <td class=\"OutlineCell\">22928<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"OutlineRowHeader\" colspan=\"3\">Virgin Trains<\/th>\n    <td class=\"OutlineCell\"><\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\" rowspan=\"2\">&nbsp;<\/th>\n    <th class=\"RowHeader\" rowspan=\"2\">Express Passenger<\/th>\n    <th class=\"RowHeader\">DMU<\/th>\n    <td class=\"Cell\">2137<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">EMU<\/th>\n    <td class=\"Cell\">6457<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"OutlineRowHeader\" style=\"font-style: italic; \" colspan=\"3\">Virgin Trains Total<\/th>\n    <td class=\"OutlineCell\">8594<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"OutlineRowHeader\" colspan=\"3\">Total<\/th>\n    <td class=\"OutlineCell\">31522<\/td>\n  <\/tr>\n<\/table>","settings":[]},"evals":[],"jsHooks":[]}</script><p>The related outline groups can be retrieved using <code>getRelatedOutlineGroups()</code>:</p>
<div class="sourceCode" id="cb43"><html><body><pre class="r"><span class="no">pt</span> <span class="kw">&lt;-</span> <span class="fu">createPivot3</span>()
<span class="no">grp</span> <span class="kw">&lt;-</span> <span class="no">pt</span>$<span class="no">topRowGroups</span><span class="kw">[[</span><span class="fl">1</span>]]
<span class="no">grps</span> <span class="kw">&lt;-</span> <span class="no">grp</span>$<span class="fu">getRelatedOutlineGroups</span>()
<span class="no">pt</span>$<span class="fu">setStyling</span>(<span class="kw">groups</span><span class="kw">=</span><span class="no">grps</span>, <span class="kw">declarations</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">"background-color"</span><span class="kw">=</span><span class="st">"cyan"</span>))
<span class="no">pt</span>$<span class="fu">renderPivot</span>()</pre></body></html></div>
<div id="htmlwidget-7bbcc9a8d8e2ede4f371" style="width:auto;height:auto;" class="pivottabler html-widget"></div>
<script type="application/json" data-for="htmlwidget-7bbcc9a8d8e2ede4f371">{"x":{"tableCss":".Table {display: table; border-collapse: collapse; }\r\n.ColumnHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px; text-align: center; }\r\n.RowHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px 8px 2px 2px; text-align: left; }\r\n.Cell {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n.OutlineColumnHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px; text-align: center; }\r\n.OutlineRowHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px 8px 2px 2px; text-align: left; }\r\n.OutlineCell {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; background-color: #F8F8F8; font-weight: bold; }\r\n.Total {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n","tableHtml":"<table class=\"Table\">\n  <tr>\n    <th class=\"RowHeader\" colspan=\"3\">&nbsp;<\/th>\n    <th class=\"ColumnHeader\">Train Count<\/th>\n  <\/tr>\n  <tr>\n    <th class=\"OutlineRowHeader\" style=\"background-color: cyan; \" colspan=\"3\">CrossCountry<\/th>\n    <td class=\"OutlineCell\"><\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\" style=\"background-color: cyan; \" rowspan=\"3\">&nbsp;<\/th>\n    <th class=\"RowHeader\" rowspan=\"2\">Express Passenger<\/th>\n    <th class=\"RowHeader\">DMU<\/th>\n    <td class=\"Cell\">22133<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">HST<\/th>\n    <td class=\"Cell\">732<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Ordinary Passenger<\/th>\n    <th class=\"RowHeader\">DMU<\/th>\n    <td class=\"Cell\">63<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"OutlineRowHeader\" style=\"font-style: italic; background-color: cyan; \" colspan=\"3\">CrossCountry Total<\/th>\n    <td class=\"OutlineCell\">22928<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"OutlineRowHeader\" colspan=\"3\">Virgin Trains<\/th>\n    <td class=\"OutlineCell\"><\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\" rowspan=\"2\">&nbsp;<\/th>\n    <th class=\"RowHeader\" rowspan=\"2\">Express Passenger<\/th>\n    <th class=\"RowHeader\">DMU<\/th>\n    <td class=\"Cell\">2137<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">EMU<\/th>\n    <td class=\"Cell\">6457<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"OutlineRowHeader\" style=\"font-style: italic; \" colspan=\"3\">Virgin Trains Total<\/th>\n    <td class=\"OutlineCell\">8594<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"OutlineRowHeader\" colspan=\"3\">Total<\/th>\n    <td class=\"OutlineCell\">31522<\/td>\n  <\/tr>\n<\/table>","settings":[]},"evals":[],"jsHooks":[]}</script>
</div>
<div id="data-group-unique-identifier" class="section level3">
<h3 class="hasAnchor">
<a href="#data-group-unique-identifier" class="anchor"></a>Data Group Unique Identifier</h3>
<p>Each data group has an identifier called an instance id which can be accessed via the <code>instanceId</code> property. This integer is guaranteed to be unique. It is primarily designed to be used when comparing two variables, each holding a data group, to see if both variables refer to the same data group instance or different instances. For the three data groups highlighted in blue in the above pivot table:</p>
<div class="sourceCode" id="cb44"><html><body><pre class="r"><span class="no">fx</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">x</span>) { <span class="no">x</span>$<span class="no">instanceId</span> }
<span class="no">instanceIds</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span>(<span class="no">grps</span>, <span class="no">fx</span>)
<span class="no">instanceIds</span></pre></body></html></div>
<pre><code>## [1] 3 4 5</code></pre>
</div>
<div id="converting-between-instance-ids-and-indexes" class="section level3">
<h3 class="hasAnchor">
<a href="#converting-between-instance-ids-and-indexes" class="anchor"></a>Converting between instance ids and indexes</h3>
<p>It is possible to convert between instance ids and the index of the elements in the list of children using either <code>grp$getChildIndex()</code> (specifying a single group or a list of groups) or <code>grp$findChildIndex()</code> (specifying instance ids). Both methods require that the groups referred to in the argument are children of the group the method is called on (i.e. children of <code>grp</code>), otherwise <code>NA</code> will be returned.</p>
<div class="sourceCode" id="cb46"><html><body><pre class="r"><span class="no">index</span> <span class="kw">&lt;-</span> <span class="no">pt</span>$<span class="no">rowGroup</span>$<span class="fu">getChildIndex</span>(<span class="no">grps</span>)
<span class="no">index</span></pre></body></html></div>
<pre><code>## [1] 1 2 3</code></pre>
<div class="sourceCode" id="cb48"><html><body><pre class="r"><span class="no">fx</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">x</span>) { <span class="no">x</span>$<span class="no">instanceId</span> }
<span class="no">instanceIds</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span>(<span class="no">grps</span>, <span class="no">fx</span>)
<span class="no">instanceIds</span></pre></body></html></div>
<pre><code>## [1] 3 4 5</code></pre>
<div class="sourceCode" id="cb50"><html><body><pre class="r"><span class="no">index</span> <span class="kw">&lt;-</span> <span class="no">pt</span>$<span class="no">rowGroup</span>$<span class="fu">findChildIndex</span>(<span class="no">instanceIds</span>)
<span class="no">index</span></pre></body></html></div>
<pre><code>## [1] 1 2 3</code></pre>
</div>
<div id="finding-multiple-data-groups" class="section level3">
<h3 class="hasAnchor">
<a href="#finding-multiple-data-groups" class="anchor"></a>Finding multiple data groups</h3>
<p>The methods described above allow navigation from one data group to another.</p>
<p>More direct methods of finding data groups matching specific criteria are described in the <a href="v08-findingandformatting.html">Finding and Formatting</a> vignette.</p>
</div>
</div>
<div id="navigating-cells" class="section level2">
<h2 class="hasAnchor">
<a href="#navigating-cells" class="anchor"></a>Navigating Cells</h2>
<div id="example-pivot-table-2" class="section level3">
<h3 class="hasAnchor">
<a href="#example-pivot-table-2" class="anchor"></a>Example pivot table</h3>
<p>The examples in this section use the first example pivot table in this vignette:</p>
<div class="sourceCode" id="cb52"><html><body><pre class="r"><span class="no">pt</span> <span class="kw">&lt;-</span> <span class="fu">createPivot1</span>()
<span class="no">pt</span>$<span class="fu">renderPivot</span>()</pre></body></html></div>
<div id="htmlwidget-70d427d5c6a224a263ec" style="width:auto;height:auto;" class="pivottabler html-widget"></div>
<script type="application/json" data-for="htmlwidget-70d427d5c6a224a263ec">{"x":{"tableCss":".Table {display: table; border-collapse: collapse; }\r\n.ColumnHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px; text-align: center; }\r\n.RowHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px 8px 2px 2px; text-align: left; }\r\n.Cell {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n.OutlineColumnHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px; text-align: center; }\r\n.OutlineRowHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px 8px 2px 2px; text-align: left; }\r\n.OutlineCell {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; background-color: #F8F8F8; font-weight: bold; }\r\n.Total {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n","tableHtml":"<table class=\"Table\">\n  <tr>\n    <th class=\"RowHeader\" rowspan=\"2\">&nbsp;<\/th>\n    <th class=\"ColumnHeader\" colspan=\"4\">Express Passenger<\/th>\n    <th class=\"ColumnHeader\" colspan=\"3\">Ordinary Passenger<\/th>\n    <th class=\"ColumnHeader\">Total<\/th>\n  <\/tr>\n  <tr>\n    <th class=\"ColumnHeader\">DMU<\/th>\n    <th class=\"ColumnHeader\">EMU<\/th>\n    <th class=\"ColumnHeader\">HST<\/th>\n    <th class=\"ColumnHeader\">Total<\/th>\n    <th class=\"ColumnHeader\">DMU<\/th>\n    <th class=\"ColumnHeader\">EMU<\/th>\n    <th class=\"ColumnHeader\">Total<\/th>\n    <th class=\"ColumnHeader\">&nbsp;<\/th>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Arriva Trains Wales<\/th>\n    <td class=\"Cell\">3079<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">3079<\/td>\n    <td class=\"Cell\">830<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">830<\/td>\n    <td class=\"Total\">3909<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">CrossCountry<\/th>\n    <td class=\"Cell\">22133<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\">732<\/td>\n    <td class=\"Total\">22865<\/td>\n    <td class=\"Cell\">63<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">63<\/td>\n    <td class=\"Total\">22928<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">London Midland<\/th>\n    <td class=\"Cell\">5638<\/td>\n    <td class=\"Cell\">8849<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">14487<\/td>\n    <td class=\"Cell\">5591<\/td>\n    <td class=\"Cell\">28201<\/td>\n    <td class=\"Total\">33792<\/td>\n    <td class=\"Total\">48279<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Virgin Trains<\/th>\n    <td class=\"Cell\">2137<\/td>\n    <td class=\"Cell\">6457<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">8594<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\"><\/td>\n    <td class=\"Total\">8594<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Total<\/th>\n    <td class=\"Total\">32987<\/td>\n    <td class=\"Total\">15306<\/td>\n    <td class=\"Total\">732<\/td>\n    <td class=\"Total\">49025<\/td>\n    <td class=\"Total\">6484<\/td>\n    <td class=\"Total\">28201<\/td>\n    <td class=\"Total\">34685<\/td>\n    <td class=\"Total\">83710<\/td>\n  <\/tr>\n<\/table>","settings":[]},"evals":[],"jsHooks":[]}</script>
</div>
<div id="cell-class" class="section level3">
<h3 class="hasAnchor">
<a href="#cell-class" class="anchor"></a>Cell Class</h3>
<p>Each data group is an instance of the <code>PivotCell</code> class. See the <a href="vA3-appendix.html">Class Overview</a> appendix for details.</p>
</div>
<div id="pivot-table-dimensions" class="section level3">
<h3 class="hasAnchor">
<a href="#pivot-table-dimensions" class="anchor"></a>Pivot table dimensions</h3>
<p>The numbers of rows and columns (excluding the data group headers) can be retrieved using <code>pt$rowCount</code> and <code>pt$columnCount</code>:</p>
<div class="sourceCode" id="cb53"><html><body><pre class="r"><span class="no">pt</span>$<span class="no">rowCount</span></pre></body></html></div>
<pre><code>## [1] 5</code></pre>
<div class="sourceCode" id="cb55"><html><body><pre class="r"><span class="no">pt</span>$<span class="no">columnCount</span></pre></body></html></div>
<pre><code>## [1] 8</code></pre>
</div>
<div id="retrieving-a-specific-cell-by-row-and-column-number" class="section level3">
<h3 class="hasAnchor">
<a href="#retrieving-a-specific-cell-by-row-and-column-number" class="anchor"></a>Retrieving a specific cell by row and column number</h3>
<p>A specific cell can be retrieved using <code>pt$getCell()</code>, e.g. the cell on the second row in the third column:</p>
<div class="sourceCode" id="cb57"><html><body><pre class="r"><span class="no">cell</span> <span class="kw">&lt;-</span> <span class="no">pt</span>$<span class="fu">getCell</span>(<span class="kw">r</span><span class="kw">=</span><span class="fl">2</span>, <span class="kw">c</span><span class="kw">=</span><span class="fl">3</span>)
<span class="no">pt</span>$<span class="fu">setStyling</span>(<span class="kw">cells</span><span class="kw">=</span><span class="no">cell</span>, <span class="kw">declarations</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">"background-color"</span><span class="kw">=</span><span class="st">"yellow"</span>))
<span class="no">pt</span>$<span class="fu">renderPivot</span>()</pre></body></html></div>
<div id="htmlwidget-04f8c26f60fd48bdfc36" style="width:auto;height:auto;" class="pivottabler html-widget"></div>
<script type="application/json" data-for="htmlwidget-04f8c26f60fd48bdfc36">{"x":{"tableCss":".Table {display: table; border-collapse: collapse; }\r\n.ColumnHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px; text-align: center; }\r\n.RowHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px 8px 2px 2px; text-align: left; }\r\n.Cell {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n.OutlineColumnHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px; text-align: center; }\r\n.OutlineRowHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px 8px 2px 2px; text-align: left; }\r\n.OutlineCell {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; background-color: #F8F8F8; font-weight: bold; }\r\n.Total {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n","tableHtml":"<table class=\"Table\">\n  <tr>\n    <th class=\"RowHeader\" rowspan=\"2\">&nbsp;<\/th>\n    <th class=\"ColumnHeader\" colspan=\"4\">Express Passenger<\/th>\n    <th class=\"ColumnHeader\" colspan=\"3\">Ordinary Passenger<\/th>\n    <th class=\"ColumnHeader\">Total<\/th>\n  <\/tr>\n  <tr>\n    <th class=\"ColumnHeader\">DMU<\/th>\n    <th class=\"ColumnHeader\">EMU<\/th>\n    <th class=\"ColumnHeader\">HST<\/th>\n    <th class=\"ColumnHeader\">Total<\/th>\n    <th class=\"ColumnHeader\">DMU<\/th>\n    <th class=\"ColumnHeader\">EMU<\/th>\n    <th class=\"ColumnHeader\">Total<\/th>\n    <th class=\"ColumnHeader\">&nbsp;<\/th>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Arriva Trains Wales<\/th>\n    <td class=\"Cell\">3079<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">3079<\/td>\n    <td class=\"Cell\">830<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">830<\/td>\n    <td class=\"Total\">3909<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">CrossCountry<\/th>\n    <td class=\"Cell\">22133<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\" style=\"background-color: yellow; \">732<\/td>\n    <td class=\"Total\">22865<\/td>\n    <td class=\"Cell\">63<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">63<\/td>\n    <td class=\"Total\">22928<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">London Midland<\/th>\n    <td class=\"Cell\">5638<\/td>\n    <td class=\"Cell\">8849<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">14487<\/td>\n    <td class=\"Cell\">5591<\/td>\n    <td class=\"Cell\">28201<\/td>\n    <td class=\"Total\">33792<\/td>\n    <td class=\"Total\">48279<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Virgin Trains<\/th>\n    <td class=\"Cell\">2137<\/td>\n    <td class=\"Cell\">6457<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">8594<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\"><\/td>\n    <td class=\"Total\">8594<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Total<\/th>\n    <td class=\"Total\">32987<\/td>\n    <td class=\"Total\">15306<\/td>\n    <td class=\"Total\">732<\/td>\n    <td class=\"Total\">49025<\/td>\n    <td class=\"Total\">6484<\/td>\n    <td class=\"Total\">28201<\/td>\n    <td class=\"Total\">34685<\/td>\n    <td class=\"Total\">83710<\/td>\n  <\/tr>\n<\/table>","settings":[]},"evals":[],"jsHooks":[]}</script><div class="sourceCode" id="cb58"><html><body><pre class="r"><span class="no">cell</span>$<span class="no">rawValue</span></pre></body></html></div>
<pre><code>## [1] 732</code></pre>
<div class="sourceCode" id="cb60"><html><body><pre class="r"><span class="no">cell</span>$<span class="no">formattedValue</span></pre></body></html></div>
<pre><code>## [1] "732"</code></pre>
<p>Note that <code>pt$getCell()</code> can only be used to retrieve an individual cell.</p>
</div>
<div id="cell-unique-identifier" class="section level3">
<h3 class="hasAnchor">
<a href="#cell-unique-identifier" class="anchor"></a>Cell Unique Identifier</h3>
<p>Each cell also has an instance id which can be accessed via the <code>instanceId</code> property. Again, this integer is guaranteed to be unique and is primarily designed to be used when comparing two variables to see if both variables refer to the same cell instance.</p>
<div class="sourceCode" id="cb62"><html><body><pre class="r"><span class="no">cell</span>$<span class="no">instanceId</span></pre></body></html></div>
<pre><code>## [1] 29</code></pre>
</div>
<div id="retrieving-multiple-cells" class="section level3">
<h3 class="hasAnchor">
<a href="#retrieving-multiple-cells" class="anchor"></a>Retrieving multiple cells</h3>
<p>Methods for finding multiple cells in one function call, either by row and/or column coordinates or by specifying other criteria, are described in the <a href="v08-findingandformatting.html">Finding and Formatting</a> vignette.</p>
</div>
</div>
<div id="navigating-between-data-groups-and-rows-columns-cells" class="section level2">
<h2 class="hasAnchor">
<a href="#navigating-between-data-groups-and-rows-columns-cells" class="anchor"></a>Navigating between data groups and rows / columns / cells</h2>
<div id="example-pivot-table-3" class="section level3">
<h3 class="hasAnchor">
<a href="#example-pivot-table-3" class="anchor"></a>Example pivot table</h3>
<p>The examples in this section use the first example pivot table in this vignette:</p>
<div class="sourceCode" id="cb64"><html><body><pre class="r"><span class="no">pt</span> <span class="kw">&lt;-</span> <span class="fu">createPivot1</span>()
<span class="no">pt</span>$<span class="fu">renderPivot</span>()</pre></body></html></div>
<div id="htmlwidget-39a64a3b0c4bbf8d07c1" style="width:auto;height:auto;" class="pivottabler html-widget"></div>
<script type="application/json" data-for="htmlwidget-39a64a3b0c4bbf8d07c1">{"x":{"tableCss":".Table {display: table; border-collapse: collapse; }\r\n.ColumnHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px; text-align: center; }\r\n.RowHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px 8px 2px 2px; text-align: left; }\r\n.Cell {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n.OutlineColumnHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px; text-align: center; }\r\n.OutlineRowHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px 8px 2px 2px; text-align: left; }\r\n.OutlineCell {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; background-color: #F8F8F8; font-weight: bold; }\r\n.Total {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n","tableHtml":"<table class=\"Table\">\n  <tr>\n    <th class=\"RowHeader\" rowspan=\"2\">&nbsp;<\/th>\n    <th class=\"ColumnHeader\" colspan=\"4\">Express Passenger<\/th>\n    <th class=\"ColumnHeader\" colspan=\"3\">Ordinary Passenger<\/th>\n    <th class=\"ColumnHeader\">Total<\/th>\n  <\/tr>\n  <tr>\n    <th class=\"ColumnHeader\">DMU<\/th>\n    <th class=\"ColumnHeader\">EMU<\/th>\n    <th class=\"ColumnHeader\">HST<\/th>\n    <th class=\"ColumnHeader\">Total<\/th>\n    <th class=\"ColumnHeader\">DMU<\/th>\n    <th class=\"ColumnHeader\">EMU<\/th>\n    <th class=\"ColumnHeader\">Total<\/th>\n    <th class=\"ColumnHeader\">&nbsp;<\/th>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Arriva Trains Wales<\/th>\n    <td class=\"Cell\">3079<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">3079<\/td>\n    <td class=\"Cell\">830<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">830<\/td>\n    <td class=\"Total\">3909<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">CrossCountry<\/th>\n    <td class=\"Cell\">22133<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\">732<\/td>\n    <td class=\"Total\">22865<\/td>\n    <td class=\"Cell\">63<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">63<\/td>\n    <td class=\"Total\">22928<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">London Midland<\/th>\n    <td class=\"Cell\">5638<\/td>\n    <td class=\"Cell\">8849<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">14487<\/td>\n    <td class=\"Cell\">5591<\/td>\n    <td class=\"Cell\">28201<\/td>\n    <td class=\"Total\">33792<\/td>\n    <td class=\"Total\">48279<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Virgin Trains<\/th>\n    <td class=\"Cell\">2137<\/td>\n    <td class=\"Cell\">6457<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">8594<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\"><\/td>\n    <td class=\"Total\">8594<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Total<\/th>\n    <td class=\"Total\">32987<\/td>\n    <td class=\"Total\">15306<\/td>\n    <td class=\"Total\">732<\/td>\n    <td class=\"Total\">49025<\/td>\n    <td class=\"Total\">6484<\/td>\n    <td class=\"Total\">28201<\/td>\n    <td class=\"Total\">34685<\/td>\n    <td class=\"Total\">83710<\/td>\n  <\/tr>\n<\/table>","settings":[]},"evals":[],"jsHooks":[]}</script>
</div>
<div id="from-data-groups-to-rows-columns-cells" class="section level3">
<h3 class="hasAnchor">
<a href="#from-data-groups-to-rows-columns-cells" class="anchor"></a>From data groups to rows / columns / cells</h3>
<p>For a data group at the leaf-level of the hierarchy, the related row or column number can be found using the <code>rowColumnNumber</code> property, e.g.</p>
<div class="sourceCode" id="cb65"><html><body><pre class="r"><span class="no">grps</span> <span class="kw">&lt;-</span> <span class="no">pt</span>$<span class="no">leafRowGroups</span>
<span class="no">grp</span> <span class="kw">&lt;-</span> <span class="no">grps</span><span class="kw">[[</span><span class="fl">3</span>]]
<span class="no">grp</span>$<span class="no">rowColumnNumber</span></pre></body></html></div>
<pre><code>## [1] 3</code></pre>
<p>In the above example, since <code>grp</code> is a row group, the <code>rowColumnNumber</code> value is a row number.</p>
<p>More generally, the row numbers related to a particular group at any level of the hierarchy can be found using <code>pt$findGroupRowNumbers()</code>, e.g. finding the row numbers of all row groups:</p>
<div class="sourceCode" id="cb67"><html><body><pre class="r"><span class="no">grps</span> <span class="kw">&lt;-</span> <span class="no">pt</span>$<span class="no">leafRowGroups</span>
<span class="no">grp</span> <span class="kw">&lt;-</span> <span class="no">grps</span><span class="kw">[[</span><span class="fl">3</span>]]
(<span class="no">pt</span>$<span class="fu">findGroupRowNumbers</span>(<span class="no">grp</span>))</pre></body></html></div>
<pre><code>## [1] 3</code></pre>
<div class="sourceCode" id="cb69"><html><body><pre class="r"><span class="no">fx</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">x</span>) { <span class="no">pt</span>$<span class="fu">findGroupRowNumbers</span>(<span class="kw">group</span><span class="kw">=</span><span class="no">x</span>) }
<span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span>(<span class="no">grps</span>, <span class="no">fx</span>)</pre></body></html></div>
<pre><code>## [1] 1 2 3 4 5</code></pre>
<p>Similarly, the column numbers related to a particular group can be found using <code>pt$findGroupColumnNumbers()</code>, e.g. finding the column numbers related to the “Ordinary Passenger” column group:</p>
<div class="sourceCode" id="cb71"><html><body><pre class="r"><span class="no">grp</span> <span class="kw">&lt;-</span> <span class="no">pt</span>$<span class="no">topColumnGroups</span><span class="kw">[[</span><span class="fl">2</span>]]
<span class="no">pt</span>$<span class="fu">setStyling</span>(<span class="kw">groups</span><span class="kw">=</span><span class="no">grp</span>, <span class="kw">declarations</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">"background-color"</span><span class="kw">=</span><span class="st">"yellow"</span>))
(<span class="no">pt</span>$<span class="fu">findGroupColumnNumbers</span>(<span class="kw">group</span><span class="kw">=</span><span class="no">grp</span>))</pre></body></html></div>
<pre><code>## [1] 5 6 7</code></pre>
<div class="sourceCode" id="cb73"><html><body><pre class="r"><span class="no">pt</span>$<span class="fu">renderPivot</span>()</pre></body></html></div>
<div id="htmlwidget-c9e4e15105889cfa4314" style="width:auto;height:auto;" class="pivottabler html-widget"></div>
<script type="application/json" data-for="htmlwidget-c9e4e15105889cfa4314">{"x":{"tableCss":".Table {display: table; border-collapse: collapse; }\r\n.ColumnHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px; text-align: center; }\r\n.RowHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px 8px 2px 2px; text-align: left; }\r\n.Cell {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n.OutlineColumnHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px; text-align: center; }\r\n.OutlineRowHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px 8px 2px 2px; text-align: left; }\r\n.OutlineCell {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; background-color: #F8F8F8; font-weight: bold; }\r\n.Total {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n","tableHtml":"<table class=\"Table\">\n  <tr>\n    <th class=\"RowHeader\" rowspan=\"2\">&nbsp;<\/th>\n    <th class=\"ColumnHeader\" colspan=\"4\">Express Passenger<\/th>\n    <th class=\"ColumnHeader\" style=\"background-color: yellow; \" colspan=\"3\">Ordinary Passenger<\/th>\n    <th class=\"ColumnHeader\">Total<\/th>\n  <\/tr>\n  <tr>\n    <th class=\"ColumnHeader\">DMU<\/th>\n    <th class=\"ColumnHeader\">EMU<\/th>\n    <th class=\"ColumnHeader\">HST<\/th>\n    <th class=\"ColumnHeader\">Total<\/th>\n    <th class=\"ColumnHeader\">DMU<\/th>\n    <th class=\"ColumnHeader\">EMU<\/th>\n    <th class=\"ColumnHeader\">Total<\/th>\n    <th class=\"ColumnHeader\">&nbsp;<\/th>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Arriva Trains Wales<\/th>\n    <td class=\"Cell\">3079<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">3079<\/td>\n    <td class=\"Cell\">830<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">830<\/td>\n    <td class=\"Total\">3909<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">CrossCountry<\/th>\n    <td class=\"Cell\">22133<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\">732<\/td>\n    <td class=\"Total\">22865<\/td>\n    <td class=\"Cell\">63<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">63<\/td>\n    <td class=\"Total\">22928<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">London Midland<\/th>\n    <td class=\"Cell\">5638<\/td>\n    <td class=\"Cell\">8849<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">14487<\/td>\n    <td class=\"Cell\">5591<\/td>\n    <td class=\"Cell\">28201<\/td>\n    <td class=\"Total\">33792<\/td>\n    <td class=\"Total\">48279<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Virgin Trains<\/th>\n    <td class=\"Cell\">2137<\/td>\n    <td class=\"Cell\">6457<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">8594<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\"><\/td>\n    <td class=\"Total\">8594<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Total<\/th>\n    <td class=\"Total\">32987<\/td>\n    <td class=\"Total\">15306<\/td>\n    <td class=\"Total\">732<\/td>\n    <td class=\"Total\">49025<\/td>\n    <td class=\"Total\">6484<\/td>\n    <td class=\"Total\">28201<\/td>\n    <td class=\"Total\">34685<\/td>\n    <td class=\"Total\">83710<\/td>\n  <\/tr>\n<\/table>","settings":[]},"evals":[],"jsHooks":[]}</script><p>As shown above, both <code>pt$findGroupRowNumbers()</code> and <code>pt$findGroupColumnNumbers()</code> can return a vector of row/column numbers, which is normal for data groups that are above the leaf level:</p>
<div class="sourceCode" id="cb74"><html><body><pre class="r"><span class="no">grps</span> <span class="kw">&lt;-</span> <span class="no">pt</span>$<span class="no">topColumnGroups</span>
<span class="no">fx</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">x</span>) {
  <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="no">x</span>$<span class="no">caption</span>, <span class="st">": column "</span>,
         <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="no">pt</span>$<span class="fu">findGroupColumnNumbers</span>(<span class="kw">group</span><span class="kw">=</span><span class="no">x</span>), <span class="kw">collapse</span><span class="kw">=</span><span class="st">" "</span>))
}
<span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span>(<span class="no">grps</span>, <span class="no">fx</span>)</pre></body></html></div>
<pre><code>## [1] "Express Passenger: column 1 2 3 4" "Ordinary Passenger: column 5 6 7" 
## [3] "Total: column 8"</code></pre>
<p>Once the relevant row and/or column numbers are known, cells can be retrieved either using the <code>pt$getCell()</code> function described above or or the <code>pt$getCells()</code> function described in the <a href="v08-findingandformatting.html">Finding and Formatting</a> vignette.</p>
</div>
<div id="from-rows-or-columns-to-data-groups" class="section level3">
<h3 class="hasAnchor">
<a href="#from-rows-or-columns-to-data-groups" class="anchor"></a>From rows or columns to data groups</h3>
<p>The leaf level data group for a particular row can be retrieved with <code>pt$getLeafRowGroup()</code>:</p>
<div class="sourceCode" id="cb76"><html><body><pre class="r"><span class="no">pt</span> <span class="kw">&lt;-</span> <span class="fu">createPivot1</span>()
<span class="no">grp</span> <span class="kw">&lt;-</span> <span class="no">pt</span>$<span class="fu">getLeafRowGroup</span>(<span class="kw">r</span><span class="kw">=</span><span class="fl">3</span>)
<span class="no">pt</span>$<span class="fu">setStyling</span>(<span class="kw">groups</span><span class="kw">=</span><span class="no">grp</span>, <span class="kw">declarations</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">"background-color"</span><span class="kw">=</span><span class="st">"yellow"</span>))
<span class="no">grp</span>$<span class="no">caption</span></pre></body></html></div>
<pre><code>## [1] "London Midland"</code></pre>
<p>The leaf level data group for a particular column can be retrieved with <code>pt$getLeafColumnGroup()</code>:</p>
<div class="sourceCode" id="cb78"><html><body><pre class="r"><span class="no">grp</span> <span class="kw">&lt;-</span> <span class="no">pt</span>$<span class="fu">getLeafColumnGroup</span>(<span class="kw">c</span><span class="kw">=</span><span class="fl">5</span>)
<span class="no">pt</span>$<span class="fu">setStyling</span>(<span class="kw">groups</span><span class="kw">=</span><span class="no">grp</span>, <span class="kw">declarations</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">"background-color"</span><span class="kw">=</span><span class="st">"cyan"</span>))
<span class="no">grp</span>$<span class="no">caption</span></pre></body></html></div>
<pre><code>## [1] "DMU"</code></pre>
<div class="sourceCode" id="cb80"><html><body><pre class="r"><span class="no">pt</span>$<span class="fu">renderPivot</span>()</pre></body></html></div>
<div id="htmlwidget-ceebf6645b612e137847" style="width:auto;height:auto;" class="pivottabler html-widget"></div>
<script type="application/json" data-for="htmlwidget-ceebf6645b612e137847">{"x":{"tableCss":".Table {display: table; border-collapse: collapse; }\r\n.ColumnHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px; text-align: center; }\r\n.RowHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px 8px 2px 2px; text-align: left; }\r\n.Cell {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n.OutlineColumnHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px; text-align: center; }\r\n.OutlineRowHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px 8px 2px 2px; text-align: left; }\r\n.OutlineCell {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; background-color: #F8F8F8; font-weight: bold; }\r\n.Total {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n","tableHtml":"<table class=\"Table\">\n  <tr>\n    <th class=\"RowHeader\" rowspan=\"2\">&nbsp;<\/th>\n    <th class=\"ColumnHeader\" colspan=\"4\">Express Passenger<\/th>\n    <th class=\"ColumnHeader\" colspan=\"3\">Ordinary Passenger<\/th>\n    <th class=\"ColumnHeader\">Total<\/th>\n  <\/tr>\n  <tr>\n    <th class=\"ColumnHeader\">DMU<\/th>\n    <th class=\"ColumnHeader\">EMU<\/th>\n    <th class=\"ColumnHeader\">HST<\/th>\n    <th class=\"ColumnHeader\">Total<\/th>\n    <th class=\"ColumnHeader\" style=\"background-color: cyan; \">DMU<\/th>\n    <th class=\"ColumnHeader\">EMU<\/th>\n    <th class=\"ColumnHeader\">Total<\/th>\n    <th class=\"ColumnHeader\">&nbsp;<\/th>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Arriva Trains Wales<\/th>\n    <td class=\"Cell\">3079<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">3079<\/td>\n    <td class=\"Cell\">830<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">830<\/td>\n    <td class=\"Total\">3909<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">CrossCountry<\/th>\n    <td class=\"Cell\">22133<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\">732<\/td>\n    <td class=\"Total\">22865<\/td>\n    <td class=\"Cell\">63<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">63<\/td>\n    <td class=\"Total\">22928<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\" style=\"background-color: yellow; \">London Midland<\/th>\n    <td class=\"Cell\">5638<\/td>\n    <td class=\"Cell\">8849<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">14487<\/td>\n    <td class=\"Cell\">5591<\/td>\n    <td class=\"Cell\">28201<\/td>\n    <td class=\"Total\">33792<\/td>\n    <td class=\"Total\">48279<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Virgin Trains<\/th>\n    <td class=\"Cell\">2137<\/td>\n    <td class=\"Cell\">6457<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">8594<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\"><\/td>\n    <td class=\"Total\">8594<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Total<\/th>\n    <td class=\"Total\">32987<\/td>\n    <td class=\"Total\">15306<\/td>\n    <td class=\"Total\">732<\/td>\n    <td class=\"Total\">49025<\/td>\n    <td class=\"Total\">6484<\/td>\n    <td class=\"Total\">28201<\/td>\n    <td class=\"Total\">34685<\/td>\n    <td class=\"Total\">83710<\/td>\n  <\/tr>\n<\/table>","settings":[]},"evals":[],"jsHooks":[]}</script><p>From a leaf level group, it is possible to navigate through the rest of the hierarchy as described above, e.g.</p>
<div class="sourceCode" id="cb81"><html><body><pre class="r"><span class="no">grp</span>$<span class="no">parentGroup</span>$<span class="no">caption</span></pre></body></html></div>
<pre><code>## [1] "Ordinary Passenger"</code></pre>
<p>Also as described above, the entire set of leaf-level groups can be retrieved as a list using <code>pt$leafRowGroups</code> and <code>pt$leafColumnGroups</code>. In these lists, the first element is the leaf-level group for row/column 1, the second element is the leaf-level group for row/column 2, etc.</p>
<div class="sourceCode" id="cb83"><html><body><pre class="r"><span class="no">pt</span> <span class="kw">&lt;-</span> <span class="fu">createPivot1</span>()
<span class="no">fx</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">x</span>) { <span class="no">x</span>$<span class="no">caption</span> }
<span class="no">grps</span> <span class="kw">&lt;-</span> <span class="no">pt</span>$<span class="no">leafRowGroups</span>
<span class="no">pt</span>$<span class="fu">setStyling</span>(<span class="kw">groups</span><span class="kw">=</span><span class="no">grps</span>, <span class="kw">declarations</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">"background-color"</span><span class="kw">=</span><span class="st">"yellow"</span>))
<span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span>(<span class="no">grps</span>, <span class="no">fx</span>)</pre></body></html></div>
<pre><code>## [1] "Arriva Trains Wales" "CrossCountry"        "London Midland"     
## [4] "Virgin Trains"       "Total"</code></pre>
<div class="sourceCode" id="cb85"><html><body><pre class="r"><span class="no">grps</span> <span class="kw">&lt;-</span> <span class="no">pt</span>$<span class="no">leafColumnGroups</span>
<span class="no">pt</span>$<span class="fu">setStyling</span>(<span class="kw">groups</span><span class="kw">=</span><span class="no">grps</span>, <span class="kw">declarations</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">"background-color"</span><span class="kw">=</span><span class="st">"cyan"</span>))
<span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span>(<span class="no">grps</span>, <span class="no">fx</span>)</pre></body></html></div>
<pre><code>## [1] "DMU"   "EMU"   "HST"   "Total" "DMU"   "EMU"   "Total" ""</code></pre>
<div class="sourceCode" id="cb87"><html><body><pre class="r"><span class="no">pt</span>$<span class="fu">renderPivot</span>()</pre></body></html></div>
<div id="htmlwidget-4e2cc2c63f168be22cdf" style="width:auto;height:auto;" class="pivottabler html-widget"></div>
<script type="application/json" data-for="htmlwidget-4e2cc2c63f168be22cdf">{"x":{"tableCss":".Table {display: table; border-collapse: collapse; }\r\n.ColumnHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px; text-align: center; }\r\n.RowHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px 8px 2px 2px; text-align: left; }\r\n.Cell {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n.OutlineColumnHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px; text-align: center; }\r\n.OutlineRowHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px 8px 2px 2px; text-align: left; }\r\n.OutlineCell {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; background-color: #F8F8F8; font-weight: bold; }\r\n.Total {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n","tableHtml":"<table class=\"Table\">\n  <tr>\n    <th class=\"RowHeader\" rowspan=\"2\">&nbsp;<\/th>\n    <th class=\"ColumnHeader\" colspan=\"4\">Express Passenger<\/th>\n    <th class=\"ColumnHeader\" colspan=\"3\">Ordinary Passenger<\/th>\n    <th class=\"ColumnHeader\">Total<\/th>\n  <\/tr>\n  <tr>\n    <th class=\"ColumnHeader\" style=\"background-color: cyan; \">DMU<\/th>\n    <th class=\"ColumnHeader\" style=\"background-color: cyan; \">EMU<\/th>\n    <th class=\"ColumnHeader\" style=\"background-color: cyan; \">HST<\/th>\n    <th class=\"ColumnHeader\" style=\"background-color: cyan; \">Total<\/th>\n    <th class=\"ColumnHeader\" style=\"background-color: cyan; \">DMU<\/th>\n    <th class=\"ColumnHeader\" style=\"background-color: cyan; \">EMU<\/th>\n    <th class=\"ColumnHeader\" style=\"background-color: cyan; \">Total<\/th>\n    <th class=\"ColumnHeader\" style=\"background-color: cyan; \">&nbsp;<\/th>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\" style=\"background-color: yellow; \">Arriva Trains Wales<\/th>\n    <td class=\"Cell\">3079<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">3079<\/td>\n    <td class=\"Cell\">830<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">830<\/td>\n    <td class=\"Total\">3909<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\" style=\"background-color: yellow; \">CrossCountry<\/th>\n    <td class=\"Cell\">22133<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\">732<\/td>\n    <td class=\"Total\">22865<\/td>\n    <td class=\"Cell\">63<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">63<\/td>\n    <td class=\"Total\">22928<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\" style=\"background-color: yellow; \">London Midland<\/th>\n    <td class=\"Cell\">5638<\/td>\n    <td class=\"Cell\">8849<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">14487<\/td>\n    <td class=\"Cell\">5591<\/td>\n    <td class=\"Cell\">28201<\/td>\n    <td class=\"Total\">33792<\/td>\n    <td class=\"Total\">48279<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\" style=\"background-color: yellow; \">Virgin Trains<\/th>\n    <td class=\"Cell\">2137<\/td>\n    <td class=\"Cell\">6457<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">8594<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\"><\/td>\n    <td class=\"Total\">8594<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\" style=\"background-color: yellow; \">Total<\/th>\n    <td class=\"Total\">32987<\/td>\n    <td class=\"Total\">15306<\/td>\n    <td class=\"Total\">732<\/td>\n    <td class=\"Total\">49025<\/td>\n    <td class=\"Total\">6484<\/td>\n    <td class=\"Total\">28201<\/td>\n    <td class=\"Total\">34685<\/td>\n    <td class=\"Total\">83710<\/td>\n  <\/tr>\n<\/table>","settings":[]},"evals":[],"jsHooks":[]}</script>
</div>
<div id="from-cells-to-rows-columns-data-groups" class="section level3">
<h3 class="hasAnchor">
<a href="#from-cells-to-rows-columns-data-groups" class="anchor"></a>From cells to rows / columns / data groups</h3>
<p>Each cell in the pivot table has the following properties:</p>
<ul>
<li>
<code>rowNumber</code> - the row number of the cell in the body (i.e. excluding headings) of the pivot table.</li>
<li>
<code>columnNumber</code> - the column number of the cell in the body of the table.</li>
<li>
<code>rowLeafGroup</code> - the lowest level data group on the rows axis that this cell is related to.</li>
<li>
<code>columnLeafGroup</code> - the lowest level data group on the columns axis that this cell is related to.</li>
</ul>
<p>These properties allow navigation from a cell into other parts of the pivot table.</p>
<div class="sourceCode" id="cb88"><html><body><pre class="r"><span class="no">pt</span> <span class="kw">&lt;-</span> <span class="fu">createPivot1</span>()
<span class="no">pt</span>$<span class="fu">evaluatePivot</span>()
<span class="no">cell</span> <span class="kw">&lt;-</span> <span class="no">pt</span>$<span class="fu">getCell</span>(<span class="kw">r</span><span class="kw">=</span><span class="fl">2</span>, <span class="kw">c</span><span class="kw">=</span><span class="fl">3</span>)
<span class="no">pt</span>$<span class="fu">setStyling</span>(<span class="kw">cells</span><span class="kw">=</span><span class="no">cell</span>, <span class="kw">declarations</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">"background-color"</span><span class="kw">=</span><span class="st">"yellow"</span>))
<span class="no">pt</span>$<span class="fu">renderPivot</span>()</pre></body></html></div>
<div id="htmlwidget-fe4a949d56945cd76b11" style="width:auto;height:auto;" class="pivottabler html-widget"></div>
<script type="application/json" data-for="htmlwidget-fe4a949d56945cd76b11">{"x":{"tableCss":".Table {display: table; border-collapse: collapse; }\r\n.ColumnHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px; text-align: center; }\r\n.RowHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px 8px 2px 2px; text-align: left; }\r\n.Cell {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n.OutlineColumnHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px; text-align: center; }\r\n.OutlineRowHeader {font-family: Arial; font-size: 0.75em; border: 1px solid lightgray; vertical-align: middle; font-weight: bold; background-color: #F2F2F2; padding: 2px 8px 2px 2px; text-align: left; }\r\n.OutlineCell {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; background-color: #F8F8F8; font-weight: bold; }\r\n.Total {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n","tableHtml":"<table class=\"Table\">\n  <tr>\n    <th class=\"RowHeader\" rowspan=\"2\">&nbsp;<\/th>\n    <th class=\"ColumnHeader\" colspan=\"4\">Express Passenger<\/th>\n    <th class=\"ColumnHeader\" colspan=\"3\">Ordinary Passenger<\/th>\n    <th class=\"ColumnHeader\">Total<\/th>\n  <\/tr>\n  <tr>\n    <th class=\"ColumnHeader\">DMU<\/th>\n    <th class=\"ColumnHeader\">EMU<\/th>\n    <th class=\"ColumnHeader\">HST<\/th>\n    <th class=\"ColumnHeader\">Total<\/th>\n    <th class=\"ColumnHeader\">DMU<\/th>\n    <th class=\"ColumnHeader\">EMU<\/th>\n    <th class=\"ColumnHeader\">Total<\/th>\n    <th class=\"ColumnHeader\">&nbsp;<\/th>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Arriva Trains Wales<\/th>\n    <td class=\"Cell\">3079<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">3079<\/td>\n    <td class=\"Cell\">830<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">830<\/td>\n    <td class=\"Total\">3909<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">CrossCountry<\/th>\n    <td class=\"Cell\">22133<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\" style=\"background-color: yellow; \">732<\/td>\n    <td class=\"Total\">22865<\/td>\n    <td class=\"Cell\">63<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">63<\/td>\n    <td class=\"Total\">22928<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">London Midland<\/th>\n    <td class=\"Cell\">5638<\/td>\n    <td class=\"Cell\">8849<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">14487<\/td>\n    <td class=\"Cell\">5591<\/td>\n    <td class=\"Cell\">28201<\/td>\n    <td class=\"Total\">33792<\/td>\n    <td class=\"Total\">48279<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Virgin Trains<\/th>\n    <td class=\"Cell\">2137<\/td>\n    <td class=\"Cell\">6457<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">8594<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\"><\/td>\n    <td class=\"Total\">8594<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Total<\/th>\n    <td class=\"Total\">32987<\/td>\n    <td class=\"Total\">15306<\/td>\n    <td class=\"Total\">732<\/td>\n    <td class=\"Total\">49025<\/td>\n    <td class=\"Total\">6484<\/td>\n    <td class=\"Total\">28201<\/td>\n    <td class=\"Total\">34685<\/td>\n    <td class=\"Total\">83710<\/td>\n  <\/tr>\n<\/table>","settings":[]},"evals":[],"jsHooks":[]}</script><div class="sourceCode" id="cb89"><html><body><pre class="r"><span class="no">cell</span>$<span class="no">rawValue</span></pre></body></html></div>
<pre><code>## [1] 732</code></pre>
<div class="sourceCode" id="cb91"><html><body><pre class="r"><span class="no">cell</span>$<span class="no">rowNumber</span></pre></body></html></div>
<pre><code>## [1] 2</code></pre>
<div class="sourceCode" id="cb93"><html><body><pre class="r"><span class="no">cell</span>$<span class="no">columnNumber</span></pre></body></html></div>
<pre><code>## [1] 3</code></pre>
<div class="sourceCode" id="cb95"><html><body><pre class="r"><span class="no">cell</span>$<span class="no">rowLeafGroup</span>$<span class="no">caption</span></pre></body></html></div>
<pre><code>## [1] "CrossCountry"</code></pre>
<div class="sourceCode" id="cb97"><html><body><pre class="r"><span class="no">cell</span>$<span class="no">columnLeafGroup</span>$<span class="no">caption</span></pre></body></html></div>
<pre><code>## [1] "HST"</code></pre>
</div>
</div>
<div id="further-reading" class="section level2">
<h2 class="hasAnchor">
<a href="#further-reading" class="anchor"></a>Further Reading</h2>
<p>The full set of vignettes is:</p>
<ol style="list-style-type: decimal">
<li><a href="v01-introduction.html">Introduction</a></li>
<li><a href="v02-datagroups.html">Data Groups</a></li>
<li><a href="v03-calculations.html">Calculations</a></li>
<li><a href="v04-regularlayout.html">Regular Layout</a></li>
<li><a href="v05-outputs.html">Outputs</a></li>
<li><a href="v06-latexoutput.html">Latex Output</a></li>
<li><a href="v07-styling.html">Styling</a></li>
<li><a href="v08-findingandformatting.html">Finding and Formatting</a></li>
<li><a href="v09-cellcontext.html">Cell Context</a></li>
<li><a href="v10-navigatingapivottable.html">Navigating a Pivot Table</a></li>
<li><a href="v11-irregularlayout.html">Irregular Layout</a></li>
<li><a href="v12-performance.html">Performance</a></li>
<li><a href="v13-excelexport.html">Excel Export</a></li>
<li><a href="v14-shiny.html">Shiny</a></li>
<li><a href="vA1-appendix.html">Appendix: Details</a></li>
<li><a href="vA2-appendix.html">Appendix: Calculations</a></li>
<li><a href="vA3-appendix.html">Appendix: Class Overview</a></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Christopher Bailiss.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    
    
    apiKey: '16a61fa9a8811ff537cd1a528040a9e1',
    indexName: 'pivottabler',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>
</body>
</html>
