<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Create Pivot Tables in R • pivottabler</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.3/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous">
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><meta property="og:title" content="Create Pivot Tables in R">
<meta property="og:description" content="pivottabler">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-64707587-2"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-64707587-2');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">pivottabler</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.5.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/cbailiss/pivottabler/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
<form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
</div>
      </form>
      
    </div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Create Pivot Tables in R</h1>
                        <h4 class="author">Chris Bailiss</h4>
            
            <h4 class="date">2020-06-16</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/cbailiss/pivottabler/blob/master/vignettes/v00-vignettes.Rmd"><code>vignettes/v00-vignettes.Rmd</code></a></small>
      <div class="hidden name"><code>v00-vignettes.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<p>This is a shortened introduction to the <code>pivottabler</code> package.</p>
<p>A longer version of this introduction plus many other articles and examples can be found at: <a href="http://www.pivottabler.org.uk/articles/">http://www.pivottabler.org.uk/articles</a></p>
</div>
<div id="contents" class="section level2">
<h2 class="hasAnchor">
<a href="#contents" class="anchor"></a>Contents</h2>
<ul>
<li>Introducing pivottabler</li>
<li>Basic Pivot Table</li>
<li>Constructing the Basic Pivot Table</li>
<li>Outputting the Pivot Table as Plain Text</li>
<li>Extending the Basic Pivot Table</li>
<li>Outline Layout</li>
<li>Quick-Pivot Functions</li>
<li>Examples Gallery</li>
<li>Further Reading</li>
</ul>
</div>
<div id="introducing-pivottabler" class="section level2">
<h2 class="hasAnchor">
<a href="#introducing-pivottabler" class="anchor"></a>Introducing pivottabler</h2>
<p>The <code>pivottabler</code> package enables pivot tables to be created and rendered/exported with just a few lines of R.</p>
<p>Pivot tables are constructed natively in R, either via a short one line command to build a basic pivot table or via series of R commands that gradually build a more bespoke pivot table to meet your needs.</p>
<p>The <code>pivottabler</code> package:</p>
<ul>
<li>provides a simple framework for specifying and aggregating data, based on either the dplyr package or the data.table package.<br>
</li>
<li>provides optional hooks for specifying custom calculations/aggregations for more complex scenarios
<ul>
<li>This allows a wide-range of R functions, including custom functions written in R, to be used in the calculation logic.</li>
</ul>
</li>
<li>does not require the user to specify low-level layout logic.</li>
<li>supports output in multiple formats as well as converting a pivot table to either a standard R matrix or data frame.</li>
</ul>
<p>Since pivot tables are primarily visualisation tools, the pivottabler package offers several custom styling options as well as conditional/custom formatting capabilities so that the pivot tables can be themed/branded as needed.</p>
<p>Output can be rendered as:</p>
<ul>
<li>HTML, including via the htmlwidgets framework,</li>
<li>Latex, e.g. to PDF, or</li>
<li>Plain text, e.g. to the console.</li>
</ul>
<p>The generated HTML, Latex and text can also be easily retrieved, e.g. to be used outside of R</p>
<p>The pivot tables can also be exported to Excel, including the styling/formatting.</p>
<p><code>pivottabler</code> is a companion package to the <code>basictabler</code> package. <code>pivottabler</code> is focussed on generating pivot tables and can aggregate data. <code>basictabler</code> does not aggregate data but offers more control of table structure.</p>
<p>The latest version of the pivottabler package can be obtained directly from the <a href="https://github.com/cbailiss/pivottabler/">package repository</a>. Please log any questions not answered by the vignettes or any bug reports <a href="https://github.com/cbailiss/pivottabler/issues">here</a>.</p>
</div>
<div id="basic-pivot-table" class="section level2">
<h2 class="hasAnchor">
<a href="#basic-pivot-table" class="anchor"></a>Basic Pivot Table</h2>
<p>Suppose we want to answer the question: How many ordinary/express passenger trains did each train operating company (TOC) operate in the three month period?</p>
<p>Either of the following sets of code will generate the relevant pivot table:</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">pivottabler</span>)
<span class="co"># arguments:  qhpvt(dataFrame, rows, columns, calculations, ...)</span>
<span class="fu"><a href="../reference/qhpvt.html">qhpvt</a></span>(<span class="no">bhmtrains</span>, <span class="st">"TOC"</span>, <span class="st">"TrainCategory"</span>, <span class="st">"n()"</span>) <span class="co"># TOC = Train Operating Company </span></pre></body></html></div>
<!-- Warning=FALSE since the above renderBasicTable seems to cause a random warning in the code below:
## Warning in combine_vars(vars, ind_list): '.Random.seed' is not an integer
## vector but of type 'NULL', so ignored
i.e. disable the renderBasicTable() call and the warning disappears - very odd.
-->
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">pivottabler</span>)
<span class="no">pt</span> <span class="kw">&lt;-</span> <span class="no">PivotTable</span>$<span class="fu">new</span>()
<span class="no">pt</span>$<span class="fu">addData</span>(<span class="no">bhmtrains</span>)
<span class="no">pt</span>$<span class="fu">addColumnDataGroups</span>(<span class="st">"TrainCategory"</span>)
<span class="no">pt</span>$<span class="fu">addRowDataGroups</span>(<span class="st">"TOC"</span>)
<span class="no">pt</span>$<span class="fu">defineCalculation</span>(<span class="kw">calculationName</span><span class="kw">=</span><span class="st">"TotalTrains"</span>, <span class="kw">summariseExpression</span><span class="kw">=</span><span class="st">"n()"</span>)
<span class="no">pt</span>$<span class="fu">renderPivot</span>()</pre></body></html></div>
<p><img src="intro-01.png"></p>
<p>The first block of code above uses a quick pivot function. The second block of code is the verbose version. Both produce the same pivot table and output, but the verbose version helps more clearly explain the steps involved in constructing the pivot table.</p>
<p>Each line in the verbose version works as follows:</p>
<ol style="list-style-type: decimal">
<li>Load the namespace of the pivottabler library.</li>
<li>Create a new pivot table instance<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>.</li>
<li>Specify the data frame that contains the data for the pivot table.</li>
<li>Add the distinct values from the TrainCategory column in the data frame as columns in the pivot table.</li>
<li>Add the distinct values from the TOC column in the data frame as rows in the pivot table.</li>
<li>Specify the calculation. The summarise expression must be an expression that can be used with the dplyr summarise() function. This expression is used internally by the pivottabler package with the dplyr summarise function. <code>pivottabler</code> also supports data.table.</li>
<li>Generate the pivot table.</li>
</ol>
</div>
<div id="constructing-the-basic-pivot-table" class="section level2">
<h2 class="hasAnchor">
<a href="#constructing-the-basic-pivot-table" class="anchor"></a>Constructing the Basic Pivot Table</h2>
<p>The following examples show how each line in the above example constructs the pivot table. To improve readability, each code change is highlighted.</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="co"># produces no pivot table</span>
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">pivottabler</span>)
<span class="no">pt</span> <span class="kw">&lt;-</span> <span class="no">PivotTable</span>$<span class="fu">new</span>()
<span class="no">pt</span>$<span class="fu">addData</span>(<span class="no">bhmtrains</span>)
<span class="no">pt</span>$<span class="fu">renderPivot</span>()</pre></body></html></div>
<p><img src="intro-02.png"></p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="co"># specify the column headings</span>
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">pivottabler</span>)
<span class="no">pt</span> <span class="kw">&lt;-</span> <span class="no">PivotTable</span>$<span class="fu">new</span>()
<span class="no">pt</span>$<span class="fu">addData</span>(<span class="no">bhmtrains</span>)
<span class="no">pt</span>$<span class="fu">addColumnDataGroups</span>(<span class="st">"TrainCategory"</span>)   <span class="co">#    &lt;&lt; **** LINE ADDED **** &lt;&lt;</span>
<span class="no">pt</span>$<span class="fu">renderPivot</span>()</pre></body></html></div>
<p><img src="intro-03.png"></p>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="co"># specify the row headings</span>
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">pivottabler</span>)
<span class="no">pt</span> <span class="kw">&lt;-</span> <span class="no">PivotTable</span>$<span class="fu">new</span>()
<span class="no">pt</span>$<span class="fu">addData</span>(<span class="no">bhmtrains</span>)
<span class="no">pt</span>$<span class="fu">addColumnDataGroups</span>(<span class="st">"TrainCategory"</span>)
<span class="no">pt</span>$<span class="fu">addRowDataGroups</span>(<span class="st">"TOC"</span>)                <span class="co">#    &lt;&lt; **** LINE ADDED **** &lt;&lt;</span>
<span class="no">pt</span>$<span class="fu">renderPivot</span>()</pre></body></html></div>
<p><img src="intro-04.png"></p>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="co"># specifying a calculation</span>
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">pivottabler</span>)
<span class="no">pt</span> <span class="kw">&lt;-</span> <span class="no">PivotTable</span>$<span class="fu">new</span>()
<span class="no">pt</span>$<span class="fu">addData</span>(<span class="no">bhmtrains</span>)
<span class="no">pt</span>$<span class="fu">addColumnDataGroups</span>(<span class="st">"TrainCategory"</span>)
<span class="no">pt</span>$<span class="fu">addRowDataGroups</span>(<span class="st">"TOC"</span>)                <span class="co">#     **** LINE BELOW ADDED ****</span>
<span class="no">pt</span>$<span class="fu">defineCalculation</span>(<span class="kw">calculationName</span><span class="kw">=</span><span class="st">"TotalTrains"</span>, <span class="kw">summariseExpression</span><span class="kw">=</span><span class="st">"n()"</span>)
<span class="no">pt</span>$<span class="fu">renderPivot</span>()</pre></body></html></div>
<p><img src="intro-05.png"></p>
</div>
<div id="outputting-the-pivot-table-as-plain-text" class="section level2">
<h2 class="hasAnchor">
<a href="#outputting-the-pivot-table-as-plain-text" class="anchor"></a>Outputting the Pivot Table as Plain Text</h2>
<p>The pivot table can be rendered as plain text to the console by using <code>pt</code>:</p>
<div class="sourceCode" id="cb7"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">pivottabler</span>)
<span class="no">pt</span> <span class="kw">&lt;-</span> <span class="no">PivotTable</span>$<span class="fu">new</span>()
<span class="no">pt</span>$<span class="fu">addData</span>(<span class="no">bhmtrains</span>)
<span class="no">pt</span>$<span class="fu">addColumnDataGroups</span>(<span class="st">"TrainCategory"</span>)
<span class="no">pt</span>$<span class="fu">addRowDataGroups</span>(<span class="st">"TOC"</span>)
<span class="no">pt</span>$<span class="fu">defineCalculation</span>(<span class="kw">calculationName</span><span class="kw">=</span><span class="st">"TotalTrains"</span>, <span class="kw">summariseExpression</span><span class="kw">=</span><span class="st">"n()"</span>)
<span class="no">pt</span>$<span class="fu">evaluatePivot</span>()
<span class="no">pt</span></pre></body></html></div>
<p><img src="intro-06.png"></p>
</div>
<div id="extending-the-basic-pivot-table" class="section level2">
<h2 class="hasAnchor">
<a href="#extending-the-basic-pivot-table" class="anchor"></a>Extending the Basic Pivot Table</h2>
<p>There follows below a progressive series of changes to the basic pivot table shown above. Each change is made by adding or changing one line of code. Again, to improve readability, each code change is highlighted.</p>
<p>First, adding an additional column data group to sub-divide each “TrainCategory” by “PowerType”:</p>
<div class="sourceCode" id="cb8"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">pivottabler</span>)
<span class="no">pt</span> <span class="kw">&lt;-</span> <span class="no">PivotTable</span>$<span class="fu">new</span>()
<span class="no">pt</span>$<span class="fu">addData</span>(<span class="no">bhmtrains</span>)
<span class="no">pt</span>$<span class="fu">addColumnDataGroups</span>(<span class="st">"TrainCategory"</span>)
<span class="no">pt</span>$<span class="fu">addColumnDataGroups</span>(<span class="st">"PowerType"</span>)    <span class="co">#    &lt;&lt; **** CODE CHANGE **** &lt;&lt;</span>
<span class="no">pt</span>$<span class="fu">addRowDataGroups</span>(<span class="st">"TOC"</span>)
<span class="no">pt</span>$<span class="fu">defineCalculation</span>(<span class="kw">calculationName</span><span class="kw">=</span><span class="st">"TotalTrains"</span>, <span class="kw">summariseExpression</span><span class="kw">=</span><span class="st">"n()"</span>)
<span class="no">pt</span>$<span class="fu">renderPivot</span>()</pre></body></html></div>
<p><img src="intro-07.png"></p>
<p>By default, the new data group does not expand the existing “TrainCategory” total. However, an additional argument allows the total column to also be expanded:</p>
<div class="sourceCode" id="cb9"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">pivottabler</span>)
<span class="no">pt</span> <span class="kw">&lt;-</span> <span class="no">PivotTable</span>$<span class="fu">new</span>()
<span class="no">pt</span>$<span class="fu">addData</span>(<span class="no">bhmtrains</span>)
<span class="no">pt</span>$<span class="fu">addColumnDataGroups</span>(<span class="st">"TrainCategory"</span>)
<span class="no">pt</span>$<span class="fu">addColumnDataGroups</span>(<span class="st">"PowerType"</span>, <span class="kw">expandExistingTotals</span><span class="kw">=</span><span class="fl">TRUE</span>) <span class="co"># &lt;&lt; ** CODE CHANGE ** &lt;&lt;</span>
<span class="no">pt</span>$<span class="fu">addRowDataGroups</span>(<span class="st">"TOC"</span>)
<span class="no">pt</span>$<span class="fu">defineCalculation</span>(<span class="kw">calculationName</span><span class="kw">=</span><span class="st">"TotalTrains"</span>, <span class="kw">summariseExpression</span><span class="kw">=</span><span class="st">"n()"</span>)
<span class="no">pt</span>$<span class="fu">renderPivot</span>()</pre></body></html></div>
<p><img src="intro-08.png"></p>
<p>Instead of adding “PowerType” as columns, it can also be added as rows:</p>
<div class="sourceCode" id="cb10"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">pivottabler</span>)
<span class="no">pt</span> <span class="kw">&lt;-</span> <span class="no">PivotTable</span>$<span class="fu">new</span>()
<span class="no">pt</span>$<span class="fu">addData</span>(<span class="no">bhmtrains</span>)
<span class="no">pt</span>$<span class="fu">addColumnDataGroups</span>(<span class="st">"TrainCategory"</span>)
<span class="no">pt</span>$<span class="fu">addRowDataGroups</span>(<span class="st">"TOC"</span>)
<span class="no">pt</span>$<span class="fu">addRowDataGroups</span>(<span class="st">"PowerType"</span>)    <span class="co">#    &lt;&lt; **** CODE CHANGE **** &lt;&lt;</span>
<span class="no">pt</span>$<span class="fu">defineCalculation</span>(<span class="kw">calculationName</span><span class="kw">=</span><span class="st">"TotalTrains"</span>, <span class="kw">summariseExpression</span><span class="kw">=</span><span class="st">"n()"</span>)
<span class="no">pt</span>$<span class="fu">renderPivot</span>()</pre></body></html></div>
<p><img src="intro-09.png"></p>
<p>It is possible to continue adding additional data groups. The pivottabler does not enforce a maximum depth of data groups. For example, adding the maximum scheduled speed to the rows:</p>
<div class="sourceCode" id="cb11"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">pivottabler</span>)
<span class="no">pt</span> <span class="kw">&lt;-</span> <span class="no">PivotTable</span>$<span class="fu">new</span>()
<span class="no">pt</span>$<span class="fu">addData</span>(<span class="no">bhmtrains</span>)
<span class="no">pt</span>$<span class="fu">addColumnDataGroups</span>(<span class="st">"TrainCategory"</span>)
<span class="no">pt</span>$<span class="fu">addRowDataGroups</span>(<span class="st">"TOC"</span>)
<span class="no">pt</span>$<span class="fu">addRowDataGroups</span>(<span class="st">"PowerType"</span>)
<span class="no">pt</span>$<span class="fu">addRowDataGroups</span>(<span class="st">"SchedSpeedMPH"</span>)    <span class="co">#    &lt;&lt; **** CODE CHANGE **** &lt;&lt;</span>
<span class="no">pt</span>$<span class="fu">defineCalculation</span>(<span class="kw">calculationName</span><span class="kw">=</span><span class="st">"TotalTrains"</span>, <span class="kw">summariseExpression</span><span class="kw">=</span><span class="st">"n()"</span>)
<span class="no">pt</span>$<span class="fu">renderPivot</span>()</pre></body></html></div>
<p><img src="intro-10.png"></p>
<p>As more data groups are added, the pivot table can seem overwhelmed with totals. It is possible to selectively show/hide totals using the <code>addTotal</code> argument. Totals can be renamed using the <code>totalCaption</code> argument. Both of these options are demonstrated below.</p>
<div class="sourceCode" id="cb12"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">pivottabler</span>)
<span class="no">pt</span> <span class="kw">&lt;-</span> <span class="no">PivotTable</span>$<span class="fu">new</span>()
<span class="no">pt</span>$<span class="fu">addData</span>(<span class="no">bhmtrains</span>)
<span class="no">pt</span>$<span class="fu">addColumnDataGroups</span>(<span class="st">"TrainCategory"</span>)
<span class="no">pt</span>$<span class="fu">addRowDataGroups</span>(<span class="st">"TOC"</span>, <span class="kw">totalCaption</span><span class="kw">=</span><span class="st">"Grand Total"</span>)    <span class="co">#    &lt;&lt; **** CODE CHANGE **** &lt;&lt;</span>
<span class="no">pt</span>$<span class="fu">addRowDataGroups</span>(<span class="st">"PowerType"</span>)
<span class="no">pt</span>$<span class="fu">addRowDataGroups</span>(<span class="st">"SchedSpeedMPH"</span>, <span class="kw">addTotal</span><span class="kw">=</span><span class="fl">FALSE</span>)      <span class="co">#    &lt;&lt; **** CODE CHANGE **** &lt;&lt;</span>
<span class="no">pt</span>$<span class="fu">defineCalculation</span>(<span class="kw">calculationName</span><span class="kw">=</span><span class="st">"TotalTrains"</span>, <span class="kw">summariseExpression</span><span class="kw">=</span><span class="st">"n()"</span>)
<span class="no">pt</span>$<span class="fu">renderPivot</span>()</pre></body></html></div>
<p><img src="intro-11.png"></p>
<p>This can then be rendered in outline layout:</p>
<div class="sourceCode" id="cb13"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">pivottabler</span>)
<span class="no">pt</span> <span class="kw">&lt;-</span> <span class="no">PivotTable</span>$<span class="fu">new</span>()
<span class="no">pt</span>$<span class="fu">addData</span>(<span class="no">bhmtrains</span>)
<span class="no">pt</span>$<span class="fu">addColumnDataGroups</span>(<span class="st">"TrainCategory"</span>)
<span class="no">pt</span>$<span class="fu">addRowDataGroups</span>(<span class="st">"TOC"</span>,
                    <span class="kw">outlineBefore</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">isEmpty</span><span class="kw">=</span><span class="fl">FALSE</span>,
                                       <span class="kw">groupStyleDeclarations</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">color</span><span class="kw">=</span><span class="st">"blue"</span>)),
                    <span class="kw">outlineTotal</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">groupStyleDeclarations</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">color</span><span class="kw">=</span><span class="st">"blue"</span>)))
<span class="no">pt</span>$<span class="fu">addRowDataGroups</span>(<span class="st">"PowerType"</span>, <span class="kw">addTotal</span><span class="kw">=</span><span class="fl">FALSE</span>)
<span class="no">pt</span>$<span class="fu">addRowDataGroups</span>(<span class="st">"SchedSpeedMPH"</span>, <span class="kw">addTotal</span><span class="kw">=</span><span class="fl">FALSE</span>)
<span class="no">pt</span>$<span class="fu">defineCalculation</span>(<span class="kw">calculationName</span><span class="kw">=</span><span class="st">"TotalTrains"</span>, <span class="kw">summariseExpression</span><span class="kw">=</span><span class="st">"n()"</span>)
<span class="no">pt</span>$<span class="fu">renderPivot</span>()</pre></body></html></div>
<p><img src="intro-12.png"></p>
</div>
<div id="outline-layout" class="section level2">
<h2 class="hasAnchor">
<a href="#outline-layout" class="anchor"></a>Outline Layout</h2>
<p>Outline layout renders row data groups as headings:</p>
<div class="sourceCode" id="cb14"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">pivottabler</span>)
<span class="no">pt</span> <span class="kw">&lt;-</span> <span class="no">PivotTable</span>$<span class="fu">new</span>()
<span class="no">pt</span>$<span class="fu">addData</span>(<span class="no">bhmtrains</span>)
<span class="no">pt</span>$<span class="fu">addColumnDataGroups</span>(<span class="st">"TrainCategory"</span>)
<span class="no">pt</span>$<span class="fu">addRowDataGroups</span>(<span class="st">"TOC"</span>,
                    <span class="kw">outlineBefore</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">groupStyleDeclarations</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">color</span><span class="kw">=</span><span class="st">"blue"</span>)),
                    <span class="kw">outlineAfter</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">isEmpty</span><span class="kw">=</span><span class="fl">FALSE</span>,
                                      <span class="kw">mergeSpace</span><span class="kw">=</span><span class="st">"dataGroupsOnly"</span>,
                                      <span class="kw">caption</span><span class="kw">=</span><span class="st">"Total ({value})"</span>,
                                      <span class="kw">groupStyleDeclarations</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">"font-style"</span><span class="kw">=</span><span class="st">"italic"</span>)),
                    <span class="kw">outlineTotal</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">groupStyleDeclarations</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">color</span><span class="kw">=</span><span class="st">"blue"</span>),
                                      <span class="kw">cellStyleDeclarations</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">"color"</span><span class="kw">=</span><span class="st">"blue"</span>)))
<span class="no">pt</span>$<span class="fu">addRowDataGroups</span>(<span class="st">"PowerType"</span>, <span class="kw">addTotal</span><span class="kw">=</span><span class="fl">FALSE</span>)
<span class="no">pt</span>$<span class="fu">defineCalculation</span>(<span class="kw">calculationName</span><span class="kw">=</span><span class="st">"TotalTrains"</span>, <span class="kw">summariseExpression</span><span class="kw">=</span><span class="st">"n()"</span>)
<span class="no">pt</span>$<span class="fu">renderPivot</span>()</pre></body></html></div>
<p><img src="intro-13.png"></p>
</div>
<div id="quick-pivot-functions" class="section level2">
<h2 class="hasAnchor">
<a href="#quick-pivot-functions" class="anchor"></a>Quick-Pivot Functions</h2>
<p>To construct basic pivot tables quickly, three functions are provided that can construct pivot tables with one line of R:</p>
<ul>
<li>
<code><a href="../reference/qpvt.html">qpvt()</a></code> returns a pivot table. Setting a variable equal to the return value, e.g. <code>pt &lt;- qpvt(...)</code>, allows further operations to be carried out on the pivot table. Otherwise, using <code><a href="../reference/qpvt.html">qpvt(...)</a></code> alone will simply print the pivot table to the console and then discard it.</li>
<li>
<code><a href="../reference/qhpvt.html">qhpvt()</a></code> returns a HTML widget that when used alone will render a HTML representation of the pivot table (e.g. in the R-Studio “Viewer” pane).</li>
<li>
<code><a href="../reference/qlpvt.html">qlpvt()</a></code> returns a Latex representation of a pivot table.</li>
</ul>
<p>These functions do not offer all of the options that are available when constructing a pivot table using the more verbose syntax.</p>
<p>The arguments to all three functions are essentially the same:</p>
<ul>
<li>
<code>dataFrame</code> specifies the data frame that contains the pivot table data.</li>
<li>
<code>rows</code> specifies the names of the variables (as a character vector) used to generate the row data groups.</li>
<li>
<code>columns</code> specifies the names of the variables (as a character vector) used to generate the column data groups.</li>
<li>
<code>calculations</code> specifies the summary calculations (as a character vector) used to calculate the cell values in the pivot table. The names of the elements in this vector become the calculation names (and so the calculation headings when more than one calculation is present in the pivot table).</li>
<li>
<code>format</code> specifies the same formatting for all calculations (as either a character value, list or R function). See the “Formatting calculated values” section of the Calculations vignette for more details.</li>
<li>
<code>formats</code> specifies a different format for each calculation (as a list of the same length as <code>calculations</code> containing any combination of character values, lists or R functions).</li>
<li>
<code>totals</code> specifies which totals are shown and can also control the captions of totals. This is described in more detail below.</li>
</ul>
<p>Specifying “=” in either the <code>rows</code> or <code>columns</code> vectors sets the position of the calculations in the row/column headings.</p>
<p>A basic example of quickly printing a pivot table to the console:</p>
<div class="sourceCode" id="cb15"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">pivottabler</span>)
<span class="fu"><a href="../reference/qpvt.html">qpvt</a></span>(<span class="no">bhmtrains</span>, <span class="st">"TOC"</span>, <span class="st">"TrainCategory"</span>, <span class="st">"n()"</span>)</pre></body></html></div>
<p><img src="intro-14.png"></p>
<p>A slightly more complex pivot table being quickly rendered as a HTML widget, where the calculation headings are on the rows:</p>
<div class="sourceCode" id="cb16"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">pivottabler</span>)
<span class="fu"><a href="../reference/qhpvt.html">qhpvt</a></span>(<span class="no">bhmtrains</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"="</span>, <span class="st">"TOC"</span>), <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"TrainCategory"</span>, <span class="st">"PowerType"</span>),
    <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Number of Trains"</span><span class="kw">=</span><span class="st">"n()"</span>, <span class="st">"Maximum Speed"</span><span class="kw">=</span><span class="st">"max(SchedSpeedMPH, na.rm=TRUE)"</span>))</pre></body></html></div>
<p><img src="intro-15.png"></p>
<p>A quick pivot table with a format specified:</p>
<div class="sourceCode" id="cb17"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">pivottabler</span>)
<span class="fu"><a href="../reference/qhpvt.html">qhpvt</a></span>(<span class="no">bhmtrains</span>, <span class="st">"TOC"</span>, <span class="st">"TrainCategory"</span>, <span class="st">"mean(SchedSpeedMPH, na.rm=TRUE)"</span>, <span class="kw">format</span><span class="kw">=</span><span class="st">"%.0f"</span>)</pre></body></html></div>
<p><img src="intro-16.png"></p>
<p>A quick pivot table with two calculations that are formatted differently:</p>
<div class="sourceCode" id="cb18"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">pivottabler</span>)
<span class="fu"><a href="../reference/qhpvt.html">qhpvt</a></span>(<span class="no">bhmtrains</span>, <span class="st">"TOC"</span>, <span class="st">"TrainCategory"</span>,
     <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Mean Speed"</span><span class="kw">=</span><span class="st">"mean(SchedSpeedMPH, na.rm=TRUE)"</span>, <span class="st">"Std Dev Speed"</span><span class="kw">=</span><span class="st">"sd(SchedSpeedMPH, na.rm=TRUE)"</span>),
     <span class="kw">formats</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">"%.0f"</span>, <span class="st">"%.1f"</span>))</pre></body></html></div>
<p><img src="intro-17.png"></p>
<p>In the above pivot table, the “Total” would be better renamed to something like “All” or “Overall” since a total for a mean or standard deviation does not make complete sense.</p>
<p>Totals can be controlled using the <code>totals</code> argument. This works as follows:</p>
<ul>
<li>If not specified, then totals are generated for all variables.</li>
<li>To hide all totals, specify <code>totals=NONE</code>.</li>
<li>To specify which variables have totals, specify the names of the variables in a character vector, e.g. in a pivot table containing the variables x, y and z, to display totals only for variables x and z, specify <code>totals=c("x", "z")</code>.</li>
<li>To specify which variables have totals and also rename the captions of the total cells, specify a list, e.g. to rename the totals for x to “All x” and y to “All y”, specify <code>totals=list("x"="All x", "y"="All y")</code>.</li>
</ul>
<p>Returning to the previous quick pivot example, the totals can now be renamed to “All …” using:</p>
<div class="sourceCode" id="cb19"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">pivottabler</span>)
<span class="fu"><a href="../reference/qhpvt.html">qhpvt</a></span>(<span class="no">bhmtrains</span>, <span class="st">"TOC"</span>, <span class="st">"TrainCategory"</span>,
     <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Mean Speed"</span><span class="kw">=</span><span class="st">"mean(SchedSpeedMPH, na.rm=TRUE)"</span>, <span class="st">"Std Dev Speed"</span><span class="kw">=</span><span class="st">"sd(SchedSpeedMPH, na.rm=TRUE)"</span>),
     <span class="kw">formats</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">"%.0f"</span>, <span class="st">"%.1f"</span>), <span class="kw">totals</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">"TOC"</span><span class="kw">=</span><span class="st">"All TOCs"</span>, <span class="st">"TrainCategory"</span><span class="kw">=</span><span class="st">"All Categories"</span>))</pre></body></html></div>
<p><img src="intro-18.png"></p>
</div>
<div id="examples-gallery" class="section level2">
<h2 class="hasAnchor">
<a href="#examples-gallery" class="anchor"></a>Examples Gallery</h2>
<p>Various examples of using the <code>pivottabler</code> package are shown below. Please see the gallery at the bottom of the full introduction <a href="http://www.pivottabler.org.uk/articles/v01-introduction.html">here</a> for links to other articles showing how to construct these examples.</p>
<div id="multiple-levels-formatted-data-groups" class="section level3">
<h3 class="hasAnchor">
<a href="#multiple-levels-formatted-data-groups" class="anchor"></a>Multiple Levels &amp; Formatted Data Groups</h3>
<p><img src="intro-19.png"></p>
</div>
<div id="multiple-calculations-calculations-on-rows" class="section level3">
<h3 class="hasAnchor">
<a href="#multiple-calculations-calculations-on-rows" class="anchor"></a>Multiple Calculations &amp; Calculations on Rows</h3>
<p><img src="intro-20.png"></p>
</div>
<div id="custom-calculations" class="section level3">
<h3 class="hasAnchor">
<a href="#custom-calculations" class="anchor"></a>Custom Calculations</h3>
<p><img src="intro-21.png"></p>
</div>
<div id="outline-layout-1" class="section level3">
<h3 class="hasAnchor">
<a href="#outline-layout-1" class="anchor"></a>Outline Layout</h3>
<p><img src="intro-22.png"></p>
<p><img src="intro-23.png"></p>
<p><img src="intro-32.png"></p>
</div>
<div id="results-as-a-matrix" class="section level3">
<h3 class="hasAnchor">
<a href="#results-as-a-matrix" class="anchor"></a>Results as a Matrix</h3>
<p><img src="intro-24.png"></p>
</div>
<div id="latex-output" class="section level3">
<h3 class="hasAnchor">
<a href="#latex-output" class="anchor"></a>Latex Output</h3>
<p><img src="intro-25.png"></p>
</div>
<div id="styling" class="section level3">
<h3 class="hasAnchor">
<a href="#styling" class="anchor"></a>Styling</h3>
<p><img src="intro-26.png"></p>
</div>
<div id="finding-and-formatting-data-groups" class="section level3">
<h3 class="hasAnchor">
<a href="#finding-and-formatting-data-groups" class="anchor"></a>Finding and Formatting Data Groups</h3>
<p><img src="intro-27.png"></p>
</div>
<div id="finding-and-formatting-cells" class="section level3">
<h3 class="hasAnchor">
<a href="#finding-and-formatting-cells" class="anchor"></a>Finding and Formatting Cells</h3>
<p><img src="intro-28.png"></p>
</div>
<div id="conditional-formatting" class="section level3">
<h3 class="hasAnchor">
<a href="#conditional-formatting" class="anchor"></a>Conditional Formatting</h3>
<p><img src="intro-29.png"></p>
</div>
<div id="mixing-data-groups-andor-calculations" class="section level3">
<h3 class="hasAnchor">
<a href="#mixing-data-groups-andor-calculations" class="anchor"></a>Mixing Data Groups and/or Calculations</h3>
<p><img src="intro-30.png"></p>
</div>
<div id="combining-pivot-tables" class="section level3">
<h3 class="hasAnchor">
<a href="#combining-pivot-tables" class="anchor"></a>Combining Pivot Tables</h3>
<p><img src="intro-31.png"></p>
</div>
</div>
<div id="further-reading" class="section level2">
<h2 class="hasAnchor">
<a href="#further-reading" class="anchor"></a>Further Reading</h2>
<p>More information can be found at <a href="http://www.pivottabler.org.uk/">http://www.pivottabler.org.uk/</a>.</p>
<p>A longer version of this introduction can be found <a href="http://www.pivottabler.org.uk/articles/v01-introduction.html">here</a>.</p>
<p>The full set of package vignettes can be found <a href="http://www.pivottabler.org.uk/articles/">here</a>.</p>
</div>
<div class="footnotes">
<hr>
<ol>
<li id="fn1"><p>pivottabler is implemented in <a href="https://CRAN.R-project.org/package=R6">R6 Classes</a> so pt here is an instance of the R6 PivotTable class.<a href="#fnref1" class="footnote-back">↩</a></p></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Christopher Bailiss.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    
    
    apiKey: '16a61fa9a8811ff537cd1a528040a9e1',
    indexName: 'pivottabler',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>
</body>
</html>
